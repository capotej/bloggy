<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Sequel::Model</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Sequel::Model</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/sequel_model/base_rb.html">
                lib/sequel_model/base.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_model/validations_rb.html">
                lib/sequel_model/validations.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_model/hooks_rb.html">
                lib/sequel_model/hooks.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_model/plugins_rb.html">
                lib/sequel_model/plugins.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_model/caching_rb.html">
                lib/sequel_model/caching.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_model/record_rb.html">
                lib/sequel_model/record.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_model/schema_rb.html">
                lib/sequel_model/schema.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_model_rb.html">
                lib/sequel_model.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="../Object.html">
                Object
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="Model.html">Model</a> has some methods that are added via
metaprogramming:
</p>
<ul>
<li>All of the methods in DATASET_METHODS have class methods created that call
the <a href="Model.html">Model</a>&#8216;s <a
href="Model.html#M000379">dataset</a> with the method of the same name with
the given arguments.

</li>
<li>All of the methods in HOOKS have class methods created that accept either a
method name symbol or an optional tag and a block. These methods run the
code as a callback at the specified time. For example:

<pre>
  Model.before_save :do_something
  Model.before_save(:do_something_else){ self.something_else = 42}
  object = Model.new
  object.save
</pre>
<p>
Would run the object&#8216;s :do_something method following by the code
block related to :do_something_else. Note that if you specify a block, a
tag <a href="Model.html#M000426">is</a> optional. If the tag <a
href="Model.html#M000426">is</a> not nil, it will overwrite a previous
block with the same tag. This allows hooks to work with systems that <a
href="Model.html#M000449">reload</a> code.
</p>
</li>
<li>All of the methods in HOOKS also <a href="Model.html#M000378">create</a>
instance methods, but you should not override these instance methods.

</li>
<li>The following instance_methods all call the class method of the same name:
<a href="Model.html#M000377">columns</a>, <a
href="Model.html#M000379">dataset</a>, <a href="Model.html#M000380">db</a>,
primary_key, <a href="Model.html#M000404">str_columns</a>.

</li>
<li>The following class level attr_readers are created: allowed_columns,
cache_store, cache_ttl, dataset_methods, primary_key, restricted_columns,
sti_dataset, and sti_key. You should not usually need to access these
directly.

</li>
<li>The following class level attr_accessors are created:
raise_on_typecast_failure, raise_on_save_failure, strict_param_setting,
typecast_empty_string_to_nil, and typecast_on_assignment:

<pre>
  # Don't raise an error if a validation attempt fails in
  # save/create/save_changes/etc.
  Model.raise_on_save_failure = false
  Model.before_save{false}
  Model.new.save # =&gt; nil
  # Don't raise errors in new/set/update/etc. if an attempt to
  # access a missing/restricted method occurs (just silently
  # skip it)
  Model.strict_param_setting = false
  Model.new(:id=&gt;1) # No Error
  # Don't typecast attribute values on assignment
  Model.typecast_on_assignment = false
  m = Model.new
  m.number = '10'
  m.number # =&gt; '10' instead of 10
  # Don't typecast empty string to nil for non-string, non-blob columns.
  Model.typecast_empty_string_to_nil = false
  m.number = ''
  m.number # =&gt; '' instead of nil
  # Don't raise if unable to typecast data for a column
  Model.typecast_empty_string_to_nil = true
  Model.raise_on_typecast_failure = false
  m.not_null_column = '' # =&gt; nil
  m.number = 'A' # =&gt; 'A'
</pre>
</li>
<li>The following class level method aliases are defined:

<ul>
<li><a href="Model.html#M000379">Model.dataset</a>= =&gt; <a
href="Model.html#M000400">set_dataset</a>

</li>
<li>Model.is_a =&gt; <a href="Model.html#M000426">is</a>

</li>
</ul>
</li>
</ul>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000433">==</a>&nbsp;&nbsp;
      <a href="#M000434">===</a>&nbsp;&nbsp;
      <a href="#M000376">[]</a>&nbsp;&nbsp;
      <a href="#M000431">[]</a>&nbsp;&nbsp;
      <a href="#M000432">[]=</a>&nbsp;&nbsp;
      <a href="#M000435">associations</a>&nbsp;&nbsp;
      <a href="#M000429">cache_key</a>&nbsp;&nbsp;
      <a href="#M000436">changed_columns</a>&nbsp;&nbsp;
      <a href="#M000377">columns</a>&nbsp;&nbsp;
      <a href="#M000378">create</a>&nbsp;&nbsp;
      <a href="#M000466">create_table</a>&nbsp;&nbsp;
      <a href="#M000467">create_table!</a>&nbsp;&nbsp;
      <a href="#M000379">dataset</a>&nbsp;&nbsp;
      <a href="#M000380">db</a>&nbsp;&nbsp;
      <a href="#M000381">db=</a>&nbsp;&nbsp;
      <a href="#M000382">db_schema</a>&nbsp;&nbsp;
      <a href="#M000383">def_dataset_method</a>&nbsp;&nbsp;
      <a href="#M000437">delete</a>&nbsp;&nbsp;
      <a href="#M000384">delete_all</a>&nbsp;&nbsp;
      <a href="#M000438">destroy</a>&nbsp;&nbsp;
      <a href="#M000385">destroy_all</a>&nbsp;&nbsp;
      <a href="#M000468">drop_table</a>&nbsp;&nbsp;
      <a href="#M000439">each</a>&nbsp;&nbsp;
      <a href="#M000387">eager_loading_dataset</a>&nbsp;&nbsp;
      <a href="#M000421">errors</a>&nbsp;&nbsp;
      <a href="#M000440">exists?</a>&nbsp;&nbsp;
      <a href="#M000386">fetch</a>&nbsp;&nbsp;
      <a href="#M000388">find</a>&nbsp;&nbsp;
      <a href="#M000389">find_or_create</a>&nbsp;&nbsp;
      <a href="#M000424">has_hooks?</a>&nbsp;&nbsp;
      <a href="#M000408">has_validations?</a>&nbsp;&nbsp;
      <a href="#M000441">hash</a>&nbsp;&nbsp;
      <a href="#M000425">hook_blocks</a>&nbsp;&nbsp;
      <a href="#M000442">id</a>&nbsp;&nbsp;
      <a href="#M000391">implicit_table_name</a>&nbsp;&nbsp;
      <a href="#M000390">inherited</a>&nbsp;&nbsp;
      <a href="#M000443">inspect</a>&nbsp;&nbsp;
      <a href="#M000426">is</a>&nbsp;&nbsp;
      <a href="#M000444">keys</a>&nbsp;&nbsp;
      <a href="#M000392">load</a>&nbsp;&nbsp;
      <a href="#M000430">new</a>&nbsp;&nbsp;
      <a href="#M000445">new?</a>&nbsp;&nbsp;
      <a href="#M000393">no_primary_key</a>&nbsp;&nbsp;
      <a href="#M000446">pk</a>&nbsp;&nbsp;
      <a href="#M000447">pk_hash</a>&nbsp;&nbsp;
      <a href="#M000394">primary_key_hash</a>&nbsp;&nbsp;
      <a href="#M000448">refresh</a>&nbsp;&nbsp;
      <a href="#M000449">reload</a>&nbsp;&nbsp;
      <a href="#M000395">restrict_primary_key</a>&nbsp;&nbsp;
      <a href="#M000396">restrict_primary_key?</a>&nbsp;&nbsp;
      <a href="#M000450">save</a>&nbsp;&nbsp;
      <a href="#M000451">save!</a>&nbsp;&nbsp;
      <a href="#M000452">save_changes</a>&nbsp;&nbsp;
      <a href="#M000469">schema</a>&nbsp;&nbsp;
      <a href="#M000397">serialize</a>&nbsp;&nbsp;
      <a href="#M000398">serialized?</a>&nbsp;&nbsp;
      <a href="#M000453">set</a>&nbsp;&nbsp;
      <a href="#M000455">set_all</a>&nbsp;&nbsp;
      <a href="#M000399">set_allowed_columns</a>&nbsp;&nbsp;
      <a href="#M000427">set_cache</a>&nbsp;&nbsp;
      <a href="#M000428">set_cache_ttl</a>&nbsp;&nbsp;
      <a href="#M000400">set_dataset</a>&nbsp;&nbsp;
      <a href="#M000456">set_except</a>&nbsp;&nbsp;
      <a href="#M000457">set_only</a>&nbsp;&nbsp;
      <a href="#M000401">set_primary_key</a>&nbsp;&nbsp;
      <a href="#M000402">set_restricted_columns</a>&nbsp;&nbsp;
      <a href="#M000470">set_schema</a>&nbsp;&nbsp;
      <a href="#M000403">set_sti_key</a>&nbsp;&nbsp;
      <a href="#M000458">set_values</a>&nbsp;&nbsp;
      <a href="#M000454">set_with_params</a>&nbsp;&nbsp;
      <a href="#M000409">skip_superclass_validations</a>&nbsp;&nbsp;
      <a href="#M000404">str_columns</a>&nbsp;&nbsp;
      <a href="#M000405">subset</a>&nbsp;&nbsp;
      <a href="#M000471">table_exists?</a>&nbsp;&nbsp;
      <a href="#M000406">table_name</a>&nbsp;&nbsp;
      <a href="#M000459">this</a>&nbsp;&nbsp;
      <a href="#M000407">unrestrict_primary_key</a>&nbsp;&nbsp;
      <a href="#M000460">update</a>&nbsp;&nbsp;
      <a href="#M000462">update_all</a>&nbsp;&nbsp;
      <a href="#M000463">update_except</a>&nbsp;&nbsp;
      <a href="#M000464">update_only</a>&nbsp;&nbsp;
      <a href="#M000465">update_values</a>&nbsp;&nbsp;
      <a href="#M000461">update_with_params</a>&nbsp;&nbsp;
      <a href="#M000423">valid?</a>&nbsp;&nbsp;
      <a href="#M000411">validate</a>&nbsp;&nbsp;
      <a href="#M000422">validate</a>&nbsp;&nbsp;
      <a href="#M000410">validates</a>&nbsp;&nbsp;
      <a href="#M000412">validates_acceptance_of</a>&nbsp;&nbsp;
      <a href="#M000413">validates_confirmation_of</a>&nbsp;&nbsp;
      <a href="#M000414">validates_each</a>&nbsp;&nbsp;
      <a href="#M000415">validates_format_of</a>&nbsp;&nbsp;
      <a href="#M000416">validates_length_of</a>&nbsp;&nbsp;
      <a href="#M000417">validates_numericality_of</a>&nbsp;&nbsp;
      <a href="#M000418">validates_presence_of</a>&nbsp;&nbsp;
      <a href="#M000419">validates_uniqueness_of</a>&nbsp;&nbsp;
      <a href="#M000420">validations</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Module <a href="Model/Associations.html" class="link">Sequel::Model::Associations</a><br />
Module <a href="Model/DatasetMethods.html" class="link">Sequel::Model::DatasetMethods</a><br />
Module <a href="Model/Validation.html" class="link">Sequel::Model::Validation</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DATASET_METHODS</td>
          <td>=</td>
          <td class="context-item-value">%w'&lt;&lt; all avg count delete distinct eager eager_graph each each_page         empty? except exclude filter first from from_self full_outer_join get graph         group group_and_count group_by having import inner_join insert         insert_multiple intersect interval invert_order join join_table last         left_outer_join limit map multi_insert naked order order_by order_more         paginate print query range reverse_order right_outer_join select         select_all select_more server set set_graph_aliases single_value size to_csv to_hash        transform union uniq unfiltered unordered update where'.map{|x| x.to_sym}</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Dataset.html">Dataset</a> methods to proxy via metaprogramming

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">INHERITED_INSTANCE_VARIABLES</td>
          <td>=</td>
          <td class="context-item-value">{:@allowed_columns=&gt;:dup, :@cache_store=&gt;nil,       :@cache_ttl=&gt;nil, :@dataset_methods=&gt;:dup, :@primary_key=&gt;nil,        :@raise_on_save_failure=&gt;nil, :@restricted_columns=&gt;:dup, :@restrict_primary_key=&gt;nil,       :@sti_dataset=&gt;nil, :@sti_key=&gt;nil, :@strict_param_setting=&gt;nil,       :@typecast_empty_string_to_nil=&gt;nil, :@typecast_on_assignment=&gt;nil,       :@raise_on_typecast_failure=&gt;nil, :@association_reflections=&gt;:dup}</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Instance variables that are <a href="Model.html#M000390">inherited</a> in
subclasses

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEFAULT_VALIDATION_IF_PROC</td>
          <td>=</td>
          <td class="context-item-value">proc{true}</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Validations without an :if option are always run

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">HOOKS</td>
          <td>=</td>
          <td class="context-item-value">[:after_initialize, :before_create, :after_create, :before_update,       :after_update, :before_save, :after_save, :before_destroy, :after_destroy,       :before_validation, :after_validation]</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Hooks that are safe for public use

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PRIVATE_HOOKS</td>
          <td>=</td>
          <td class="context-item-value">[:before_update_values, :before_delete]</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Hooks that are only for internal use

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">RESTRICTED_SETTER_METHODS</td>
          <td>=</td>
          <td class="context-item-value">%w&quot;== === []= taguri= typecast_empty_string_to_nil= typecast_on_assignment= strict_param_setting= raise_on_save_failure= raise_on_typecast_failure=&quot;</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The setter methods (methods ending with =) that are never allowed to be
called automatically via <a href="Model.html#M000453">set</a>.

</td>
        </tr>
        </table>
      </div>
    </div>

    <div id="aliases-list">
      <h3 class="section-bar">External Aliases</h3>

      <div class="name-list">
                        <table summary="aliases">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">"=="</td>
          <td>-&gt;</td>
          <td class="context-item-value">eql?</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">class</td>
          <td>-&gt;</td>
          <td class="context-item-value">model</td>
        </tr>
      <tr class="top-aligned-row context-row">
        <td>&nbsp;</td>
        <td colspan="2" class="context-item-desc">
class <a href="Model.html#M000426">is</a> defined in <a
href="../Object.html">Object</a>, but it <a
href="Model.html#M000426">is</a> also a keyword, and since a lot of
instance methods call class methods, the model makes it so you can use
model instead of self.class.

</td>
      </tr>
                        </table>
      </div>
    </div>


    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">values</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The <a href="Model.html#M000441">hash</a> of attribute values. Keys are
symbols with the names of the underlying database <a
href="Model.html#M000377">columns</a>.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000376" class="method-detail">
        <a name="M000376"></a>

        <div class="method-heading">
          <a href="#M000376" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the first record from the database matching the conditions. If a <a
href="Model.html#M000441">hash</a> <a href="Model.html#M000426">is</a>
given, it <a href="Model.html#M000426">is</a> used as the conditions. If
another object <a href="Model.html#M000426">is</a> given, it finds the
first record whose primary key(s) match the given argument(s). If caching
<a href="Model.html#M000426">is</a> used, the cache <a
href="Model.html#M000426">is</a> checked first before a <a
href="Model.html#M000379">dataset</a> lookup <a
href="Model.html#M000426">is</a> attempted unless a <a
href="Model.html#M000441">hash</a> <a href="Model.html#M000426">is</a>
supplied.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000376-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000376-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 86</span>
86:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
87:       <span class="ruby-identifier">args</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>)
88: 
89:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">args</span>
90:         <span class="ruby-identifier">dataset</span>[<span class="ruby-identifier">args</span>]
91:       <span class="ruby-keyword kw">else</span>
92:         <span class="ruby-ivar">@cache_store</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">cache_lookup</span>(<span class="ruby-identifier">args</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">dataset</span>[<span class="ruby-identifier">primary_key_hash</span>(<span class="ruby-identifier">args</span>)]
93:       <span class="ruby-keyword kw">end</span>
94:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000377" class="method-detail">
        <a name="M000377"></a>

        <div class="method-heading">
          <a href="#M000377" class="method-signature">
          <span class="method-name">columns</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Model.html#M000377">columns</a> in the result <a
href="Model.html#M000453">set</a> in their original order. Generally, <a
href="Model.html#M000459">this</a> will used the <a
href="Model.html#M000377">columns</a> determined via the database <a
href="Model.html#M000469">schema</a>, but in certain cases (e.g. models
that are based on a joined <a href="Model.html#M000379">dataset</a>) it
will use <a href="Dataset.html#M000644">Dataset#columns</a> to <a
href="Model.html#M000388">find</a> the <a
href="Model.html#M000377">columns</a>, which may be empty if the <a
href="Dataset.html">Dataset</a> has no records.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000377-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000377-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 101</span>
101:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">columns</span>
102:       <span class="ruby-ivar">@columns</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">set_columns</span>(<span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">naked</span>.<span class="ruby-identifier">columns</span>)
103:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000378" class="method-detail">
        <a name="M000378"></a>

        <div class="method-heading">
          <a href="#M000378" class="method-signature">
          <span class="method-name">create</span><span class="method-args">(values = {}, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates <a href="Model.html#M000430">new</a> instance with values <a
href="Model.html#M000453">set</a> to passed-in <a
href="../Hash.html">Hash</a>, saves it (running any callbacks), and returns
the instance if the object was saved correctly. If there was an error
saving the object, returns false.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000378-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000378-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 109</span>
109:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">values</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
110:       <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">values</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
111:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">save</span>
112:       <span class="ruby-identifier">obj</span>
113:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000466" class="method-detail">
        <a name="M000466"></a>

        <div class="method-heading">
          <a href="#M000466" class="method-signature">
          <span class="method-name">create_table</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates table, using the column information from <a
href="Model.html#M000470">set_schema</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000466-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000466-source">
<pre>
   <span class="ruby-comment cmt"># File lib/sequel_model/schema.rb, line 4</span>
4:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">create_table</span>
5:       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">create_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-ivar">@schema</span>)
6:       <span class="ruby-ivar">@db_schema</span> = <span class="ruby-identifier">get_db_schema</span>(<span class="ruby-keyword kw">true</span>)
7:       <span class="ruby-identifier">columns</span>
8:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000467" class="method-detail">
        <a name="M000467"></a>

        <div class="method-heading">
          <a href="#M000467" class="method-signature">
          <span class="method-name">create_table!</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Drops the table if it exists and then runs <a
href="Model.html#M000466">create_table</a>. Should probably not be used
except in testing.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000467-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000467-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/schema.rb, line 12</span>
12:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">create_table!</span>
13:       <span class="ruby-identifier">drop_table</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
14:       <span class="ruby-identifier">create_table</span>
15:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000379" class="method-detail">
        <a name="M000379"></a>

        <div class="method-heading">
          <a href="#M000379" class="method-signature">
          <span class="method-name">dataset</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Model.html#M000379">dataset</a> associated with the <a
href="Model.html">Model</a> class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000379-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000379-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 116</span>
116:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">dataset</span>
117:       <span class="ruby-ivar">@dataset</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;No dataset associated with #{self}&quot;</span>)
118:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000380" class="method-detail">
        <a name="M000380"></a>

        <div class="method-heading">
          <a href="#M000380" class="method-signature">
          <span class="method-name">db</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the database associated with the <a href="Model.html">Model</a>
class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000380-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000380-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 121</span>
121:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">db</span>
122:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@db</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@db</span>
123:       <span class="ruby-ivar">@db</span> = <span class="ruby-keyword kw">self</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Model</span> <span class="ruby-value">? </span><span class="ruby-constant">DATABASES</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">db</span>
124:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;No database associated with #{self}&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@db</span>
125:       <span class="ruby-ivar">@db</span>
126:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000381" class="method-detail">
        <a name="M000381"></a>

        <div class="method-heading">
          <a href="#M000381" class="method-signature">
          <span class="method-name">db=</span><span class="method-args">(db)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the database associated with the <a href="Model.html">Model</a> class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000381-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000381-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 129</span>
129:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">db=</span>(<span class="ruby-identifier">db</span>)
130:       <span class="ruby-ivar">@db</span> = <span class="ruby-identifier">db</span>
131:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@dataset</span>
132:         <span class="ruby-identifier">set_dataset</span>(<span class="ruby-identifier">db</span>[<span class="ruby-identifier">table_name</span>])
133:       <span class="ruby-keyword kw">end</span>
134:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000382" class="method-detail">
        <a name="M000382"></a>

        <div class="method-heading">
          <a href="#M000382" class="method-signature">
          <span class="method-name">db_schema</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the cached <a href="Model.html#M000469">schema</a> information if
available or gets it from the database.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000382-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000382-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 138</span>
138:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">db_schema</span>
139:       <span class="ruby-ivar">@db_schema</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">get_db_schema</span>
140:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000383" class="method-detail">
        <a name="M000383"></a>

        <div class="method-heading">
          <a href="#M000383" class="method-signature">
          <span class="method-name">def_dataset_method</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
If a block <a href="Model.html#M000426">is</a> given, define a method on
the <a href="Model.html#M000379">dataset</a> with the given argument name
using the given block as well as a method on the model that calls the <a
href="Model.html#M000379">dataset</a> method.
</p>
<p>
If a block <a href="Model.html#M000426">is</a> not given, define a method
on the model for <a href="Model.html#M000439">each</a> argument that calls
the <a href="Model.html#M000379">dataset</a> method of the same argument
name.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000383-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000383-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 148</span>
148:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">def_dataset_method</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
149:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;No arguments given&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
150:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
151:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;Defining a dataset method using a block requires only one argument&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
152:         <span class="ruby-identifier">meth</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>
153:         <span class="ruby-ivar">@dataset_methods</span>[<span class="ruby-identifier">meth</span>] = <span class="ruby-identifier">block</span>
154:         <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">meta_def</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
155:       <span class="ruby-keyword kw">end</span>
156:       <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">instance_eval</span>(<span class="ruby-node">&quot;def #{arg}(*args, &amp;block); dataset.#{arg}(*args, &amp;block) end&quot;</span>, <span class="ruby-keyword kw">__FILE__</span>, <span class="ruby-keyword kw">__LINE__</span>)}
157:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000384" class="method-detail">
        <a name="M000384"></a>

        <div class="method-heading">
          <a href="#M000384" class="method-signature">
          <span class="method-name">delete_all</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deletes all records in the model&#8216;s table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000384-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000384-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 160</span>
160:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">delete_all</span>
161:       <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">delete</span>
162:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000385" class="method-detail">
        <a name="M000385"></a>

        <div class="method-heading">
          <a href="#M000385" class="method-signature">
          <span class="method-name">destroy_all</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Like <a href="Model.html#M000384">delete_all</a>, but invokes
before_destroy and after_destroy hooks if used.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000385-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000385-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 165</span>
165:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">destroy_all</span>
166:       <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">destroy</span>
167:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000468" class="method-detail">
        <a name="M000468"></a>

        <div class="method-heading">
          <a href="#M000468" class="method-signature">
          <span class="method-name">drop_table</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Drops table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000468-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000468-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/schema.rb, line 18</span>
18:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">drop_table</span>
19:       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">drop_table</span>(<span class="ruby-identifier">table_name</span>)
20:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000387" class="method-detail">
        <a name="M000387"></a>

        <div class="method-heading">
          <a href="#M000387" class="method-signature">
          <span class="method-name">eager_loading_dataset</span><span class="method-args">(opts, ds, select, associations)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Modify and return eager loading <a href="Model.html#M000379">dataset</a>
based on association options
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000387-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000387-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 175</span>
175:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">eager_loading_dataset</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">select</span>, <span class="ruby-identifier">associations</span>)
176:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">select</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">select</span>
177:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:order</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:order</span>]
178:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">eager</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:eager</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:eager</span>]
179:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">eager_graph</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:eager_graph</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:eager_graph</span>]
180:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">eager</span>(<span class="ruby-identifier">associations</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">associations</span>.<span class="ruby-identifier">blank?</span>
181:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:eager_block</span>].<span class="ruby-identifier">call</span>(<span class="ruby-identifier">ds</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:eager_block</span>]
182:       <span class="ruby-identifier">ds</span>
183:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000386" class="method-detail">
        <a name="M000386"></a>

        <div class="method-heading">
          <a href="#M000386" class="method-signature">
          <span class="method-name">fetch</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Model.html#M000379">dataset</a> with custom <a
href="SQL.html">SQL</a> that yields model objects.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000386-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000386-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 170</span>
170:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
171:       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>).<span class="ruby-identifier">set_model</span>(<span class="ruby-keyword kw">self</span>)
172:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000388" class="method-detail">
        <a name="M000388"></a>

        <div class="method-heading">
          <a href="#M000388" class="method-signature">
          <span class="method-name">find</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Finds a single record according to the supplied filter, e.g.:
</p>
<pre>
  Ticket.find :author =&gt; 'Sharon' # =&gt; record
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000388-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000388-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 188</span>
188:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">find</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
189:       <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">first</span>
190:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000389" class="method-detail">
        <a name="M000389"></a>

        <div class="method-heading">
          <a href="#M000389" class="method-signature">
          <span class="method-name">find_or_create</span><span class="method-args">(cond)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Like <a href="Model.html#M000388">find</a> but invokes <a
href="Model.html#M000378">create</a> with given conditions when record does
not exists.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000389-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000389-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 194</span>
194:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">find_or_create</span>(<span class="ruby-identifier">cond</span>)
195:       <span class="ruby-identifier">find</span>(<span class="ruby-identifier">cond</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">create</span>(<span class="ruby-identifier">cond</span>)
196:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000424" class="method-detail">
        <a name="M000424"></a>

        <div class="method-heading">
          <a href="#M000424" class="method-signature">
          <span class="method-name">has_hooks?</span><span class="method-args">(hook)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if there are any hook blocks for the given hook.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000424-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000424-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/hooks.rb, line 12</span>
12:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">has_hooks?</span>(<span class="ruby-identifier">hook</span>)
13:       <span class="ruby-operator">!</span><span class="ruby-ivar">@hooks</span>[<span class="ruby-identifier">hook</span>].<span class="ruby-identifier">empty?</span>
14:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000408" class="method-detail">
        <a name="M000408"></a>

        <div class="method-heading">
          <a href="#M000408" class="method-signature">
          <span class="method-name">has_validations?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if <a href="Model.html#M000420">validations</a> are defined.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000408-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000408-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 60</span>
60:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">has_validations?</span>
61:       <span class="ruby-operator">!</span><span class="ruby-identifier">validations</span>.<span class="ruby-identifier">empty?</span>
62:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000425" class="method-detail">
        <a name="M000425"></a>

        <div class="method-heading">
          <a href="#M000425" class="method-signature">
          <span class="method-name">hook_blocks</span><span class="method-args">(hook) {|v| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Yield every block related to the given hook.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000425-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000425-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/hooks.rb, line 17</span>
17:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">hook_blocks</span>(<span class="ruby-identifier">hook</span>)
18:       <span class="ruby-ivar">@hooks</span>[<span class="ruby-identifier">hook</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">v</span>}
19:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000391" class="method-detail">
        <a name="M000391"></a>

        <div class="method-heading">
          <a href="#M000391" class="method-signature">
          <span class="method-name">implicit_table_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the implicit table name for the model class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000391-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000391-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 226</span>
226:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">implicit_table_name</span>
227:       <span class="ruby-identifier">name</span>.<span class="ruby-identifier">demodulize</span>.<span class="ruby-identifier">underscore</span>.<span class="ruby-identifier">pluralize</span>.<span class="ruby-identifier">to_sym</span>
228:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000390" class="method-detail">
        <a name="M000390"></a>

        <div class="method-heading">
          <a href="#M000390" class="method-signature">
          <span class="method-name">inherited</span><span class="method-args">(subclass)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
If possible, <a href="Model.html#M000453">set</a> the <a
href="Model.html#M000379">dataset</a> for the model subclass as soon as it
<a href="Model.html#M000426">is</a> created. Also, inherit the
INHERITED_INSTANCE_VARIABLES from the parent class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000390-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000390-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 201</span>
201:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">inherited</span>(<span class="ruby-identifier">subclass</span>)
202:       <span class="ruby-identifier">sup_class</span> = <span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">superclass</span>
203:       <span class="ruby-identifier">ivs</span> = <span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">instance_variables</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_s</span>}
204:       <span class="ruby-constant">INHERITED_INSTANCE_VARIABLES</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">iv</span>, <span class="ruby-identifier">dup</span><span class="ruby-operator">|</span>
205:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ivs</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">iv</span>.<span class="ruby-identifier">to_s</span>)
206:         <span class="ruby-identifier">sup_class_value</span> = <span class="ruby-identifier">sup_class</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">iv</span>)
207:         <span class="ruby-identifier">sup_class_value</span> = <span class="ruby-identifier">sup_class_value</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dup</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:dup</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">sup_class_value</span>
208:         <span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">iv</span>, <span class="ruby-identifier">sup_class_value</span>)
209:       <span class="ruby-keyword kw">end</span>
210:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ivs</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;@dataset&quot;</span>)
211:         <span class="ruby-keyword kw">begin</span>
212:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sup_class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Model</span>
213:             <span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">set_dataset</span>(<span class="ruby-constant">Model</span>.<span class="ruby-identifier">db</span>[<span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">implicit_table_name</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">blank?</span>
214:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">sup_class</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">:@dataset</span>)
215:             <span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">set_dataset</span>(<span class="ruby-identifier">sup_class</span>.<span class="ruby-identifier">sti_key</span> <span class="ruby-value">? </span><span class="ruby-identifier">sup_class</span>.<span class="ruby-identifier">sti_dataset</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">sup_class</span>.<span class="ruby-identifier">sti_key</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">clone</span>, <span class="ruby-identifier">:inherited=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span>)
216:           <span class="ruby-keyword kw">end</span>
217:         <span class="ruby-keyword kw">rescue</span>
218:           <span class="ruby-keyword kw">nil</span>
219:         <span class="ruby-keyword kw">end</span>
220:       <span class="ruby-keyword kw">end</span>
221:       <span class="ruby-identifier">hooks</span> = <span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">:@hooks</span>, {})
222:       <span class="ruby-identifier">sup_class</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">:@hooks</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hooks</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">dup</span>}
223:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000426" class="method-detail">
        <a name="M000426"></a>

        <div class="method-heading">
          <a href="#M000426" class="method-signature">
          <span class="method-name">is</span><span class="method-args">(plugin, *args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Loads a plugin for use with the model class, passing optional arguments to
the plugin. If the plugin has a <a
href="Model/DatasetMethods.html">DatasetMethods</a> module and the model
doesn&#8216;t have a <a href="Model.html#M000379">dataset</a>, raise an <a
href="Error.html">Error</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000426-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000426-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/plugins.rb, line 21</span>
21:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">is</span>(<span class="ruby-identifier">plugin</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
22:       <span class="ruby-identifier">m</span> = <span class="ruby-identifier">plugin_module</span>(<span class="ruby-identifier">plugin</span>)
23:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;Plugin cannot be applied because the model class has no dataset&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">const_defined?</span>(<span class="ruby-value str">&quot;DatasetMethods&quot;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@dataset</span>
24:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:apply</span>)
25:         <span class="ruby-identifier">m</span>.<span class="ruby-identifier">apply</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
26:       <span class="ruby-keyword kw">end</span>
27:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">const_defined?</span>(<span class="ruby-value str">&quot;InstanceMethods&quot;</span>)
28:         <span class="ruby-identifier">class_def</span>(<span class="ruby-node">&quot;#{plugin}_opts&quot;</span><span class="ruby-node">&quot;#{plugin}_opts&quot;</span>) {<span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>}
29:         <span class="ruby-identifier">include</span>(<span class="ruby-identifier">m</span><span class="ruby-operator">::</span><span class="ruby-constant">InstanceMethods</span>)
30:       <span class="ruby-keyword kw">end</span>
31:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">const_defined?</span>(<span class="ruby-value str">&quot;ClassMethods&quot;</span>)
32:         <span class="ruby-identifier">meta_def</span>(<span class="ruby-node">&quot;#{plugin}_opts&quot;</span><span class="ruby-node">&quot;#{plugin}_opts&quot;</span>) {<span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>}
33:         <span class="ruby-identifier">extend</span>(<span class="ruby-identifier">m</span><span class="ruby-operator">::</span><span class="ruby-constant">ClassMethods</span>)
34:       <span class="ruby-keyword kw">end</span>
35:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">const_defined?</span>(<span class="ruby-value str">&quot;DatasetMethods&quot;</span>)
36:         <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">meta_def</span>(<span class="ruby-node">&quot;#{plugin}_opts&quot;</span><span class="ruby-node">&quot;#{plugin}_opts&quot;</span>) {<span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>}
37:         <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-identifier">m</span><span class="ruby-operator">::</span><span class="ruby-constant">DatasetMethods</span>)
38:         <span class="ruby-identifier">def_dataset_method</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">m</span><span class="ruby-operator">::</span><span class="ruby-constant">DatasetMethods</span>.<span class="ruby-identifier">public_instance_methods</span>)
39:       <span class="ruby-keyword kw">end</span>
40:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000392" class="method-detail">
        <a name="M000392"></a>

        <div class="method-heading">
          <a href="#M000392" class="method-signature">
          <span class="method-name">load</span><span class="method-args">(values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Initializes a model instance as an existing record. This constructor <a
href="Model.html#M000426">is</a> used by <a
href="../Sequel.html">Sequel</a> to initialize model instances when
fetching records. <a href="Model.html#M000392">load</a> requires that
values be a <a href="Model.html#M000441">hash</a> where all <a
href="Model.html#M000444">keys</a> are symbols. It probably should not be
used by external code.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000392-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000392-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 234</span>
234:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">values</span>)
235:       <span class="ruby-identifier">new</span>(<span class="ruby-identifier">values</span>, <span class="ruby-keyword kw">true</span>)
236:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000430" class="method-detail">
        <a name="M000430"></a>

        <div class="method-heading">
          <a href="#M000430" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(values = {}, from_db = false) {|self if block_given?| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates <a href="Model.html#M000430">new</a> instance with values <a
href="Model.html#M000453">set</a> to passed-in <a
href="../Hash.html">Hash</a>. If a block <a
href="Model.html#M000426">is</a> given, yield the instance to the block
unless from_db <a href="Model.html#M000426">is</a> true. This method runs
the after_initialize hook after it has optionally yielded itself to the
block.
</p>
<p>
Arguments:
</p>
<ul>
<li>values - should be a <a href="Model.html#M000441">hash</a> with symbol <a
href="Model.html#M000444">keys</a>, though string <a
href="Model.html#M000444">keys</a> will work if from_db <a
href="Model.html#M000426">is</a> false.

</li>
<li>from_db - should only be <a href="Model.html#M000453">set</a> by <a
href="Model.html#M000392">Model.load</a>, forget it exists.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000430-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000430-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 26</span>
26:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">values</span> = {}, <span class="ruby-identifier">from_db</span> = <span class="ruby-keyword kw">false</span>)
27:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">from_db</span>
28:         <span class="ruby-ivar">@new</span> = <span class="ruby-keyword kw">false</span>
29:         <span class="ruby-ivar">@values</span> = <span class="ruby-identifier">values</span>
30:       <span class="ruby-keyword kw">else</span>
31:         <span class="ruby-ivar">@values</span> = {}
32:         <span class="ruby-ivar">@new</span> = <span class="ruby-keyword kw">true</span>
33:         <span class="ruby-identifier">set</span>(<span class="ruby-identifier">values</span>)
34:         <span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">clear</span> 
35:         <span class="ruby-keyword kw">yield</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
36:       <span class="ruby-keyword kw">end</span>
37:       <span class="ruby-identifier">after_initialize</span>
38:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000393" class="method-detail">
        <a name="M000393"></a>

        <div class="method-heading">
          <a href="#M000393" class="method-signature">
          <span class="method-name">no_primary_key</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Mark the model as not having a primary key. Not having a primary key can
cause issues, among which <a href="Model.html#M000426">is</a> that you
won&#8216;t be able to <a href="Model.html#M000460">update</a> records.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000393-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000393-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 240</span>
240:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">no_primary_key</span>
241:       <span class="ruby-ivar">@primary_key</span> = <span class="ruby-keyword kw">nil</span>
242:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000394" class="method-detail">
        <a name="M000394"></a>

        <div class="method-heading">
          <a href="#M000394" class="method-signature">
          <span class="method-name">primary_key_hash</span><span class="method-args">(value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns primary key attribute <a href="Model.html#M000441">hash</a>. If
using a composite primary key value such be an array with values for <a
href="Model.html#M000439">each</a> primary key in the correct order. For a
standard primary key, value should be an object with a compatible type for
the key. If the model does not have a primary key, raises an <a
href="Error.html">Error</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000394-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000394-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 249</span>
249:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">primary_key_hash</span>(<span class="ruby-identifier">value</span>)
250:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;#{self} does not have a primary key&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">key</span> = <span class="ruby-ivar">@primary_key</span>
251:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">key</span>
252:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
253:         <span class="ruby-identifier">hash</span> = {}
254:         <span class="ruby-identifier">key</span>.<span class="ruby-identifier">each_with_index</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">value</span>[<span class="ruby-identifier">i</span>]}
255:         <span class="ruby-identifier">hash</span>
256:       <span class="ruby-keyword kw">else</span>
257:         {<span class="ruby-identifier">key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">value</span>}
258:       <span class="ruby-keyword kw">end</span>
259:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000395" class="method-detail">
        <a name="M000395"></a>

        <div class="method-heading">
          <a href="#M000395" class="method-signature">
          <span class="method-name">restrict_primary_key</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Restrict the setting of the primary key(s) inside new/set/update. Because
<a href="Model.html#M000459">this</a> <a href="Model.html#M000426">is</a>
the default, <a href="Model.html#M000459">this</a> only make sense to use
in a subclass where the parent class has used <a
href="Model.html#M000407">unrestrict_primary_key</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000395-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000395-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 264</span>
264:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">restrict_primary_key</span>
265:       <span class="ruby-ivar">@restrict_primary_key</span> = <span class="ruby-keyword kw">true</span>
266:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000396" class="method-detail">
        <a name="M000396"></a>

        <div class="method-heading">
          <a href="#M000396" class="method-signature">
          <span class="method-name">restrict_primary_key?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Whether or not setting the primary key inside new/set/update <a
href="Model.html#M000426">is</a> restricted, true by default.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000396-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000396-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 270</span>
270:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">restrict_primary_key?</span>
271:       <span class="ruby-ivar">@restrict_primary_key</span>
272:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000469" class="method-detail">
        <a name="M000469"></a>

        <div class="method-heading">
          <a href="#M000469" class="method-signature">
          <span class="method-name">schema</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns table <a href="Model.html#M000469">schema</a> created with <a
href="Model.html#M000470">set_schema</a> for direct descendant of <a
href="Model.html">Model</a>. Does not retreive <a
href="Model.html#M000469">schema</a> information from the database, see <a
href="Model.html#M000382">db_schema</a> if you want that.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000469-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000469-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/schema.rb, line 25</span>
25:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">schema</span>
26:       <span class="ruby-ivar">@schema</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">schema</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">superclass</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Model</span>)
27:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000397" class="method-detail">
        <a name="M000397"></a>

        <div class="method-heading">
          <a href="#M000397" class="method-signature">
          <span class="method-name">serialize</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Serializes column with YAML or through marshalling. Arguments should be
column symbols, with an optional trailing <a
href="Model.html#M000441">hash</a> with a :format key <a
href="Model.html#M000453">set</a> to :yaml or :marshal (:yaml <a
href="Model.html#M000426">is</a> the default). Setting <a
href="Model.html#M000459">this</a> adds a transform to the model and <a
href="Model.html#M000379">dataset</a> so that <a
href="Model.html#M000377">columns</a> values will be serialized when saved
and deserialized when returned from the database.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000397-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000397-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 279</span>
279:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">serialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
280:       <span class="ruby-identifier">format</span> = <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">extract_options!</span>[<span class="ruby-identifier">:format</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">:yaml</span>
281:       <span class="ruby-ivar">@transform</span> = <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
282:         <span class="ruby-identifier">m</span>[<span class="ruby-identifier">c</span>] = <span class="ruby-identifier">format</span>
283:         <span class="ruby-identifier">m</span>
284:       <span class="ruby-keyword kw">end</span>
285:       <span class="ruby-ivar">@dataset</span>.<span class="ruby-identifier">transform</span>(<span class="ruby-ivar">@transform</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@dataset</span>
286:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000398" class="method-detail">
        <a name="M000398"></a>

        <div class="method-heading">
          <a href="#M000398" class="method-signature">
          <span class="method-name">serialized?</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Whether or not the given column <a href="Model.html#M000426">is</a>
serialized for <a href="Model.html#M000459">this</a> model.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000398-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000398-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 289</span>
289:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">serialized?</span>(<span class="ruby-identifier">column</span>)
290:       <span class="ruby-ivar">@transform</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@transform</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">column</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>
291:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000399" class="method-detail">
        <a name="M000399"></a>

        <div class="method-heading">
          <a href="#M000399" class="method-signature">
          <span class="method-name">set_allowed_columns</span><span class="method-args">(*cols)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the <a href="Model.html#M000377">columns</a> to allow in
new/set/update. Using <a href="Model.html#M000459">this</a> means that any
<a href="Model.html#M000377">columns</a> not listed here will not be
modified. If you have any virtual setter methods (methods that end in =)
that you want to be used in new/set/update, they need to be listed here as
well (without the =).
</p>
<p>
It may be better to use (<a href="Model.html#M000453">set</a>|<a
href="Model.html#M000460">update</a>)_only instead of <a
href="Model.html#M000459">this</a> in places where only certain <a
href="Model.html#M000377">columns</a> may be allowed.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000399-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000399-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 300</span>
300:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_allowed_columns</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cols</span>)
301:       <span class="ruby-ivar">@allowed_columns</span> = <span class="ruby-identifier">cols</span>
302:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000427" class="method-detail">
        <a name="M000427"></a>

        <div class="method-heading">
          <a href="#M000427" class="method-signature">
          <span class="method-name">set_cache</span><span class="method-args">(store, opts = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the cache store for the model, as well as the caching before_* hooks.
</p>
<p>
The cache store should implement the following API:
</p>
<pre>
   cache_store.set(key, obj, time) # Associate the obj with the given key
                                   # in the cache for the time (specified
                                   # in seconds)
   cache_store.get(key) =&gt; obj # Returns object set with same key
   cache_store.get(key2) =&gt; nil # nil returned if there isn't an object
                                # currently in the cache with that key
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000427-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000427-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/caching.rb, line 17</span>
17:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_cache</span>(<span class="ruby-identifier">store</span>, <span class="ruby-identifier">opts</span> = {})
18:       <span class="ruby-ivar">@cache_store</span> = <span class="ruby-identifier">store</span>
19:       <span class="ruby-ivar">@cache_ttl</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:ttl</span>] <span class="ruby-operator">||</span> <span class="ruby-value">3600</span>
20:       <span class="ruby-identifier">before_save</span> <span class="ruby-identifier">:cache_delete_unless_new</span>
21:       <span class="ruby-identifier">before_update_values</span> <span class="ruby-identifier">:cache_delete</span>
22:       <span class="ruby-identifier">before_delete</span> <span class="ruby-identifier">:cache_delete</span>
23:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000428" class="method-detail">
        <a name="M000428"></a>

        <div class="method-heading">
          <a href="#M000428" class="method-signature">
          <span class="method-name">set_cache_ttl</span><span class="method-args">(ttl)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the time to live for the cache store, in seconds (default <a
href="Model.html#M000426">is</a> 3600, so 1 hour).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000428-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000428-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/caching.rb, line 27</span>
27:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_cache_ttl</span>(<span class="ruby-identifier">ttl</span>)
28:       <span class="ruby-ivar">@cache_ttl</span> = <span class="ruby-identifier">ttl</span>
29:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000400" class="method-detail">
        <a name="M000400"></a>

        <div class="method-heading">
          <a href="#M000400" class="method-signature">
          <span class="method-name">set_dataset</span><span class="method-args">(ds, opts={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the <a href="Model.html#M000379">dataset</a> associated with the <a
href="Model.html">Model</a> class. ds can be a <a
href="../Symbol.html">Symbol</a> (specifying a table name in the current
database), or a <a href="Dataset.html">Dataset</a>. If a <a
href="Model.html#M000379">dataset</a> <a href="Model.html#M000426">is</a>
used, the model&#8216;s database <a href="Model.html#M000426">is</a>
changed to the given <a href="Model.html#M000379">dataset</a>. If a symbol
<a href="Model.html#M000426">is</a> used, a <a
href="Model.html#M000379">dataset</a> <a href="Model.html#M000426">is</a>
created from the current database with the table name given. Other
arguments raise an <a href="Error.html">Error</a>.
</p>
<p>
This sets the model of the the given/created <a
href="Model.html#M000379">dataset</a> to the current model and adds a <a
href="Model.html#M000438">destroy</a> method to it. It also extends the <a
href="Model.html#M000379">dataset</a> with the <a
href="Model/Associations/EagerLoading.html">Associations::EagerLoading</a>
methods, and assigns a transform to it if there <a
href="Model.html#M000426">is</a> one associated with the model. Finally, it
attempts to determine the database <a href="Model.html#M000469">schema</a>
based on the given/created <a href="Model.html#M000379">dataset</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000400-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000400-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 315</span>
315:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_dataset</span>(<span class="ruby-identifier">ds</span>, <span class="ruby-identifier">opts</span>={})
316:       <span class="ruby-identifier">inherited</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:inherited</span>]
317:       <span class="ruby-ivar">@dataset</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">ds</span>
318:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
319:         <span class="ruby-identifier">db</span>[<span class="ruby-identifier">ds</span>]
320:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Dataset</span>
321:         <span class="ruby-ivar">@db</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">db</span>
322:         <span class="ruby-identifier">ds</span>
323:       <span class="ruby-keyword kw">else</span>
324:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;Model.set_dataset takes a Symbol or a Sequel::Dataset&quot;</span>)
325:       <span class="ruby-keyword kw">end</span>
326:       <span class="ruby-ivar">@dataset</span>.<span class="ruby-identifier">set_model</span>(<span class="ruby-keyword kw">self</span>)
327:       <span class="ruby-ivar">@dataset</span>.<span class="ruby-identifier">transform</span>(<span class="ruby-ivar">@transform</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@transform</span>
328:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">inherited</span>
329:         <span class="ruby-ivar">@columns</span> = <span class="ruby-ivar">@dataset</span>.<span class="ruby-identifier">columns</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
330:       <span class="ruby-keyword kw">else</span>
331:         <span class="ruby-ivar">@dataset</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">DatasetMethods</span>)
332:         <span class="ruby-ivar">@dataset</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">Associations</span><span class="ruby-operator">::</span><span class="ruby-constant">EagerLoading</span>)
333:         <span class="ruby-ivar">@dataset_methods</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">meth</span>, <span class="ruby-identifier">block</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@dataset</span>.<span class="ruby-identifier">meta_def</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)} <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@dataset_methods</span>
334:       <span class="ruby-keyword kw">end</span>
335:       <span class="ruby-ivar">@db_schema</span> = (<span class="ruby-identifier">inherited</span> <span class="ruby-value">? </span><span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">db_schema</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">get_db_schema</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
336:       <span class="ruby-keyword kw">self</span>
337:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000401" class="method-detail">
        <a name="M000401"></a>

        <div class="method-heading">
          <a href="#M000401" class="method-signature">
          <span class="method-name">set_primary_key</span><span class="method-args">(*key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets primary key, regular and composite are possible.
</p>
<p>
Example:
</p>
<pre>
  class Tagging &lt; Sequel::Model
    # composite key
    set_primary_key :taggable_id, :tag_id
  end

  class Person &lt; Sequel::Model
    # regular key
    set_primary_key :person_id
  end
</pre>
<p>
You can <a href="Model.html#M000453">set</a> it to nil to not have a
primary key, but that cause certain things not to work, see <a
href="Model.html#M000393">no_primary_key</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000401-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000401-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 355</span>
355:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_primary_key</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">key</span>)
356:       <span class="ruby-ivar">@primary_key</span> = (<span class="ruby-identifier">key</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">key</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">flatten</span>
357:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000402" class="method-detail">
        <a name="M000402"></a>

        <div class="method-heading">
          <a href="#M000402" class="method-signature">
          <span class="method-name">set_restricted_columns</span><span class="method-args">(*cols)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the <a href="Model.html#M000377">columns</a> to restrict in
new/set/update. Using <a href="Model.html#M000459">this</a> means that any
<a href="Model.html#M000377">columns</a> listed here will not be modified.
If you have any virtual setter methods (methods that end in =) that you
want not to be used in new/set/update, they need to be listed here as well
(without the =).
</p>
<p>
It may be better to use (<a href="Model.html#M000453">set</a>|<a
href="Model.html#M000460">update</a>)_except instead of <a
href="Model.html#M000459">this</a> in places where only certain <a
href="Model.html#M000377">columns</a> may be allowed.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000402-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000402-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 366</span>
366:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_restricted_columns</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cols</span>)
367:       <span class="ruby-ivar">@restricted_columns</span> = <span class="ruby-identifier">cols</span>
368:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000470" class="method-detail">
        <a name="M000470"></a>

        <div class="method-heading">
          <a href="#M000470" class="method-signature">
          <span class="method-name">set_schema</span><span class="method-args">(name = nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Defines a table <a href="Model.html#M000469">schema</a> (see <a
href="Schema/Generator.html">Schema::Generator</a> for more information).
</p>
<p>
This <a href="Model.html#M000426">is</a> only needed if you want to use the
create_table/create_table! methods. Will also <a
href="Model.html#M000453">set</a> the <a
href="Model.html#M000379">dataset</a> if you provide a name, as well as
setting the primary key if you defined one in the passed block.
</p>
<p>
In general, it <a href="Model.html#M000426">is</a> a better idea to use
migrations for production code, as migrations allow changes to existing <a
href="Model.html#M000469">schema</a>. <a
href="Model.html#M000470">set_schema</a> <a
href="Model.html#M000426">is</a> mostly useful for test code or simple
examples.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000470-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000470-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/schema.rb, line 38</span>
38:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_schema</span>(<span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
39:       <span class="ruby-identifier">set_dataset</span>(<span class="ruby-identifier">db</span>[<span class="ruby-identifier">name</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>
40:       <span class="ruby-ivar">@schema</span> = <span class="ruby-constant">Schema</span><span class="ruby-operator">::</span><span class="ruby-constant">Generator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">db</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
41:       <span class="ruby-identifier">set_primary_key</span>(<span class="ruby-ivar">@schema</span>.<span class="ruby-identifier">primary_key_name</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@schema</span>.<span class="ruby-identifier">primary_key_name</span>
42:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000403" class="method-detail">
        <a name="M000403"></a>

        <div class="method-heading">
          <a href="#M000403" class="method-signature">
          <span class="method-name">set_sti_key</span><span class="method-args">(key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Makes <a href="Model.html#M000459">this</a> model a polymorphic model with
the given key being a string field in the database holding the name of the
class to use. If the key given has a NULL value or there are any problems
looking up the class, uses the current class.
</p>
<p>
This should be used to <a href="Model.html#M000453">set</a> up single table
inheritance for the model, and it only makes sense to use <a
href="Model.html#M000459">this</a> in the parent class.
</p>
<p>
You should call sti_key after any calls to <a
href="Model.html#M000400">set_dataset</a> in the model, otherwise
subclasses might not have the filters <a href="Model.html#M000453">set</a>
up correctly.
</p>
<p>
The filters that sti_key sets up in subclasses will not work if those
subclasses have further subclasses. For those middle subclasses, you will
need to call <a href="Model.html#M000400">set_dataset</a> manually with the
correct filter <a href="Model.html#M000453">set</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000403-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000403-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 384</span>
384:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">set_sti_key</span>(<span class="ruby-identifier">key</span>)
385:       <span class="ruby-identifier">m</span> = <span class="ruby-keyword kw">self</span>
386:       <span class="ruby-ivar">@sti_key</span> = <span class="ruby-identifier">key</span>
387:       <span class="ruby-ivar">@sti_dataset</span> = <span class="ruby-identifier">dataset</span>
388:       <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">set_model</span>(<span class="ruby-identifier">key</span>, <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">h</span>,<span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = (<span class="ruby-identifier">k</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-identifier">m</span>)})
389:       <span class="ruby-identifier">before_create</span>(<span class="ruby-identifier">:set_sti_key</span>){<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{key}=&quot;</span>, <span class="ruby-identifier">model</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>)}
390:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000409" class="method-detail">
        <a name="M000409"></a>

        <div class="method-heading">
          <a href="#M000409" class="method-signature">
          <span class="method-name">skip_superclass_validations</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Instructs the model to skip <a href="Model.html#M000420">validations</a>
defined in superclasses
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000409-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000409-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 65</span>
65:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">skip_superclass_validations</span>
66:       <span class="ruby-ivar">@skip_superclass_validations</span> = <span class="ruby-keyword kw">true</span>
67:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000404" class="method-detail">
        <a name="M000404"></a>

        <div class="method-heading">
          <a href="#M000404" class="method-signature">
          <span class="method-name">str_columns</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Model.html#M000377">columns</a> as a list of frozen
strings instead of a list of symbols. This makes it possible to check
whether a column exists without creating a symbol, which would be a memory
leak if called with user input.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000404-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000404-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 396</span>
396:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">str_columns</span>
397:       <span class="ruby-ivar">@str_columns</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">freeze</span>}
398:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000405" class="method-detail">
        <a name="M000405"></a>

        <div class="method-heading">
          <a href="#M000405" class="method-signature">
          <span class="method-name">subset</span><span class="method-args">(name, *args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Defines a method that returns a filtered <a
href="Model.html#M000379">dataset</a>. Subsets <a
href="Model.html#M000378">create</a> <a
href="Model.html#M000379">dataset</a> methods, so they can be chained for
scoping. For example:
</p>
<pre>
  Topic.subset(:popular, :num_posts &gt; 100)
  Topic.subset(:recent, :created_on &gt; Date.today - 7)
</pre>
<p>
Allows you to do:
</p>
<pre>
  Topic.filter(:username.like('%joe%')).popular.recent
</pre>
<p>
to get topics with a username that includes joe that have more than 100
posts and were created less than 7 days ago.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000405-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000405-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 414</span>
414:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">subset</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
415:       <span class="ruby-identifier">def_dataset_method</span>(<span class="ruby-identifier">name</span>){<span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)}
416:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000471" class="method-detail">
        <a name="M000471"></a>

        <div class="method-heading">
          <a href="#M000471" class="method-signature">
          <span class="method-name">table_exists?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if table exists, false otherwise.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000471-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000471-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/schema.rb, line 45</span>
45:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">table_exists?</span>
46:       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">table_name</span>)
47:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000406" class="method-detail">
        <a name="M000406"></a>

        <div class="method-heading">
          <a href="#M000406" class="method-signature">
          <span class="method-name">table_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns name of primary table for the <a
href="Model.html#M000379">dataset</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000406-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000406-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 419</span>
419:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">table_name</span>
420:       <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">first</span>
421:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000407" class="method-detail">
        <a name="M000407"></a>

        <div class="method-heading">
          <a href="#M000407" class="method-signature">
          <span class="method-name">unrestrict_primary_key</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Allow the setting of the primary key(s) inside new/set/update.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000407-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000407-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/base.rb, line 424</span>
424:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unrestrict_primary_key</span>
425:       <span class="ruby-ivar">@restrict_primary_key</span> = <span class="ruby-keyword kw">false</span>
426:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000411" class="method-detail">
        <a name="M000411"></a>

        <div class="method-heading">
          <a href="#M000411" class="method-signature">
          <span class="method-name">validate</span><span class="method-args">(o)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the given instance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000411-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000411-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 91</span>
 91:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">o</span>)
 92:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:validate</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@skip_superclass_validations</span>
 93:         <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">o</span>)
 94:       <span class="ruby-keyword kw">end</span>
 95:       <span class="ruby-identifier">validations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">att</span>, <span class="ruby-identifier">procs</span><span class="ruby-operator">|</span>
 96:         <span class="ruby-identifier">v</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">att</span>
 97:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
 98:           <span class="ruby-identifier">att</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">a</span>)}
 99:         <span class="ruby-keyword kw">else</span>
100:           <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">att</span>)
101:         <span class="ruby-keyword kw">end</span>
102:         <span class="ruby-identifier">procs</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span>, <span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">o</span>, <span class="ruby-identifier">att</span>, <span class="ruby-identifier">v</span>)}
103:       <span class="ruby-keyword kw">end</span>
104:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000410" class="method-detail">
        <a name="M000410"></a>

        <div class="method-heading">
          <a href="#M000410" class="method-signature">
          <span class="method-name">validates</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Defines <a href="Model.html#M000420">validations</a> by converting a
longhand block into a series of shorthand definitions. For example:
</p>
<pre>
  class MyClass
    include Validation
    validates do
      length_of :name, :minimum =&gt; 6
      length_of :password, :minimum =&gt; 8
    end
  end
</pre>
<p>
<a href="Model.html#M000426">is</a> equivalent to:
</p>
<pre>
  class MyClass
    include Validation
    validates_length_of :name, :minimum =&gt; 6
    validates_length_of :password, :minimum =&gt; 8
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000410-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000410-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 86</span>
86:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
87:       <span class="ruby-constant">Validation</span><span class="ruby-operator">::</span><span class="ruby-constant">Generator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
88:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000412" class="method-detail">
        <a name="M000412"></a>

        <div class="method-heading">
          <a href="#M000412" class="method-signature">
          <span class="method-name">validates_acceptance_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates acceptance of an attribute. Just checks that the value <a
href="Model.html#M000426">is</a> equal to the :accept option.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:accept - The value required for the object to be valid (default:
&#8216;1&#8217;)

</li>
<li>:allow_blank - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> blank (default: false)

</li>
<li>:allow_nil - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> nil (default: true)

</li>
<li>:if - A symbol (indicating an instance_method) or proc (which <a
href="Model.html#M000426">is</a> instance_evaled) skipping <a
href="Model.html#M000459">this</a> validation if it returns nil or false.

</li>
<li>:message - The message to use (default: &#8216;<a
href="Model.html#M000426">is</a> not accepted&#8217;)

</li>
<li>:tag - The tag to use for <a href="Model.html#M000459">this</a> validation
(default: :acceptance)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000412-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000412-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 117</span>
117:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
118:       <span class="ruby-identifier">opts</span> = {
119:         <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is not accepted'</span>,
120:         <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
121:         <span class="ruby-identifier">:accept</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'1'</span>
122:       }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">atts</span>.<span class="ruby-identifier">extract_options!</span>)
123:       
124:       <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">:if</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>], <span class="ruby-identifier">:tag=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]<span class="ruby-operator">||</span><span class="ruby-identifier">:acceptance</span>}
125:       <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
126:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_nil</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_blank</span>])
127:         <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:accept</span>]
128:       <span class="ruby-keyword kw">end</span>
129:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000413" class="method-detail">
        <a name="M000413"></a>

        <div class="method-heading">
          <a href="#M000413" class="method-signature">
          <span class="method-name">validates_confirmation_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates confirmation of an attribute. Checks that the object has a
_confirmation value matching the current value. For example:
</p>
<pre>
  validates_confirmation_of :blah
</pre>
<p>
Just makes sure that object.blah = object.blah_confirmation. Often used for
passwords or email addresses on web forms.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:allow_false - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> blank (default: false)

</li>
<li>:allow_nil - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> nil (default: false)

</li>
<li>:if - A symbol (indicating an instance_method) or proc (which <a
href="Model.html#M000426">is</a> instance_evaled) skipping <a
href="Model.html#M000459">this</a> validation if it returns nil or false.

</li>
<li>:message - The message to use (default: &#8216;<a
href="Model.html#M000426">is</a> not confirmed&#8217;)

</li>
<li>:tag - The tag to use for <a href="Model.html#M000459">this</a> validation
(default: :confirmation)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000413-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000413-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 146</span>
146:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates_confirmation_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
147:       <span class="ruby-identifier">opts</span> = {
148:         <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is not confirmed'</span>,
149:       }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">atts</span>.<span class="ruby-identifier">extract_options!</span>)
150:      
151:       <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">:if</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>], <span class="ruby-identifier">:tag=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]<span class="ruby-operator">||</span><span class="ruby-identifier">:confirmation</span>}
152:       <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
153:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_nil</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_blank</span>])
154:         <span class="ruby-identifier">c</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{a}_confirmation&quot;</span><span class="ruby-node">&quot;#{a}_confirmation&quot;</span>)
155:         <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">c</span>
156:       <span class="ruby-keyword kw">end</span>
157:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000414" class="method-detail">
        <a name="M000414"></a>

        <div class="method-heading">
          <a href="#M000414" class="method-signature">
          <span class="method-name">validates_each</span><span class="method-args">(*atts, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds a validation for <a href="Model.html#M000439">each</a> of the given
attributes using the supplied block. The block must accept three arguments:
instance, attribute and value, e.g.:
</p>
<pre>
  validates_each :name, :password do |object, attribute, value|
    object.errors[attribute] &lt;&lt; 'is not nice' unless value.nice?
  end
</pre>
<p>
Possible Options:
</p>
<ul>
<li>:if - A symbol (indicating an instance_method) or proc (which <a
href="Model.html#M000426">is</a> instance_evaled) skipping <a
href="Model.html#M000459">this</a> validation if it returns nil or false.

</li>
<li>:tag - The tag to use for <a href="Model.html#M000459">this</a> validation
(default: nil)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000414-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000414-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 171</span>
171:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
172:       <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">atts</span>.<span class="ruby-identifier">extract_options!</span>
173:       <span class="ruby-identifier">blk</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>]
174:         <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span>,<span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">o</span>,<span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">if_proc</span>(<span class="ruby-identifier">opts</span>))}
175:       <span class="ruby-keyword kw">else</span>
176:         <span class="ruby-identifier">block</span>
177:       <span class="ruby-keyword kw">end</span>
178:       <span class="ruby-identifier">tag</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]
179:       <span class="ruby-identifier">atts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> 
180:         <span class="ruby-identifier">a_vals</span> = <span class="ruby-identifier">validations</span>[<span class="ruby-identifier">a</span>]
181:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tag</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">old</span> = <span class="ruby-identifier">a_vals</span>.<span class="ruby-identifier">find</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">tag</span>})
182:           <span class="ruby-identifier">old</span>[<span class="ruby-value">1</span>] = <span class="ruby-identifier">blk</span>
183:         <span class="ruby-keyword kw">else</span>
184:           <span class="ruby-identifier">a_vals</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">tag</span>, <span class="ruby-identifier">blk</span>]
185:         <span class="ruby-keyword kw">end</span>
186:       <span class="ruby-keyword kw">end</span>
187:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000415" class="method-detail">
        <a name="M000415"></a>

        <div class="method-heading">
          <a href="#M000415" class="method-signature">
          <span class="method-name">validates_format_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the format of an attribute, checking the string representation of
the value against the regular expression provided by the :with option.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:allow_blank - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> blank (default: false)

</li>
<li>:allow_nil - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> nil (default: false)

</li>
<li>:if - A symbol (indicating an instance_method) or proc (which <a
href="Model.html#M000426">is</a> instance_evaled) skipping <a
href="Model.html#M000459">this</a> validation if it returns nil or false.

</li>
<li>:message - The message to use (default: &#8216;<a
href="Model.html#M000426">is</a> invalid&#8217;)

</li>
<li>:tag - The tag to use for <a href="Model.html#M000459">this</a> validation
(default: :format)

</li>
<li>:with - The regular expression to <a href="Model.html#M000411">validate</a>
the value with (required).

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000415-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000415-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 200</span>
200:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates_format_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
201:       <span class="ruby-identifier">opts</span> = {
202:         <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is invalid'</span>,
203:       }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">atts</span>.<span class="ruby-identifier">extract_options!</span>)
204:       
205:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:with</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Regexp</span>)
206:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;A regular expression must be supplied as the :with option of the options hash&quot;</span>
207:       <span class="ruby-keyword kw">end</span>
208:       
209:       <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">:if</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>], <span class="ruby-identifier">:tag=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]<span class="ruby-operator">||</span><span class="ruby-identifier">:format</span>}
210:       <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
211:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_nil</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_blank</span>])
212:         <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:with</span>]
213:       <span class="ruby-keyword kw">end</span>
214:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000416" class="method-detail">
        <a name="M000416"></a>

        <div class="method-heading">
          <a href="#M000416" class="method-signature">
          <span class="method-name">validates_length_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the length of an attribute.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:allow_blank - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> blank (default: false)

</li>
<li>:allow_nil - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> nil (default: false)

</li>
<li>:if - A symbol (indicating an instance_method) or proc (which <a
href="Model.html#M000426">is</a> instance_evaled) skipping <a
href="Model.html#M000459">this</a> validation if it returns nil or false.

</li>
<li>:<a href="Model.html#M000426">is</a> - The exact size required for the
value to be valid (no default)

</li>
<li>:maximum - The maximum size allowed for the value (no default)

</li>
<li>:message - The message to use (no default, overrides :too_long, :too_short,
and :wrong_length options if present)

</li>
<li>:minimum - The minimum size allowed for the value (no default)

</li>
<li>:tag - The tag to use for <a href="Model.html#M000459">this</a> validation
(default: :length)

</li>
<li>:too_long - The message to use use if it the value <a
href="Model.html#M000426">is</a> too long (default: &#8216;<a
href="Model.html#M000426">is</a> too long&#8217;)

</li>
<li>:too_short - The message to use use if it the value <a
href="Model.html#M000426">is</a> too short (default: &#8216;<a
href="Model.html#M000426">is</a> too short&#8217;)

</li>
<li>:with - The array/range that must include the size of the value for it to
be valid (no default)

</li>
<li>:wrong_length - The message to use use if it the value <a
href="Model.html#M000426">is</a> not valid (default: &#8216;<a
href="Model.html#M000426">is</a> the wrong length&#8217;)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000416-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000416-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 233</span>
233:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates_length_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
234:       <span class="ruby-identifier">opts</span> = {
235:         <span class="ruby-identifier">:too_long</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is too long'</span>,
236:         <span class="ruby-identifier">:too_short</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is too short'</span>,
237:         <span class="ruby-identifier">:wrong_length</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is the wrong length'</span>
238:       }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">atts</span>.<span class="ruby-identifier">extract_options!</span>)
239:       
240:       <span class="ruby-identifier">tag</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]
241:         <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]
242:       <span class="ruby-keyword kw">else</span>
243:        ([<span class="ruby-identifier">:length</span>] <span class="ruby-operator">+</span> [<span class="ruby-identifier">:maximum</span>, <span class="ruby-identifier">:minimum</span>, <span class="ruby-identifier">:is</span>, <span class="ruby-identifier">:within</span>].<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">x</span>)}).<span class="ruby-identifier">join</span>(<span class="ruby-value str">'-'</span>).<span class="ruby-identifier">to_sym</span>
244:       <span class="ruby-keyword kw">end</span>
245:       <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">:if</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>], <span class="ruby-identifier">:tag=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">tag</span>}
246:       <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
247:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_nil</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_blank</span>])
248:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:maximum</span>]
249:           <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:too_long</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">m</span>
250:         <span class="ruby-keyword kw">end</span>
251:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:minimum</span>]
252:           <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:too_short</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">m</span>
253:         <span class="ruby-keyword kw">end</span>
254:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">i</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:is</span>]
255:           <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:wrong_length</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">i</span>
256:         <span class="ruby-keyword kw">end</span>
257:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">w</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:within</span>]
258:           <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:wrong_length</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">w</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span>)
259:         <span class="ruby-keyword kw">end</span>
260:       <span class="ruby-keyword kw">end</span>
261:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000417" class="method-detail">
        <a name="M000417"></a>

        <div class="method-heading">
          <a href="#M000417" class="method-signature">
          <span class="method-name">validates_numericality_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates whether an attribute <a href="Model.html#M000426">is</a> a
number.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:allow_blank - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> blank (default: false)

</li>
<li>:allow_nil - Whether to skip the validation if the value <a
href="Model.html#M000426">is</a> nil (default: false)

</li>
<li>:if - A symbol (indicating an instance_method) or proc (which <a
href="Model.html#M000426">is</a> instance_evaled) skipping <a
href="Model.html#M000459">this</a> validation if it returns nil or false.

</li>
<li>:message - The message to use (default: &#8216;<a
href="Model.html#M000426">is</a> not a number&#8217;)

</li>
<li>:tag - The tag to use for <a href="Model.html#M000459">this</a> validation
(default: :numericality)

</li>
<li>:only_integer - Whether only integers are valid values (default: false)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000417-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000417-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 273</span>
273:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates_numericality_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
274:       <span class="ruby-identifier">opts</span> = {
275:         <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is not a number'</span>,
276:       }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">atts</span>.<span class="ruby-identifier">extract_options!</span>)
277:       
278:       <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">:if</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>], <span class="ruby-identifier">:tag=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]<span class="ruby-operator">||</span><span class="ruby-identifier">:numericality</span>}
279:       <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
280:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_nil</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_blank</span>])
281:         <span class="ruby-keyword kw">begin</span>
282:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:only_integer</span>]
283:             <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)
284:           <span class="ruby-keyword kw">else</span>
285:             <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Float</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)
286:           <span class="ruby-keyword kw">end</span>
287:         <span class="ruby-keyword kw">rescue</span>
288:           <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>]
289:         <span class="ruby-keyword kw">end</span>
290:       <span class="ruby-keyword kw">end</span>
291:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000418" class="method-detail">
        <a name="M000418"></a>

        <div class="method-heading">
          <a href="#M000418" class="method-signature">
          <span class="method-name">validates_presence_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the presence of an attribute. Requires the value not be blank,
with false considered present instead of absent.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:if - A symbol (indicating an instance_method) or proc (which <a
href="Model.html#M000426">is</a> instance_evaled) skipping <a
href="Model.html#M000459">this</a> validation if it returns nil or false.

</li>
<li>:message - The message to use (default: &#8216;<a
href="Model.html#M000426">is</a> not present&#8217;)

</li>
<li>:tag - The tag to use for <a href="Model.html#M000459">this</a> validation
(default: :presence)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000418-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000418-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 301</span>
301:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
302:       <span class="ruby-identifier">opts</span> = {
303:         <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is not present'</span>,
304:       }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">atts</span>.<span class="ruby-identifier">extract_options!</span>)
305:       
306:       <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">:if</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>], <span class="ruby-identifier">:tag=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]<span class="ruby-operator">||</span><span class="ruby-identifier">:presence</span>}
307:       <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
308:         <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">false</span>
309:       <span class="ruby-keyword kw">end</span>
310:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000419" class="method-detail">
        <a name="M000419"></a>

        <div class="method-heading">
          <a href="#M000419" class="method-signature">
          <span class="method-name">validates_uniqueness_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates only if the fields in the model (specified by atts) are unique in
the database. Pass an array of fields instead of multiple fields to specify
that the combination of fields must be unique, instead of that <a
href="Model.html#M000439">each</a> field should have a unique value.
</p>
<p>
You should also add a unique index in the database, as <a
href="Model.html#M000459">this</a> suffers from a fairly obvious race
condition.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:allow_nil - Whether to skip the validation if the value(s) is/are nil
(default: false)

</li>
<li>:if - A symbol (indicating an instance_method) or proc (which <a
href="Model.html#M000426">is</a> instance_evaled) skipping <a
href="Model.html#M000459">this</a> validation if it returns nil or false.

</li>
<li>:message - The message to use (default: &#8216;<a
href="Model.html#M000426">is</a> already taken&#8217;)

</li>
<li>:tag - The tag to use for <a href="Model.html#M000459">this</a> validation
(default: :uniqueness)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000419-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000419-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 326</span>
326:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
327:       <span class="ruby-identifier">opts</span> = {
328:         <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is already taken'</span>,
329:       }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">atts</span>.<span class="ruby-identifier">extract_options!</span>)
330: 
331:       <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">:if</span>=<span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>], <span class="ruby-identifier">:tag=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]<span class="ruby-operator">||</span><span class="ruby-identifier">:uniqueness</span>}
332:       <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
333:         <span class="ruby-identifier">error_field</span> = <span class="ruby-identifier">a</span>
334:         <span class="ruby-identifier">a</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">a</span>)
335:         <span class="ruby-identifier">v</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">v</span>)
336:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">any?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_nil</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
337:         <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">a</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">v</span>))
338:         <span class="ruby-identifier">num_dups</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">count</span>
339:         <span class="ruby-identifier">allow</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">num_dups</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
340:           <span class="ruby-comment cmt"># No unique value in the database</span>
341:           <span class="ruby-keyword kw">true</span>
342:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">num_dups</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
343:           <span class="ruby-comment cmt"># Multiple &quot;unique&quot; values in the database!!</span>
344:           <span class="ruby-comment cmt"># Someone didn't add a unique index</span>
345:           <span class="ruby-keyword kw">false</span>
346:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">new?</span>
347:           <span class="ruby-comment cmt"># New record, but unique value already exists in the database</span>
348:           <span class="ruby-keyword kw">false</span>
349:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">o</span>
350:           <span class="ruby-comment cmt"># Unique value exists in database, but for the same record, so the update won't cause a duplicate record</span>
351:           <span class="ruby-keyword kw">true</span>
352:         <span class="ruby-keyword kw">else</span>
353:           <span class="ruby-keyword kw">false</span>
354:         <span class="ruby-keyword kw">end</span>
355:         <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-identifier">error_field</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">allow</span>
356:       <span class="ruby-keyword kw">end</span>
357:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000420" class="method-detail">
        <a name="M000420"></a>

        <div class="method-heading">
          <a href="#M000420" class="method-signature">
          <span class="method-name">validations</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Model.html#M000420">validations</a> <a
href="Model.html#M000441">hash</a> for the class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000420-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000420-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 360</span>
360:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">validations</span>
361:       <span class="ruby-ivar">@validations</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span>, <span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = []}
362:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000433" class="method-detail">
        <a name="M000433"></a>

        <div class="method-heading">
          <a href="#M000433" class="method-signature">
          <span class="method-name">==</span><span class="method-args">(obj)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Compares model instances by values.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000433-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000433-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 59</span>
59:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">obj</span>)
60:       (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">model</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">values</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@values</span>)
61:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000434" class="method-detail">
        <a name="M000434"></a>

        <div class="method-heading">
          <a href="#M000434" class="method-signature">
          <span class="method-name">===</span><span class="method-args">(obj)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
If <a href="Model.html#M000446">pk</a> <a href="Model.html#M000426">is</a>
not nil, true only if the objects have the same class and <a
href="Model.html#M000446">pk</a>. If <a href="Model.html#M000446">pk</a> <a
href="Model.html#M000426">is</a> nil, false.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000434-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000434-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 66</span>
66:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">===</span>(<span class="ruby-identifier">obj</span>)
67:       <span class="ruby-identifier">pk</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">false</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">model</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">pk</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">pk</span>)
68:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000431" class="method-detail">
        <a name="M000431"></a>

        <div class="method-heading">
          <a href="#M000431" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns value of the column&#8216;s attribute.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000431-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000431-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 41</span>
41:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">column</span>)
42:       <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">column</span>]
43:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000432" class="method-detail">
        <a name="M000432"></a>

        <div class="method-heading">
          <a href="#M000432" class="method-signature">
          <span class="method-name">[]=</span><span class="method-args">(column, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets value of the column&#8216;s attribute and marks the column as changed.
If the column already has the same value, <a
href="Model.html#M000459">this</a> <a href="Model.html#M000426">is</a> a
no-op.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000432-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000432-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 47</span>
47:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">value</span>)
48:       <span class="ruby-comment cmt"># If it is new, it doesn't have a value yet, so we should</span>
49:       <span class="ruby-comment cmt"># definitely set the new value.</span>
50:       <span class="ruby-comment cmt"># If the column isn't in @values, we can't assume it is</span>
51:       <span class="ruby-comment cmt"># NULL in the database, so assume it has changed.</span>
52:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@values</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">column</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">column</span>]
53:         <span class="ruby-identifier">changed_columns</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">column</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">column</span>)
54:         <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">column</span>] = <span class="ruby-identifier">typecast_value</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">value</span>)
55:       <span class="ruby-keyword kw">end</span>
56:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000435" class="method-detail">
        <a name="M000435"></a>

        <div class="method-heading">
          <a href="#M000435" class="method-signature">
          <span class="method-name">associations</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The current cached <a href="Model.html#M000435">associations</a>. A <a
href="Model.html#M000441">hash</a> with the <a
href="Model.html#M000444">keys</a> being the association name symbols and
the values being the associated object or nil (many_to_one), or the array
of associated objects (*_to_many).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000435-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000435-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 79</span>
79:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">associations</span>
80:       <span class="ruby-ivar">@associations</span> <span class="ruby-operator">||=</span> {}
81:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000429" class="method-detail">
        <a name="M000429"></a>

        <div class="method-heading">
          <a href="#M000429" class="method-signature">
          <span class="method-name">cache_key</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return a key unique to the underlying record for caching, based on the
primary key value(s) for the object. If the model does not have a primary
key, raise an <a href="Error.html">Error</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000429-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000429-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/caching.rb, line 64</span>
64:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cache_key</span>
65:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;No primary key is associated with this model&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">key</span> = <span class="ruby-identifier">primary_key</span>
66:       <span class="ruby-identifier">pk</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">key</span>
67:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
68:         <span class="ruby-identifier">key</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">k</span>]}
69:       <span class="ruby-keyword kw">else</span>
70:         <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-value str">'no primary key for this record'</span>)
71:       <span class="ruby-keyword kw">end</span>
72:       <span class="ruby-identifier">model</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:cache_key</span>, <span class="ruby-identifier">pk</span>)
73:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000436" class="method-detail">
        <a name="M000436"></a>

        <div class="method-heading">
          <a href="#M000436" class="method-signature">
          <span class="method-name">changed_columns</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The <a href="Model.html#M000377">columns</a> that have been updated. This
isn&#8216;t completely accurate, see <a href="Model.html">Model</a>#[]=.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000436-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000436-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 85</span>
85:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">changed_columns</span>
86:       <span class="ruby-ivar">@changed_columns</span> <span class="ruby-operator">||=</span> []
87:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000437" class="method-detail">
        <a name="M000437"></a>

        <div class="method-heading">
          <a href="#M000437" class="method-signature">
          <span class="method-name">delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deletes and returns self. Does not run <a
href="Model.html#M000438">destroy</a> hooks. Look into using <a
href="Model.html#M000438">destroy</a> instead.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000437-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000437-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 91</span>
91:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete</span>
92:       <span class="ruby-identifier">before_delete</span>
93:       <span class="ruby-identifier">this</span>.<span class="ruby-identifier">delete</span>
94:       <span class="ruby-keyword kw">self</span>
95:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000438" class="method-detail">
        <a name="M000438"></a>

        <div class="method-heading">
          <a href="#M000438" class="method-signature">
          <span class="method-name">destroy</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Like <a href="Model.html#M000437">delete</a> but runs hooks before and
after <a href="Model.html#M000437">delete</a>. If before_destroy returns
false, returns false without deleting the object the the database.
Otherwise, deletes the item from the database and returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000438-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000438-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 101</span>
101:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy</span>
102:       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword kw">do</span>
103:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">save_failure</span>(<span class="ruby-identifier">:destroy</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">before_destroy</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
104:         <span class="ruby-identifier">delete</span>
105:         <span class="ruby-identifier">after_destroy</span>
106:       <span class="ruby-keyword kw">end</span>
107:       <span class="ruby-keyword kw">self</span>
108:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000439" class="method-detail">
        <a name="M000439"></a>

        <div class="method-heading">
          <a href="#M000439" class="method-signature">
          <span class="method-name">each</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Enumerates through all attributes.
</p>
<p>
Example:
</p>
<pre>
  Ticket.find(7).each { |k, v| puts &quot;#{k} =&gt; #{v}&quot; }
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000439-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000439-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 114</span>
114:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
115:       <span class="ruby-ivar">@values</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
116:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000421" class="method-detail">
        <a name="M000421"></a>

        <div class="method-heading">
          <a href="#M000421" class="method-signature">
          <span class="method-name">errors</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the validation <a href="Model.html#M000421">errors</a> associated
with the object.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000421-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000421-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 380</span>
380:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">errors</span>
381:       <span class="ruby-ivar">@errors</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Validation</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span>.<span class="ruby-identifier">new</span>
382:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000440" class="method-detail">
        <a name="M000440"></a>

        <div class="method-heading">
          <a href="#M000440" class="method-signature">
          <span class="method-name">exists?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true when current instance exists, false otherwise.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000440-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000440-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 119</span>
119:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exists?</span>
120:       <span class="ruby-identifier">this</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
121:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000441" class="method-detail">
        <a name="M000441"></a>

        <div class="method-heading">
          <a href="#M000441" class="method-signature">
          <span class="method-name">hash</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Unique for objects with the same class and <a
href="Model.html#M000446">pk</a> (if <a href="Model.html#M000446">pk</a> <a
href="Model.html#M000426">is</a> not nil), or the same class and values (if
<a href="Model.html#M000446">pk</a> <a href="Model.html#M000426">is</a>
nil).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000441-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000441-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 125</span>
125:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">hash</span>
126:       [<span class="ruby-identifier">model</span>, <span class="ruby-identifier">pk</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-ivar">@values</span>.<span class="ruby-identifier">sort_by</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>} <span class="ruby-operator">:</span> <span class="ruby-identifier">pk</span>].<span class="ruby-identifier">hash</span>
127:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000442" class="method-detail">
        <a name="M000442"></a>

        <div class="method-heading">
          <a href="#M000442" class="method-signature">
          <span class="method-name">id</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns value for the :<a href="Model.html#M000442">id</a> attribute, even
if the primary key <a href="Model.html#M000426">is</a> not <a
href="Model.html#M000442">id</a>. To get the primary key value, use <a
href="Model.html#M000446">pk</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000442-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000442-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 131</span>
131:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">id</span>
132:       <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">:id</span>]
133:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000443" class="method-detail">
        <a name="M000443"></a>

        <div class="method-heading">
          <a href="#M000443" class="method-signature">
          <span class="method-name">inspect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a string representation of the model instance including the class
name and values.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000443-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000443-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 137</span>
137:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
138:       <span class="ruby-node">&quot;#&lt;#{model.name} @values=#{@values.inspect}&gt;&quot;</span>
139:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000444" class="method-detail">
        <a name="M000444"></a>

        <div class="method-heading">
          <a href="#M000444" class="method-signature">
          <span class="method-name">keys</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns attribute names as an array of symbols.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000444-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000444-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 142</span>
142:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">keys</span>
143:       <span class="ruby-ivar">@values</span>.<span class="ruby-identifier">keys</span>
144:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000445" class="method-detail">
        <a name="M000445"></a>

        <div class="method-heading">
          <a href="#M000445" class="method-signature">
          <span class="method-name">new?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the current instance represents a <a
href="Model.html#M000430">new</a> record.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000445-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000445-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 147</span>
147:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">new?</span>
148:       <span class="ruby-ivar">@new</span>
149:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000446" class="method-detail">
        <a name="M000446"></a>

        <div class="method-heading">
          <a href="#M000446" class="method-signature">
          <span class="method-name">pk</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the primary key value identifying the model instance. Raises an
error if <a href="Model.html#M000459">this</a> model does not have a
primary key. If the model has a composite primary key, returns an array of
values.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000446-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000446-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 154</span>
154:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pk</span>
155:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;No primary key is associated with this model&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">key</span> = <span class="ruby-identifier">primary_key</span>
156:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">key</span>
157:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
158:         <span class="ruby-identifier">key</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">k</span>]}
159:       <span class="ruby-keyword kw">else</span>
160:         <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">key</span>]
161:       <span class="ruby-keyword kw">end</span>
162:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000447" class="method-detail">
        <a name="M000447"></a>

        <div class="method-heading">
          <a href="#M000447" class="method-signature">
          <span class="method-name">pk_hash</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Model.html#M000441">hash</a> identifying the model
instance. It should be true that:
</p>
<pre>
 Model[model_instance.pk_hash] === model_instance
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000447-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000447-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 167</span>
167:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pk_hash</span>
168:       <span class="ruby-identifier">model</span>.<span class="ruby-identifier">primary_key_hash</span>(<span class="ruby-identifier">pk</span>)
169:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000448" class="method-detail">
        <a name="M000448"></a>

        <div class="method-heading">
          <a href="#M000448" class="method-signature">
          <span class="method-name">refresh</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reloads attributes from database and returns self. Also clears all cached
association information. Raises an <a href="Error.html">Error</a> if the
record no longer exists in the database.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000448-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000448-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 174</span>
174:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">refresh</span>
175:       <span class="ruby-ivar">@values</span> = <span class="ruby-identifier">this</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;Record not found&quot;</span>)
176:       <span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">clear</span>
177:       <span class="ruby-identifier">associations</span>.<span class="ruby-identifier">clear</span>
178:       <span class="ruby-keyword kw">self</span>
179:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000449" class="method-detail">
        <a name="M000449"></a>

        <div class="method-heading">
          <span class="method-name">reload</span><span class="method-args">()</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Model.html#M000448">refresh</a>
</p>
        </div>
      </div>

      <div id="method-M000450" class="method-detail">
        <a name="M000450"></a>

        <div class="method-heading">
          <a href="#M000450" class="method-signature">
          <span class="method-name">save</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates or updates the record, after making sure the record <a
href="Model.html#M000426">is</a> valid. If the record <a
href="Model.html#M000426">is</a> not valid, or before_save, before_create
(if <a href="Model.html#M000445">new?</a>), or before_update (if !<a
href="Model.html#M000445">new?</a>) return false, returns nil unless
raise_on_save_failure <a href="Model.html#M000426">is</a> true (if it <a
href="Model.html#M000426">is</a> true, it raises an error). Otherwise,
returns self. You can provide an optional list of <a
href="Model.html#M000377">columns</a> to <a
href="Model.html#M000460">update</a>, in which case it only updates those
<a href="Model.html#M000377">columns</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000450-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000450-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 189</span>
189:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
190:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">save_failure</span>(<span class="ruby-identifier">:save</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">valid?</span>
191:       <span class="ruby-identifier">save!</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
192:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000451" class="method-detail">
        <a name="M000451"></a>

        <div class="method-heading">
          <a href="#M000451" class="method-signature">
          <span class="method-name">save!</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates or updates the record, without attempting to <a
href="Model.html#M000411">validate</a> it first. You can provide an
optional list of <a href="Model.html#M000377">columns</a> to <a
href="Model.html#M000460">update</a>, in which case it only updates those
<a href="Model.html#M000377">columns</a>. If before_save, before_create (if
<a href="Model.html#M000445">new?</a>), or before_update (if !<a
href="Model.html#M000445">new?</a>) return false, returns nil unless
raise_on_save_failure <a href="Model.html#M000426">is</a> true (if it <a
href="Model.html#M000426">is</a> true, it raises an error). Otherwise,
returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000451-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000451-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 200</span>
200:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save!</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
201:       <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">extract_options!</span>
202:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">save_failure</span>(<span class="ruby-identifier">:save</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">before_save</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
203:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@new</span>
204:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">save_failure</span>(<span class="ruby-identifier">:create</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">before_create</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
205:         <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">dataset</span>
206:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:insert_select</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">h</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert_select</span>(<span class="ruby-ivar">@values</span>)
207:           <span class="ruby-ivar">@values</span> = <span class="ruby-identifier">h</span>
208:           <span class="ruby-ivar">@this</span> = <span class="ruby-keyword kw">nil</span>
209:         <span class="ruby-keyword kw">else</span>
210:           <span class="ruby-identifier">iid</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-ivar">@values</span>)
211:           <span class="ruby-comment cmt"># if we have a regular primary key and it's not set in @values,</span>
212:           <span class="ruby-comment cmt"># we assume it's the last inserted id</span>
213:           <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">pk</span> = <span class="ruby-identifier">primary_key</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">pk</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@values</span>[<span class="ruby-identifier">pk</span>]
214:             <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">pk</span>] = <span class="ruby-identifier">iid</span>
215:           <span class="ruby-keyword kw">end</span>
216:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pk</span>
217:             <span class="ruby-ivar">@this</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-comment cmt"># remove memoized this dataset</span>
218:             <span class="ruby-identifier">refresh</span>
219:           <span class="ruby-keyword kw">end</span>
220:         <span class="ruby-keyword kw">end</span>
221:         <span class="ruby-ivar">@new</span> = <span class="ruby-keyword kw">false</span>
222:         <span class="ruby-identifier">after_create</span>
223:       <span class="ruby-keyword kw">else</span>
224:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">save_failure</span>(<span class="ruby-identifier">:update</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">before_update</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
225:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">empty?</span>
226:           <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:changed</span>] <span class="ruby-operator">?</span> <span class="ruby-ivar">@values</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">k</span>)} <span class="ruby-operator">:</span> <span class="ruby-ivar">@values</span>
227:           <span class="ruby-identifier">this</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">vals</span>)
228:           <span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">clear</span>
229:         <span class="ruby-keyword kw">else</span> <span class="ruby-comment cmt"># update only the specified columns</span>
230:           <span class="ruby-identifier">this</span>.<span class="ruby-identifier">update</span>(<span class="ruby-ivar">@values</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">columns</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">k</span>)})
231:           <span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">reject!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">c</span>)}
232:         <span class="ruby-keyword kw">end</span>
233:         <span class="ruby-identifier">after_update</span>
234:       <span class="ruby-keyword kw">end</span>
235:       <span class="ruby-identifier">after_save</span>
236:       <span class="ruby-keyword kw">self</span>
237:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000452" class="method-detail">
        <a name="M000452"></a>

        <div class="method-heading">
          <a href="#M000452" class="method-signature">
          <span class="method-name">save_changes</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Saves only changed <a href="Model.html#M000377">columns</a> or does nothing
if no <a href="Model.html#M000377">columns</a> are marked as chanaged. If
no <a href="Model.html#M000377">columns</a> have been changed, returns nil.
If unable to <a href="Model.html#M000450">save</a>, returns false unless
raise_on_save_failure <a href="Model.html#M000426">is</a> true.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000452-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000452-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 242</span>
242:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save_changes</span>
243:       <span class="ruby-identifier">save</span>(<span class="ruby-identifier">:changed=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span>) <span class="ruby-operator">||</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">empty?</span>
244:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000453" class="method-detail">
        <a name="M000453"></a>

        <div class="method-heading">
          <a href="#M000453" class="method-signature">
          <span class="method-name">set</span><span class="method-args">(hash)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Updates the instance with the supplied values with support for virtual
attributes, raising an exception if a value <a
href="Model.html#M000426">is</a> used that doesn&#8216;t have a setter
method (or ignoring it if strict_param_setting = false). Does not <a
href="Model.html#M000450">save</a> the record.
</p>
<p>
If no <a href="Model.html#M000377">columns</a> have been <a
href="Model.html#M000453">set</a> for <a href="Model.html#M000459">this</a>
model (very unlikely), assume symbol <a href="Model.html#M000444">keys</a>
are valid column names, and assign the column value based on that.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000453-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000453-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 253</span>
253:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set</span>(<span class="ruby-identifier">hash</span>)
254:       <span class="ruby-identifier">set_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>)
255:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000455" class="method-detail">
        <a name="M000455"></a>

        <div class="method-heading">
          <a href="#M000455" class="method-signature">
          <span class="method-name">set_all</span><span class="method-args">(hash)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set all values using the entries in the <a
href="Model.html#M000441">hash</a>, ignoring any setting of allowed_columns
or restricted <a href="Model.html#M000377">columns</a> in the model.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000455-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000455-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 260</span>
260:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_all</span>(<span class="ruby-identifier">hash</span>)
261:       <span class="ruby-identifier">set_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-keyword kw">false</span>, <span class="ruby-keyword kw">false</span>)
262:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000456" class="method-detail">
        <a name="M000456"></a>

        <div class="method-heading">
          <a href="#M000456" class="method-signature">
          <span class="method-name">set_except</span><span class="method-args">(hash, *except)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set all values using the entries in the <a
href="Model.html#M000441">hash</a>, except for the <a
href="Model.html#M000444">keys</a> given in except.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000456-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000456-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 266</span>
266:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_except</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">except</span>)
267:       <span class="ruby-identifier">set_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">except</span>.<span class="ruby-identifier">flatten</span>)
268:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000457" class="method-detail">
        <a name="M000457"></a>

        <div class="method-heading">
          <a href="#M000457" class="method-signature">
          <span class="method-name">set_only</span><span class="method-args">(hash, *only)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the values using the entries in the <a
href="Model.html#M000441">hash</a>, only if the key <a
href="Model.html#M000426">is</a> included in only.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000457-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000457-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 272</span>
272:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_only</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">only</span>)
273:       <span class="ruby-identifier">set_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">only</span>.<span class="ruby-identifier">flatten</span>, <span class="ruby-keyword kw">false</span>)
274:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000458" class="method-detail">
        <a name="M000458"></a>

        <div class="method-heading">
          <a href="#M000458" class="method-signature">
          <span class="method-name">set_values</span><span class="method-args">(values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the value attributes without saving the record. Returns the values
changed. Raises an error if the <a href="Model.html#M000444">keys</a> are
not symbols or strings or a string key was passed that was not a valid
column. This <a href="Model.html#M000426">is</a> a low level method that
does not respect virtual attributes. It should probably be avoided. Look
into using <a href="Model.html#M000453">set</a> instead.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000458-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000458-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 281</span>
281:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_values</span>(<span class="ruby-identifier">values</span>)
282:       <span class="ruby-identifier">s</span> = <span class="ruby-identifier">str_columns</span>
283:       <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">kv</span><span class="ruby-operator">|</span> 
284:         <span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> = <span class="ruby-identifier">kv</span>
285:         <span class="ruby-identifier">k</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">k</span>
286:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
287:           <span class="ruby-identifier">k</span>
288:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
289:           <span class="ruby-comment cmt"># Prevent denial of service via memory exhaustion by only </span>
290:           <span class="ruby-comment cmt"># calling to_sym if the symbol already exists.</span>
291:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;all string keys must be a valid columns&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">k</span>)
292:           <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_sym</span>
293:         <span class="ruby-keyword kw">else</span>
294:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;Only symbols and strings allows as keys&quot;</span>)
295:         <span class="ruby-keyword kw">end</span>
296:         <span class="ruby-identifier">m</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>
297:         <span class="ruby-identifier">m</span>
298:       <span class="ruby-keyword kw">end</span>
299:       <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>}
300:       <span class="ruby-identifier">vals</span>
301:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000454" class="method-detail">
        <a name="M000454"></a>

        <div class="method-heading">
          <span class="method-name">set_with_params</span><span class="method-args">(hash)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Model.html#M000453">set</a>
</p>
        </div>
      </div>

      <div id="method-M000459" class="method-detail">
        <a name="M000459"></a>

        <div class="method-heading">
          <a href="#M000459" class="method-signature">
          <span class="method-name">this</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns (naked) <a href="Model.html#M000379">dataset</a> that should return
only <a href="Model.html#M000459">this</a> instance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000459-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000459-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 304</span>
304:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">this</span>
305:       <span class="ruby-ivar">@this</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">pk_hash</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">naked</span>
306:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000460" class="method-detail">
        <a name="M000460"></a>

        <div class="method-heading">
          <a href="#M000460" class="method-signature">
          <span class="method-name">update</span><span class="method-args">(hash)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Runs <a href="Model.html#M000453">set</a> with the passed <a
href="Model.html#M000441">hash</a> and runs <a
href="Model.html#M000452">save_changes</a> (which runs any callback
methods).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000460-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000460-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 309</span>
309:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">hash</span>)
310:       <span class="ruby-identifier">update_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>)
311:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000462" class="method-detail">
        <a name="M000462"></a>

        <div class="method-heading">
          <a href="#M000462" class="method-signature">
          <span class="method-name">update_all</span><span class="method-args">(hash)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Update all values using the entries in the <a
href="Model.html#M000441">hash</a>, ignoring any setting of allowed_columns
or restricted <a href="Model.html#M000377">columns</a> in the model.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000462-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000462-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 316</span>
316:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_all</span>(<span class="ruby-identifier">hash</span>)
317:       <span class="ruby-identifier">update_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-keyword kw">false</span>, <span class="ruby-keyword kw">false</span>)
318:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000463" class="method-detail">
        <a name="M000463"></a>

        <div class="method-heading">
          <a href="#M000463" class="method-signature">
          <span class="method-name">update_except</span><span class="method-args">(hash, *except)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Update all values using the entries in the <a
href="Model.html#M000441">hash</a>, except for the <a
href="Model.html#M000444">keys</a> given in except.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000463-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000463-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 322</span>
322:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_except</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">except</span>)
323:       <span class="ruby-identifier">update_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">except</span>.<span class="ruby-identifier">flatten</span>)
324:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000464" class="method-detail">
        <a name="M000464"></a>

        <div class="method-heading">
          <a href="#M000464" class="method-signature">
          <span class="method-name">update_only</span><span class="method-args">(hash, *only)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Update the values using the entries in the <a
href="Model.html#M000441">hash</a>, only if the key <a
href="Model.html#M000426">is</a> included in only.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000464-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000464-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 328</span>
328:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_only</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">only</span>)
329:       <span class="ruby-identifier">update_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">only</span>.<span class="ruby-identifier">flatten</span>, <span class="ruby-keyword kw">false</span>)
330:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000465" class="method-detail">
        <a name="M000465"></a>

        <div class="method-heading">
          <a href="#M000465" class="method-signature">
          <span class="method-name">update_values</span><span class="method-args">(values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the values attributes with <a href="Model.html#M000458">set_values</a>
and then updates the record in the database using those values. This <a
href="Model.html#M000426">is</a> a low level method that does not run the
usual <a href="Model.html#M000450">save</a> callbacks. It should probably
be avoided. Look into using <a
href="Model.html#M000461">update_with_params</a> instead.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000465-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000465-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/record.rb, line 336</span>
336:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_values</span>(<span class="ruby-identifier">values</span>)
337:       <span class="ruby-identifier">before_update_values</span>
338:       <span class="ruby-identifier">this</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">set_values</span>(<span class="ruby-identifier">values</span>))
339:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000461" class="method-detail">
        <a name="M000461"></a>

        <div class="method-heading">
          <span class="method-name">update_with_params</span><span class="method-args">(hash)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Model.html#M000460">update</a>
</p>
        </div>
      </div>

      <div id="method-M000423" class="method-detail">
        <a name="M000423"></a>

        <div class="method-heading">
          <a href="#M000423" class="method-signature">
          <span class="method-name">valid?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the object and returns true if no <a
href="Model.html#M000421">errors</a> are reported.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000423-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000423-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 394</span>
394:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">valid?</span>
395:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">validate</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
396:       <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">empty?</span>
397:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000422" class="method-detail">
        <a name="M000422"></a>

        <div class="method-heading">
          <a href="#M000422" class="method-signature">
          <span class="method-name">validate</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the object.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000422-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000422-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_model/validations.rb, line 385</span>
385:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate</span>
386:       <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">clear</span>
387:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">before_validation</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
388:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-keyword kw">self</span>)
389:       <span class="ruby-identifier">after_validation</span>
390:       <span class="ruby-keyword kw">nil</span>
391:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>