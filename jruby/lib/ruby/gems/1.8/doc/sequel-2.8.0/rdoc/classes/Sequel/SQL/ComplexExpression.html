<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Sequel::SQL::ComplexExpression</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Sequel::SQL::ComplexExpression</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/sequel_core/sql_rb.html">
                lib/sequel_core/sql.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="Expression.html">
                Expression
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Represents a complex <a href="../SQL.html">SQL</a> expression, with a given
operator and one or more attributes (which may also be ComplexExpressions,
forming a tree). This class is the backbone of the blockless filter support
in <a href="../../Sequel.html">Sequel</a>.
</p>
<p>
This is an abstract class that is not that useful by itself. The subclasses
<a href="BooleanExpression.html">BooleanExpression</a>, <a
href="NumericExpression.html">NumericExpression</a>, and <a
href="StringExpression.html">StringExpression</a> define the behavior of
the DSL via operators.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000339">==</a>&nbsp;&nbsp;
      <a href="#M000338">eql?</a>&nbsp;&nbsp;
      <a href="#M000336">new</a>&nbsp;&nbsp;
      <a href="#M000337">to_s</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="SpecificExpressionMethods.html">SpecificExpressionMethods</a></span>
      </div>
    </div>

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">OPERTATOR_INVERSIONS</td>
          <td>=</td>
          <td class="context-item-value">{:AND =&gt; :OR, :OR =&gt; :AND, :&lt; =&gt; :&gt;=, :&gt; =&gt; :&lt;=,         :&lt;= =&gt; :&gt;, :&gt;= =&gt; :&lt;, :'=' =&gt; :'!=' , :'!=' =&gt; :'=', :LIKE =&gt; :'NOT LIKE',         :'NOT LIKE' =&gt; :LIKE, :~ =&gt; :'!~', :'!~' =&gt; :~, :IN =&gt; :'NOT IN',         :'NOT IN' =&gt; :IN, :IS =&gt; :'IS NOT', :'IS NOT' =&gt; :IS, :'~*' =&gt; :'!~*',         :'!~*' =&gt; :'~*', :NOT =&gt; :NOOP, :NOOP =&gt; :NOT, :ILIKE =&gt; :'NOT ILIKE',         :'NOT ILIKE'=&gt;:ILIKE}</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
A hash of the opposite for each operator symbol, used for inverting
objects.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MATHEMATICAL_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">[:+, :-, :/, :*]</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Mathematical Operators used in <a
href="NumericMethods.html">NumericMethods</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">BITWISE_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">[:&amp;, :|, :^, :&lt;&lt;, :&gt;&gt;]</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Mathematical Operators used in <a
href="NumericMethods.html">NumericMethods</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">INEQUALITY_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">[:&lt;, :&gt;, :&lt;=, :&gt;=]</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Inequality Operators used in <a
href="InequalityMethods.html">InequalityMethods</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">BOOLEAN_OPERATOR_METHODS</td>
          <td>=</td>
          <td class="context-item-value">{:&amp; =&gt; :AND, :| =&gt;:OR}</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="../../Hash.html">Hash</a> of ruby operator symbols to <a
href="../SQL.html">SQL</a> operators, used in <a
href="BooleanMethods.html">BooleanMethods</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TWO_ARITY_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">[:'=', :'!=', :IS, :'IS NOT', :LIKE, :'NOT LIKE', \         :~, :'!~', :'~*', :'!~*', :IN, :'NOT IN', :ILIKE, :'NOT ILIKE'] + \         INEQUALITY_OPERATORS + BITWISE_OPERATORS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Operator symbols that take exactly two arguments

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">N_ARITY_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">[:AND, :OR, :'||'] + MATHEMATICAL_OPERATORS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Operator symbols that take one or more arguments

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ONE_ARITY_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">[:NOT, :NOOP, :'B~']</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Operator symbols that take one argument

</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">args</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
An array of args for this object

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">op</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The operator symbol for this object

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000336" class="method-detail">
        <a name="M000336"></a>

        <div class="method-heading">
          <a href="#M000336" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(op, *args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the operator symbol and arguments for this object to the ones given.
Convert all args that are hashes or arrays with all two pairs to
ComplexExpressions. Raise an error if the operator doesn&#8216;t allow
boolean input and a boolean argument is given. Raise an error if the wrong
number of arguments for a given operator is used.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000336-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000336-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/sql.rb, line 71</span>
71:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">op</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
72:         <span class="ruby-identifier">args</span>.<span class="ruby-identifier">collect!</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span>
73:           <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">a</span>
74:           <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
75:             <span class="ruby-identifier">a</span>.<span class="ruby-identifier">sql_expr</span>
76:           <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
77:             <span class="ruby-identifier">a</span>.<span class="ruby-identifier">all_two_pairs?</span> <span class="ruby-value">? </span><span class="ruby-identifier">a</span>.<span class="ruby-identifier">sql_expr</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">a</span>
78:           <span class="ruby-keyword kw">else</span>
79:             <span class="ruby-identifier">a</span>
80:           <span class="ruby-keyword kw">end</span>
81:         <span class="ruby-keyword kw">end</span>
82:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">op</span>
83:         <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">N_ARITY_OPERATORS</span>
84:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;The #{op} operator requires at least 1 argument&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">1</span>
85:         <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">TWO_ARITY_OPERATORS</span>
86:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;The #{op} operator requires precisely 2 arguments&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
87:         <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">ONE_ARITY_OPERATORS</span>
88:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;The #{op} operator requires a single argument&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
89:         <span class="ruby-keyword kw">else</span>
90:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;Invalid operator #{op}&quot;</span>)
91:         <span class="ruby-keyword kw">end</span>
92:         <span class="ruby-ivar">@op</span> = <span class="ruby-identifier">op</span>
93:         <span class="ruby-ivar">@args</span> = <span class="ruby-identifier">args</span>
94:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000339" class="method-detail">
        <a name="M000339"></a>

        <div class="method-heading">
          <span class="method-name">==</span><span class="method-args">( other )</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for eql?
</p>
        </div>
      </div>

      <div id="method-M000338" class="method-detail">
        <a name="M000338"></a>

        <div class="method-heading">
          <a href="#M000338" class="method-signature">
          <span class="method-name">eql?</span><span class="method-args">( other )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the receiver is the same expression as the the
<tt>other</tt> expression.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000338-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000338-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/sql.rb, line 104</span>
104:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eql?</span>( <span class="ruby-identifier">other</span> )
105:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">is_a?</span>( <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span> ) <span class="ruby-operator">&amp;&amp;</span>
106:           <span class="ruby-ivar">@op</span>.<span class="ruby-identifier">eql?</span>( <span class="ruby-identifier">other</span>.<span class="ruby-identifier">op</span> ) <span class="ruby-operator">&amp;&amp;</span>
107:           <span class="ruby-ivar">@args</span>.<span class="ruby-identifier">eql?</span>( <span class="ruby-identifier">other</span>.<span class="ruby-identifier">args</span> )
108:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000337" class="method-detail">
        <a name="M000337"></a>

        <div class="method-heading">
          <a href="#M000337" class="method-signature">
          <span class="method-name">to_s</span><span class="method-args">(ds)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delegate the creation of the resulting <a href="../SQL.html">SQL</a> to the
given dataset, since it may be database dependent.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000337-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000337-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/sql.rb, line 98</span>
 98:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">ds</span>)
 99:         <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">complex_expression_sql</span>(<span class="ruby-ivar">@op</span>, <span class="ruby-ivar">@args</span>)
100:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>