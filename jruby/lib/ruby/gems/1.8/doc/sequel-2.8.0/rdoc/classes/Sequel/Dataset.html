<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Sequel::Dataset</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Sequel::Dataset</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/sequel_core/object_graph_rb.html">
                lib/sequel_core/object_graph.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/unsupported_rb.html">
                lib/sequel_core/dataset/unsupported.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/stored_procedures_rb.html">
                lib/sequel_core/dataset/stored_procedures.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/query_rb.html">
                lib/sequel_core/dataset/query.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/callback_rb.html">
                lib/sequel_core/dataset/callback.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/convenience_rb.html">
                lib/sequel_core/dataset/convenience.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/pagination_rb.html">
                lib/sequel_core/dataset/pagination.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/schema_rb.html">
                lib/sequel_core/dataset/schema.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/sql_rb.html">
                lib/sequel_core/dataset/sql.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset/prepared_statements_rb.html">
                lib/sequel_core/dataset/prepared_statements.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/adapters/jdbc_rb.html">
                lib/sequel_core/adapters/jdbc.rb
                </a>
        <br />
                <a href="../../files/lib/sequel_core/dataset_rb.html">
                lib/sequel_core/dataset.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="../Object.html">
                Object
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
A <a href="Dataset.html">Dataset</a> represents a view of a the data in a
database, constrained by specific parameters such <a
href="Dataset.html#M000641">as</a> filtering conditions, <a
href="Dataset.html#M000603">order</a>, etc. Datasets can be used to create,
retrieve, <a href="Dataset.html#M000665">update</a> <a
href="Dataset.html#M000568">and</a> <a
href="Dataset.html#M000647">delete</a> records.
</p>
<p>
Query results are always retrieved on demand, so a dataset can be kept
around <a href="Dataset.html#M000568">and</a> reused indefinitely:
</p>
<pre>
  my_posts = DB[:posts].filter(:author =&gt; 'david') # no records are retrieved
  p my_posts.all # records are now retrieved
  ...
  p my_posts.all # records are retrieved again
</pre>
<p>
In <a href="Dataset.html#M000603">order</a> to provide this functionality,
dataset methods such <a href="Dataset.html#M000641">as</a> <a
href="Dataset.html#M000581">where</a>, <a
href="Dataset.html#M000616">select</a>, <a
href="Dataset.html#M000603">order</a>, etc. return modified copies of the
dataset, so you can use different datasets to access data:
</p>
<pre>
  posts = DB[:posts]
  davids_posts = posts.filter(:author =&gt; 'david')
  old_posts = posts.filter('stamp &lt; ?', Date.today - 7)
</pre>
<p>
Datasets are <a href="../Enumerable.html">Enumerable</a> objects, so they
can be manipulated using any of the <a
href="../Enumerable.html">Enumerable</a> methods, such <a
href="Dataset.html#M000641">as</a> <a href="Dataset.html#M000551">map</a>,
inject, etc.
</p>
<h3>Methods added via metaprogramming</h3>
<p>
Some methods are added via metaprogramming:
</p>
<ul>
<li>! methods - These methods are the same <a
href="Dataset.html#M000641">as</a> their non-! counterparts, but they
modify the receiver instead of returning a modified copy of the dataset.

</li>
<li>inner_join, full_outer_join, right_outer_join, left_outer_join - This
methods are shortcuts to <a href="Dataset.html#M000598">join_table</a> with
the join type already specified.

</li>
</ul>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000640">&lt;&lt;</a>&nbsp;&nbsp;
      <a href="#M000542">[]</a>&nbsp;&nbsp;
      <a href="#M000543">[]=</a>&nbsp;&nbsp;
      <a href="#M000540">add_graph_aliases</a>&nbsp;&nbsp;
      <a href="#M000569">aliased_expression_sql</a>&nbsp;&nbsp;
      <a href="#M000642">all</a>&nbsp;&nbsp;
      <a href="#M000568">and</a>&nbsp;&nbsp;
      <a href="#M000570">array_sql</a>&nbsp;&nbsp;
      <a href="#M000641">as</a>&nbsp;&nbsp;
      <a href="#M000544">avg</a>&nbsp;&nbsp;
      <a href="#M000630">call</a>&nbsp;&nbsp;
      <a href="#M000571">case_expression_sql</a>&nbsp;&nbsp;
      <a href="#M000643">clone</a>&nbsp;&nbsp;
      <a href="#M000572">column_all_sql</a>&nbsp;&nbsp;
      <a href="#M000644">columns</a>&nbsp;&nbsp;
      <a href="#M000645">columns!</a>&nbsp;&nbsp;
      <a href="#M000573">complex_expression_sql</a>&nbsp;&nbsp;
      <a href="#M000574">count</a>&nbsp;&nbsp;
      <a href="#M000567">create_or_replace_view</a>&nbsp;&nbsp;
      <a href="#M000566">create_view</a>&nbsp;&nbsp;
      <a href="#M000637">dataset_classes</a>&nbsp;&nbsp;
      <a href="#M000638">def_mutation_method</a>&nbsp;&nbsp;
      <a href="#M000646">def_mutation_method</a>&nbsp;&nbsp;
      <a href="#M000647">delete</a>&nbsp;&nbsp;
      <a href="#M000576">delete_sql</a>&nbsp;&nbsp;
      <a href="#M000626">distinct</a>&nbsp;&nbsp;
      <a href="#M000648">each</a>&nbsp;&nbsp;
      <a href="#M000565">each_page</a>&nbsp;&nbsp;
      <a href="#M000545">empty?</a>&nbsp;&nbsp;
      <a href="#M000577">except</a>&nbsp;&nbsp;
      <a href="#M000578">exclude</a>&nbsp;&nbsp;
      <a href="#M000579">exists</a>&nbsp;&nbsp;
      <a href="#M000649">fetch_rows</a>&nbsp;&nbsp;
      <a href="#M000633">fetch_rows</a>&nbsp;&nbsp;
      <a href="#M000580">filter</a>&nbsp;&nbsp;
      <a href="#M000546">first</a>&nbsp;&nbsp;
      <a href="#M000582">first_source</a>&nbsp;&nbsp;
      <a href="#M000583">from</a>&nbsp;&nbsp;
      <a href="#M000584">from_self</a>&nbsp;&nbsp;
      <a href="#M000585">function_sql</a>&nbsp;&nbsp;
      <a href="#M000547">get</a>&nbsp;&nbsp;
      <a href="#M000538">graph</a>&nbsp;&nbsp;
      <a href="#M000586">grep</a>&nbsp;&nbsp;
      <a href="#M000587">group</a>&nbsp;&nbsp;
      <a href="#M000548">group_and_count</a>&nbsp;&nbsp;
      <a href="#M000588">group_by</a>&nbsp;&nbsp;
      <a href="#M000589">having</a>&nbsp;&nbsp;
      <a href="#M000555">import</a>&nbsp;&nbsp;
      <a href="#M000639">inherited</a>&nbsp;&nbsp;
      <a href="#M000650">insert</a>&nbsp;&nbsp;
      <a href="#M000590">insert_multiple</a>&nbsp;&nbsp;
      <a href="#M000591">insert_sql</a>&nbsp;&nbsp;
      <a href="#M000651">inspect</a>&nbsp;&nbsp;
      <a href="#M000592">intersect</a>&nbsp;&nbsp;
      <a href="#M000549">interval</a>&nbsp;&nbsp;
      <a href="#M000593">invert</a>&nbsp;&nbsp;
      <a href="#M000594">irregular_function_sql</a>&nbsp;&nbsp;
      <a href="#M000595">join_clause_sql</a>&nbsp;&nbsp;
      <a href="#M000596">join_on_clause_sql</a>&nbsp;&nbsp;
      <a href="#M000598">join_table</a>&nbsp;&nbsp;
      <a href="#M000597">join_using_clause_sql</a>&nbsp;&nbsp;
      <a href="#M000550">last</a>&nbsp;&nbsp;
      <a href="#M000599">limit</a>&nbsp;&nbsp;
      <a href="#M000634">literal</a>&nbsp;&nbsp;
      <a href="#M000600">literal</a>&nbsp;&nbsp;
      <a href="#M000551">map</a>&nbsp;&nbsp;
      <a href="#M000552">max</a>&nbsp;&nbsp;
      <a href="#M000553">min</a>&nbsp;&nbsp;
      <a href="#M000652">model_classes</a>&nbsp;&nbsp;
      <a href="#M000554">multi_insert</a>&nbsp;&nbsp;
      <a href="#M000601">multi_insert_sql</a>&nbsp;&nbsp;
      <a href="#M000653">naked</a>&nbsp;&nbsp;
      <a href="#M000636">new</a>&nbsp;&nbsp;
      <a href="#M000666">options_overlap</a>&nbsp;&nbsp;
      <a href="#M000602">or</a>&nbsp;&nbsp;
      <a href="#M000603">order</a>&nbsp;&nbsp;
      <a href="#M000604">order_by</a>&nbsp;&nbsp;
      <a href="#M000605">order_more</a>&nbsp;&nbsp;
      <a href="#M000606">ordered_expression_sql</a>&nbsp;&nbsp;
      <a href="#M000564">paginate</a>&nbsp;&nbsp;
      <a href="#M000607">placeholder_literal_string_sql</a>&nbsp;&nbsp;
      <a href="#M000654">polymorphic_key</a>&nbsp;&nbsp;
      <a href="#M000631">prepare</a>&nbsp;&nbsp;
      <a href="#M000635">prepare</a>&nbsp;&nbsp;
      <a href="#M000556">print</a>&nbsp;&nbsp;
      <a href="#M000608">qualified_identifier_sql</a>&nbsp;&nbsp;
      <a href="#M000541">query</a>&nbsp;&nbsp;
      <a href="#M000610">quote_column_ref</a>&nbsp;&nbsp;
      <a href="#M000609">quote_identifier</a>&nbsp;&nbsp;
      <a href="#M000655">quote_identifiers?</a>&nbsp;&nbsp;
      <a href="#M000611">quote_schema_table</a>&nbsp;&nbsp;
      <a href="#M000612">quoted_identifier</a>&nbsp;&nbsp;
      <a href="#M000557">range</a>&nbsp;&nbsp;
      <a href="#M000614">reverse</a>&nbsp;&nbsp;
      <a href="#M000613">reverse_order</a>&nbsp;&nbsp;
      <a href="#M000615">schema_and_table</a>&nbsp;&nbsp;
      <a href="#M000616">select</a>&nbsp;&nbsp;
      <a href="#M000617">select_all</a>&nbsp;&nbsp;
      <a href="#M000618">select_more</a>&nbsp;&nbsp;
      <a href="#M000619">select_sql</a>&nbsp;&nbsp;
      <a href="#M000656">server</a>&nbsp;&nbsp;
      <a href="#M000657">set</a>&nbsp;&nbsp;
      <a href="#M000658">set_defaults</a>&nbsp;&nbsp;
      <a href="#M000539">set_graph_aliases</a>&nbsp;&nbsp;
      <a href="#M000659">set_model</a>&nbsp;&nbsp;
      <a href="#M000660">set_overrides</a>&nbsp;&nbsp;
      <a href="#M000558">single_record</a>&nbsp;&nbsp;
      <a href="#M000559">single_value</a>&nbsp;&nbsp;
      <a href="#M000575">size</a>&nbsp;&nbsp;
      <a href="#M000620">sql</a>&nbsp;&nbsp;
      <a href="#M000621">subscript_sql</a>&nbsp;&nbsp;
      <a href="#M000560">sum</a>&nbsp;&nbsp;
      <a href="#M000622">symbol_to_column_ref</a>&nbsp;&nbsp;
      <a href="#M000561">table_exists?</a>&nbsp;&nbsp;
      <a href="#M000562">to_csv</a>&nbsp;&nbsp;
      <a href="#M000563">to_hash</a>&nbsp;&nbsp;
      <a href="#M000632">to_prepared_statement</a>&nbsp;&nbsp;
      <a href="#M000629">to_table_reference</a>&nbsp;&nbsp;
      <a href="#M000661">transform</a>&nbsp;&nbsp;
      <a href="#M000662">transform_load</a>&nbsp;&nbsp;
      <a href="#M000663">transform_save</a>&nbsp;&nbsp;
      <a href="#M000623">unfiltered</a>&nbsp;&nbsp;
      <a href="#M000624">union</a>&nbsp;&nbsp;
      <a href="#M000625">uniq</a>&nbsp;&nbsp;
      <a href="#M000627">unordered</a>&nbsp;&nbsp;
      <a href="#M000664">upcase_identifiers?</a>&nbsp;&nbsp;
      <a href="#M000665">update</a>&nbsp;&nbsp;
      <a href="#M000628">update_sql</a>&nbsp;&nbsp;
      <a href="#M000581">where</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="Dataset/StoredProcedures.html">StoredProcedures</a></span>
        <span class="include-name"><a href="../Enumerable.html">Enumerable</a></span>
      </div>
    </div>

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Module <a href="Dataset/ArgumentMapper.html" class="link">Sequel::Dataset::ArgumentMapper</a><br />
Module <a href="Dataset/Pagination.html" class="link">Sequel::Dataset::Pagination</a><br />
Module <a href="Dataset/PreparedStatementMethods.html" class="link">Sequel::Dataset::PreparedStatementMethods</a><br />
Module <a href="Dataset/QueryBlockCopy.html" class="link">Sequel::Dataset::QueryBlockCopy</a><br />
Module <a href="Dataset/StoredProcedureMethods.html" class="link">Sequel::Dataset::StoredProcedureMethods</a><br />
Module <a href="Dataset/StoredProcedures.html" class="link">Sequel::Dataset::StoredProcedures</a><br />
Module <a href="Dataset/UnnumberedArgumentMapper.html" class="link">Sequel::Dataset::UnnumberedArgumentMapper</a><br />
Module <a href="Dataset/UnsupportedIntersectExcept.html" class="link">Sequel::Dataset::UnsupportedIntersectExcept</a><br />
Module <a href="Dataset/UnsupportedIntersectExceptAll.html" class="link">Sequel::Dataset::UnsupportedIntersectExceptAll</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COMMA_SEPARATOR</td>
          <td>=</td>
          <td class="context-item-value">', '.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COUNT_OF_ALL_AS_COUNT</td>
          <td>=</td>
          <td class="context-item-value">:count['*'.lit].as(:count)</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">AND_SEPARATOR</td>
          <td>=</td>
          <td class="context-item-value">&quot; AND &quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">BOOL_FALSE</td>
          <td>=</td>
          <td class="context-item-value">&quot;'f'&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">BOOL_TRUE</td>
          <td>=</td>
          <td class="context-item-value">&quot;'t'&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLUMN_REF_RE1</td>
          <td>=</td>
          <td class="context-item-value">/\A([\w ]+)__([\w ]+)___([\w ]+)\z/.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLUMN_REF_RE2</td>
          <td>=</td>
          <td class="context-item-value">/\A([\w ]+)___([\w ]+)\z/.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLUMN_REF_RE3</td>
          <td>=</td>
          <td class="context-item-value">/\A([\w ]+)__([\w ]+)\z/.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COUNT_FROM_SELF_OPTS</td>
          <td>=</td>
          <td class="context-item-value">[:distinct, :group, :sql, :limit]</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DATE_FORMAT</td>
          <td>=</td>
          <td class="context-item-value">&quot;DATE '%Y-%m-%d'&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">N_ARITY_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">::Sequel::SQL::ComplexExpression::N_ARITY_OPERATORS</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">NULL</td>
          <td>=</td>
          <td class="context-item-value">&quot;NULL&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">QUESTION_MARK</td>
          <td>=</td>
          <td class="context-item-value">'?'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">STOCK_COUNT_OPTS</td>
          <td>=</td>
          <td class="context-item-value">{:select =&gt; [&quot;COUNT(*)&quot;.lit], :order =&gt; nil}.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SELECT_CLAUSE_ORDER</td>
          <td>=</td>
          <td class="context-item-value">%w'distinct columns from join where group having intersect union except order limit'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TIMESTAMP_FORMAT</td>
          <td>=</td>
          <td class="context-item-value">&quot;TIMESTAMP '%Y-%m-%d %H:%M:%S'&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TWO_ARITY_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">::Sequel::SQL::ComplexExpression::TWO_ARITY_OPERATORS</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">WILDCARD</td>
          <td>=</td>
          <td class="context-item-value">'*'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PREPARED_ARG_PLACEHOLDER</td>
          <td>=</td>
          <td class="context-item-value">'?'.lit.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLUMN_CHANGE_OPTS</td>
          <td>=</td>
          <td class="context-item-value">[:select, :sql, :from, :join].freeze</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The dataset options that require the removal of cached <a
href="Dataset.html#M000644">columns</a> if changed.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DATASET_CLASSES</td>
          <td>=</td>
          <td class="context-item-value">[]</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="../Array.html">Array</a> of <a href="Dataset.html#M000642">all</a>
subclasses of <a href="Dataset.html">Dataset</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MUTATION_METHODS</td>
          <td>=</td>
          <td class="context-item-value">%w'add_graph_aliases and distinct exclude exists     filter from from_self full_outer_join graph     group group_and_count group_by having inner_join intersect invert join     left_outer_join limit naked or order order_by order_more paginate query reject     reverse reverse_order right_outer_join select select_all select_more     set_defaults set_graph_aliases set_model set_overrides sort sort_by     unfiltered union unordered where'.collect{|x| x.to_sym}</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
All methods that should have a ! method added that modifies the receiver.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">NOTIMPL_MSG</td>
          <td>=</td>
          <td class="context-item-value">&quot;This method must be overridden in Sequel adapters&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">STOCK_TRANSFORMS</td>
          <td>=</td>
          <td class="context-item-value">{       :marshal =&gt; [         # for backwards-compatibility we support also non-base64-encoded values.         proc {|v| Marshal.load(v.unpack('m')[0]) rescue Marshal.load(v)},          proc {|v| [Marshal.dump(v)].pack('m')}</td>
        </tr>
        </table>
      </div>
    </div>

    <div id="aliases-list">
      <h3 class="section-bar">External Aliases</h3>

      <div class="name-list">
                        <table summary="aliases">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">inner_join</td>
          <td>-&gt;</td>
          <td class="context-item-value">join</td>
        </tr>
                        </table>
      </div>
    </div>


    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">db</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
The database that corresponds to this dataset

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">opts</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
The hash of options for this dataset, keys are symbols.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">quote_identifiers</td>
          <td class="context-item-value">&nbsp;[W]&nbsp;</td>
          <td class="context-item-desc">
Whether to quote identifiers for this dataset

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">row_proc</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
The row_proc for this database, should be a Proc that takes a single hash
argument <a href="Dataset.html#M000568">and</a> returns the object you want
to <a href="Dataset.html#M000633">fetch_rows</a> to return.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">upcase_identifiers</td>
          <td class="context-item-value">&nbsp;[W]&nbsp;</td>
          <td class="context-item-desc">
Whether to upcase identifiers for this dataset

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000637" class="method-detail">
        <a name="M000637"></a>

        <div class="method-heading">
          <a href="#M000637" class="method-signature">
          <span class="method-name">dataset_classes</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The array of dataset subclasses.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000637-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000637-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 112</span>
112:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">dataset_classes</span>
113:       <span class="ruby-constant">DATASET_CLASSES</span>
114:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000638" class="method-detail">
        <a name="M000638"></a>

        <div class="method-heading">
          <a href="#M000638" class="method-signature">
          <span class="method-name">def_mutation_method</span><span class="method-args">(*meths)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Setup mutation (e.g. filter!) methods. These operate the same <a
href="Dataset.html#M000641">as</a> the non-! methods, but replace the
options of the current dataset with the options of the resulting dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000638-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000638-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 119</span>
119:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">def_mutation_method</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">meths</span>)
120:       <span class="ruby-identifier">meths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>
121:         <span class="ruby-identifier">class_eval</span>(<span class="ruby-node">&quot;def #{meth}!(*args, &amp;block); mutation_method(:#{meth}, *args, &amp;block) end&quot;</span>)
122:       <span class="ruby-keyword kw">end</span>
123:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000639" class="method-detail">
        <a name="M000639"></a>

        <div class="method-heading">
          <a href="#M000639" class="method-signature">
          <span class="method-name">inherited</span><span class="method-args">(c)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add the subclass to the array of subclasses.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000639-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000639-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 126</span>
126:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">inherited</span>(<span class="ruby-identifier">c</span>)
127:       <span class="ruby-constant">DATASET_CLASSES</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
128:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000636" class="method-detail">
        <a name="M000636"></a>

        <div class="method-heading">
          <a href="#M000636" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(db, opts = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Constructs a <a href="Dataset.html#M000636">new</a> instance of a dataset
with an associated database <a href="Dataset.html#M000568">and</a> options.
Datasets are usually constructed by invoking <a
href="Database.html">Database</a> methods:
</p>
<pre>
  DB[:posts]
</pre>
<p>
Or:
</p>
<pre>
  DB.dataset # the returned dataset is blank
</pre>
<p>
<a href="Dataset.html">Sequel::Dataset</a> is an abstract class that is not
useful by itself. Each database adaptor should provide a descendant class
of <a href="Dataset.html">Sequel::Dataset</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000636-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000636-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 100</span>
100:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>)
101:       <span class="ruby-ivar">@db</span> = <span class="ruby-identifier">db</span>
102:       <span class="ruby-ivar">@quote_identifiers</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">quote_identifiers?</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:quote_identifiers?</span>)
103:       <span class="ruby-ivar">@upcase_identifiers</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">upcase_identifiers?</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:upcase_identifiers?</span>)
104:       <span class="ruby-ivar">@opts</span> = <span class="ruby-identifier">opts</span> <span class="ruby-operator">||</span> {}
105:       <span class="ruby-ivar">@row_proc</span> = <span class="ruby-keyword kw">nil</span>
106:       <span class="ruby-ivar">@transform</span> = <span class="ruby-keyword kw">nil</span>
107:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000640" class="method-detail">
        <a name="M000640"></a>

        <div class="method-heading">
          <a href="#M000640" class="method-signature">
          <span class="method-name">&lt;&lt;</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000650">insert</a>, but not aliased
directly so subclasses don&#8216;t have to override both methods.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000640-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000640-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 134</span>
134:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
135:       <span class="ruby-identifier">insert</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
136:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000542" class="method-detail">
        <a name="M000542"></a>

        <div class="method-heading">
          <a href="#M000542" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(*conditions)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000546">first</a> record matching the
conditions.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000542-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000542-source">
<pre>
   <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 7</span>
7:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">conditions</span>)
8:       <span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">conditions</span>)
9:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000543" class="method-detail">
        <a name="M000543"></a>

        <div class="method-heading">
          <a href="#M000543" class="method-signature">
          <span class="method-name">[]=</span><span class="method-args">(conditions, values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Update <a href="Dataset.html#M000642">all</a> records matching the
conditions with the values specified.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000543-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000543-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 13</span>
13:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">conditions</span>, <span class="ruby-identifier">values</span>)
14:       <span class="ruby-identifier">filter</span>(<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">update</span>(<span class="ruby-identifier">values</span>)
15:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000540" class="method-detail">
        <a name="M000540"></a>

        <div class="method-heading">
          <a href="#M000540" class="method-signature">
          <span class="method-name">add_graph_aliases</span><span class="method-args">(graph_aliases)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds the give <a href="Dataset.html#M000538">graph</a> aliases to the list
of <a href="Dataset.html#M000538">graph</a> aliases to use, unlike <a
href="Dataset.html#M000539">set_graph_aliases</a>, which replaces the list.
See <a href="Dataset.html#M000539">set_graph_aliases</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000540-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000540-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/object_graph.rb, line 167</span>
167:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_graph_aliases</span>(<span class="ruby-identifier">graph_aliases</span>)
168:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">select_more</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">graph_alias_columns</span>(<span class="ruby-identifier">graph_aliases</span>))
169:       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph_aliases</span>] = (<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph_aliases</span>] <span class="ruby-operator">||</span> {}).<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">graph_aliases</span>)
170:       <span class="ruby-identifier">ds</span>
171:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000569" class="method-detail">
        <a name="M000569"></a>

        <div class="method-heading">
          <a href="#M000569" class="method-signature">
          <span class="method-name">aliased_expression_sql</span><span class="method-args">(ae)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the aliased expression
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000569-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000569-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 29</span>
29:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">aliased_expression_sql</span>(<span class="ruby-identifier">ae</span>)
30:       <span class="ruby-identifier">as_sql</span>(<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">ae</span>.<span class="ruby-identifier">expression</span>), <span class="ruby-identifier">ae</span>.<span class="ruby-identifier">aliaz</span>)
31:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000642" class="method-detail">
        <a name="M000642"></a>

        <div class="method-heading">
          <a href="#M000642" class="method-signature">
          <span class="method-name">all</span><span class="method-args">(opts = nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array with <a href="Dataset.html#M000642">all</a> records in the
dataset. If a block is given, the array is iterated over after <a
href="Dataset.html#M000642">all</a> items have been loaded.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000642-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000642-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 146</span>
146:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
147:       <span class="ruby-identifier">a</span> = []
148:       <span class="ruby-identifier">each</span>(<span class="ruby-identifier">opts</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>}
149:       <span class="ruby-identifier">post_load</span>(<span class="ruby-identifier">a</span>)
150:       <span class="ruby-identifier">a</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
151:       <span class="ruby-identifier">a</span>
152:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000568" class="method-detail">
        <a name="M000568"></a>

        <div class="method-heading">
          <a href="#M000568" class="method-signature">
          <span class="method-name">and</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an further <a href="Dataset.html#M000580">filter</a> to an existing <a
href="Dataset.html#M000580">filter</a> using AND. If no <a
href="Dataset.html#M000580">filter</a> <a
href="Dataset.html#M000579">exists</a> an error is raised. This method is
identical to <a href="Dataset.html#M000580">filter</a> <a
href="Dataset.html#M000577">except</a> it expects an existing <a
href="Dataset.html#M000580">filter</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000568-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000568-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 23</span>
23:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">and</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
24:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">NoExistingFilter</span>, <span class="ruby-value str">&quot;No existing filter found.&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:where</span>]
25:       <span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
26:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000570" class="method-detail">
        <a name="M000570"></a>

        <div class="method-heading">
          <a href="#M000570" class="method-signature">
          <span class="method-name">array_sql</span><span class="method-args">(a)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the <a href="SQL.html">SQL</a>
array.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000570-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000570-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 34</span>
34:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">array_sql</span>(<span class="ruby-identifier">a</span>)
35:       <span class="ruby-identifier">a</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-value str">'(NULL)'</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;(#{expression_list(a)})&quot;</span>     
36:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000641" class="method-detail">
        <a name="M000641"></a>

        <div class="method-heading">
          <a href="#M000641" class="method-signature">
          <span class="method-name">as</span><span class="method-args">(aliaz)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return the dataset <a href="Dataset.html#M000641">as</a> a column with the
given alias, so it can be used in the SELECT clause. This dataset should
result in a single row <a href="Dataset.html#M000568">and</a> a single
column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000641-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000641-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 140</span>
140:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">as</span>(<span class="ruby-identifier">aliaz</span>)
141:       <span class="ruby-operator">::</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">aliaz</span>)
142:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000544" class="method-detail">
        <a name="M000544"></a>

        <div class="method-heading">
          <a href="#M000544" class="method-signature">
          <span class="method-name">avg</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the average value for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000544-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000544-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 18</span>
18:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">avg</span>(<span class="ruby-identifier">column</span>)
19:       <span class="ruby-identifier">get</span>(<span class="ruby-identifier">:avg</span>[<span class="ruby-identifier">column</span>])
20:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000630" class="method-detail">
        <a name="M000630"></a>

        <div class="method-heading">
          <a href="#M000630" class="method-signature">
          <span class="method-name">call</span><span class="method-args">(type, bind_variables={}, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
For the given type (:<a href="Dataset.html#M000616">select</a>, :<a
href="Dataset.html#M000650">insert</a>, :<a
href="Dataset.html#M000665">update</a>, <a
href="Dataset.html#M000602">or</a> :<a
href="Dataset.html#M000647">delete</a>), run the <a
href="Dataset.html#M000620">sql</a> with the bind variables specified in
the hash. values is a hash of passed to <a
href="Dataset.html#M000650">insert</a> <a
href="Dataset.html#M000602">or</a> <a
href="Dataset.html#M000665">update</a> (if one of those types is used),
which may contain placeholders.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000630-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000630-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/prepared_statements.rb, line 181</span>
181:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">bind_variables</span>={}, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
182:       <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">type</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">values</span>).<span class="ruby-identifier">call</span>(<span class="ruby-identifier">bind_variables</span>)
183:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000571" class="method-detail">
        <a name="M000571"></a>

        <div class="method-heading">
          <a href="#M000571" class="method-signature">
          <span class="method-name">case_expression_sql</span><span class="method-args">(ce)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for specifying given CaseExpression.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000571-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000571-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 39</span>
39:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">case_expression_sql</span>(<span class="ruby-identifier">ce</span>)
40:       <span class="ruby-identifier">sql</span> = <span class="ruby-value str">'(CASE '</span>
41:       <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{literal(ce.expression)} &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ce</span>.<span class="ruby-identifier">expression</span>
42:       <span class="ruby-identifier">ce</span>.<span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">collect</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">c</span>,<span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
43:         <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;WHEN #{literal(c)} THEN #{literal(r)} &quot;</span>
44:       }
45:       <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;ELSE #{literal(ce.default)} END)&quot;</span>
46:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000643" class="method-detail">
        <a name="M000643"></a>

        <div class="method-heading">
          <a href="#M000643" class="method-signature">
          <span class="method-name">clone</span><span class="method-args">(opts = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Dataset.html#M000636">new</a> <a
href="Dataset.html#M000643">clone</a> of the dataset with with the given
options merged. If the options changed include options in
COLUMN_CHANGE_OPTS, the cached <a href="Dataset.html#M000644">columns</a>
are deleted.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000643-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000643-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 157</span>
157:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">opts</span> = {})
158:       <span class="ruby-identifier">c</span> = <span class="ruby-keyword kw">super</span>()
159:       <span class="ruby-identifier">c</span>.<span class="ruby-identifier">opts</span> = <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)
160:       <span class="ruby-identifier">c</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">:@columns</span>, <span class="ruby-keyword kw">nil</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-constant">COLUMN_CHANGE_OPTS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">o</span>)}
161:       <span class="ruby-identifier">c</span>
162:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000572" class="method-detail">
        <a name="M000572"></a>

        <div class="method-heading">
          <a href="#M000572" class="method-signature">
          <span class="method-name">column_all_sql</span><span class="method-args">(ca)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for specifying <a
href="Dataset.html#M000642">all</a> <a
href="Dataset.html#M000644">columns</a> in a given table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000572-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000572-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 49</span>
49:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">column_all_sql</span>(<span class="ruby-identifier">ca</span>)
50:       <span class="ruby-node">&quot;#{quote_schema_table(ca.table)}.*&quot;</span>
51:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000644" class="method-detail">
        <a name="M000644"></a>

        <div class="method-heading">
          <a href="#M000644" class="method-signature">
          <span class="method-name">columns</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000644">columns</a> in the result <a
href="Dataset.html#M000657">set</a> in their true <a
href="Dataset.html#M000603">order</a>. If the <a
href="Dataset.html#M000644">columns</a> are currently cached, returns the
cached value. Otherwise, a SELECT <a href="Dataset.html#M000541">query</a>
is performed to <a href="Dataset.html#M000547">get</a> a single row.
Adapters are expected to fill the <a
href="Dataset.html#M000644">columns</a> cache with the column information
when a <a href="Dataset.html#M000541">query</a> is performed. If the
dataset does not have any rows, this will be an empty array. If you are
looking for <a href="Dataset.html#M000642">all</a> <a
href="Dataset.html#M000644">columns</a> for a single table, see
Schema::SQL#schema.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000644-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000644-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 170</span>
170:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">columns</span>
171:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@columns</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@columns</span>
172:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">unfiltered</span>.<span class="ruby-identifier">unordered</span>.<span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:distinct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
173:       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">single_record</span>
174:       <span class="ruby-ivar">@columns</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">:@columns</span>)
175:       <span class="ruby-ivar">@columns</span> <span class="ruby-operator">||</span> []
176:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000645" class="method-detail">
        <a name="M000645"></a>

        <div class="method-heading">
          <a href="#M000645" class="method-signature">
          <span class="method-name">columns!</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Remove the cached list of <a href="Dataset.html#M000644">columns</a> <a
href="Dataset.html#M000568">and</a> do a SELECT <a
href="Dataset.html#M000541">query</a> to find the <a
href="Dataset.html#M000644">columns</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000645-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000645-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 180</span>
180:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">columns!</span>
181:       <span class="ruby-ivar">@columns</span> = <span class="ruby-keyword kw">nil</span>
182:       <span class="ruby-identifier">columns</span>
183:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000573" class="method-detail">
        <a name="M000573"></a>

        <div class="method-heading">
          <a href="#M000573" class="method-signature">
          <span class="method-name">complex_expression_sql</span><span class="method-args">(op, args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for complex expressions
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000573-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000573-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 54</span>
54:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">complex_expression_sql</span>(<span class="ruby-identifier">op</span>, <span class="ruby-identifier">args</span>)
55:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">op</span>
56:       <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">TWO_ARITY_OPERATORS</span>
57:         <span class="ruby-node">&quot;(#{literal(args.at(0))} #{op} #{literal(args.at(1))})&quot;</span>
58:       <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">N_ARITY_OPERATORS</span>
59:         <span class="ruby-node">&quot;(#{args.collect{|a| literal(a)}.join(&quot; #{op} &quot;)})&quot;</span>
60:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:NOT</span>
61:         <span class="ruby-node">&quot;NOT #{literal(args.at(0))}&quot;</span>
62:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:NOOP</span>
63:         <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">0</span>))
64:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'B~'</span><span class="ruby-value str">'B~'</span>
65:         <span class="ruby-node">&quot;~#{literal(args.at(0))}&quot;</span>
66:       <span class="ruby-keyword kw">else</span>
67:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;invalid operator #{op}&quot;</span>)
68:       <span class="ruby-keyword kw">end</span>
69:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000574" class="method-detail">
        <a name="M000574"></a>

        <div class="method-heading">
          <a href="#M000574" class="method-signature">
          <span class="method-name">count</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the number of records in the dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000574-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000574-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 72</span>
72:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">count</span>
73:       <span class="ruby-identifier">options_overlap</span>(<span class="ruby-constant">COUNT_FROM_SELF_OPTS</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">from_self</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">single_value</span>(<span class="ruby-constant">STOCK_COUNT_OPTS</span>).<span class="ruby-identifier">to_i</span>
74:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000567" class="method-detail">
        <a name="M000567"></a>

        <div class="method-heading">
          <a href="#M000567" class="method-signature">
          <span class="method-name">create_or_replace_view</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates <a href="Dataset.html#M000602">or</a> replaces a view in the
database with the given named based on the current dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000567-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000567-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/schema.rb, line 11</span>
11:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_or_replace_view</span>(<span class="ruby-identifier">name</span>)
12:       <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">create_or_replace_view</span>(<span class="ruby-identifier">name</span>, <span class="ruby-keyword kw">self</span>)
13:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000566" class="method-detail">
        <a name="M000566"></a>

        <div class="method-heading">
          <a href="#M000566" class="method-signature">
          <span class="method-name">create_view</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a view in the database with the given named based on the current
dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000566-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000566-source">
<pre>
   <span class="ruby-comment cmt"># File lib/sequel_core/dataset/schema.rb, line 5</span>
5:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_view</span>(<span class="ruby-identifier">name</span>)
6:       <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">create_view</span>(<span class="ruby-identifier">name</span>, <span class="ruby-keyword kw">self</span>)
7:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000646" class="method-detail">
        <a name="M000646"></a>

        <div class="method-heading">
          <a href="#M000646" class="method-signature">
          <span class="method-name">def_mutation_method</span><span class="method-args">(*meths)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add a mutation method to this dataset instance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000646-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000646-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 186</span>
186:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">def_mutation_method</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">meths</span>)
187:       <span class="ruby-identifier">meths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>
188:         <span class="ruby-identifier">instance_eval</span>(<span class="ruby-node">&quot;def #{meth}!(*args, &amp;block); mutation_method(:#{meth}, *args, &amp;block) end&quot;</span>)
189:       <span class="ruby-keyword kw">end</span>
190:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000647" class="method-detail">
        <a name="M000647"></a>

        <div class="method-heading">
          <a href="#M000647" class="method-signature">
          <span class="method-name">delete</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deletes the records in the dataset. The returned value is generally the
number of records deleted, but that is adapter dependent.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000647-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000647-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 194</span>
194:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
195:       <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">delete_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>))
196:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000576" class="method-detail">
        <a name="M000576"></a>

        <div class="method-heading">
          <a href="#M000576" class="method-signature">
          <span class="method-name">delete_sql</span><span class="method-args">(opts = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Formats a DELETE statement using the given options <a
href="Dataset.html#M000568">and</a> dataset options.
</p>
<pre>
  dataset.filter(:price &gt;= 100).delete_sql #=&gt;
    &quot;DELETE FROM items WHERE (price &gt;= 100)&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000576-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000576-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 81</span>
81:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_sql</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>)
82:       <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span> <span class="ruby-value">? </span><span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>) <span class="ruby-operator">:</span> <span class="ruby-ivar">@opts</span>
83: 
84:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]
85: 
86:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group</span>]
87:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;Grouped datasets cannot be deleted from&quot;</span>
88:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
89:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;Joined datasets cannot be deleted from&quot;</span>
90:       <span class="ruby-keyword kw">end</span>
91: 
92:       <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;DELETE FROM #{source_list(opts[:from])}&quot;</span>
93: 
94:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">where</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:where</span>]
95:         <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; WHERE #{literal(where)}&quot;</span>
96:       <span class="ruby-keyword kw">end</span>
97: 
98:       <span class="ruby-identifier">sql</span>
99:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000626" class="method-detail">
        <a name="M000626"></a>

        <div class="method-heading">
          <span class="method-name">distinct</span><span class="method-args">(*args)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000625">uniq</a>
</p>
        </div>
      </div>

      <div id="method-M000648" class="method-detail">
        <a name="M000648"></a>

        <div class="method-heading">
          <a href="#M000648" class="method-signature">
          <span class="method-name">each</span><span class="method-args">(opts = nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iterates over the records in the dataset <a
href="Dataset.html#M000568">and</a> returns <a
href="Dataset.html#M000657">set</a>. If opts have been passed that modify
the <a href="Dataset.html#M000644">columns</a>, reset the column
information.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000648-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000648-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 200</span>
200:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
201:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-constant">COLUMN_CHANGE_OPTS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">o</span>)}
202:         <span class="ruby-identifier">prev_columns</span> = <span class="ruby-ivar">@columns</span>
203:         <span class="ruby-keyword kw">begin</span>
204:           <span class="ruby-identifier">_each</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
205:         <span class="ruby-keyword kw">ensure</span>
206:           <span class="ruby-ivar">@columns</span> = <span class="ruby-identifier">prev_columns</span>
207:         <span class="ruby-keyword kw">end</span>
208:       <span class="ruby-keyword kw">else</span>
209:         <span class="ruby-identifier">_each</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
210:       <span class="ruby-keyword kw">end</span>
211:       <span class="ruby-keyword kw">self</span>
212:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000565" class="method-detail">
        <a name="M000565"></a>

        <div class="method-heading">
          <a href="#M000565" class="method-signature">
          <span class="method-name">each_page</span><span class="method-args">(page_size) {|paginate(page_no, page_size, record_count)}| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Yields a paginated dataset for <a href="Dataset.html#M000648">each</a> page
<a href="Dataset.html#M000568">and</a> returns the receiver. Does a <a
href="Dataset.html#M000574">count</a> to find the total number of records
for this dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000565-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000565-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/pagination.rb, line 16</span>
16:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_page</span>(<span class="ruby-identifier">page_size</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
17:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;You cannot paginate a dataset that already has a limit&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:limit</span>]
18:       <span class="ruby-identifier">record_count</span> = <span class="ruby-identifier">count</span>
19:       <span class="ruby-identifier">total_pages</span> = (<span class="ruby-identifier">record_count</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">page_size</span>.<span class="ruby-identifier">to_f</span>).<span class="ruby-identifier">ceil</span>
20:       (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">total_pages</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">page_no</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">page_no</span>, <span class="ruby-identifier">page_size</span>, <span class="ruby-identifier">record_count</span>)}
21:       <span class="ruby-keyword kw">self</span>
22:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000545" class="method-detail">
        <a name="M000545"></a>

        <div class="method-heading">
          <a href="#M000545" class="method-signature">
          <span class="method-name">empty?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if no records <a href="Dataset.html#M000579">exists</a> in the
dataset
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000545-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000545-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 23</span>
23:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
24:       <span class="ruby-identifier">get</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">nil?</span>
25:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000577" class="method-detail">
        <a name="M000577"></a>

        <div class="method-heading">
          <a href="#M000577" class="method-signature">
          <span class="method-name">except</span><span class="method-args">(dataset, all = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an EXCEPT clause using a second dataset object. If <a
href="Dataset.html#M000642">all</a> is true the clause used is EXCEPT ALL,
which may return duplicate rows.
</p>
<pre>
  DB[:items].except(DB[:other_items]).sql
  #=&gt; &quot;SELECT * FROM items EXCEPT SELECT * FROM other_items&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000577-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000577-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 106</span>
106:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">except</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span> = <span class="ruby-keyword kw">false</span>)
107:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:except</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">:except_all</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">all</span>)
108:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000578" class="method-detail">
        <a name="M000578"></a>

        <div class="method-heading">
          <a href="#M000578" class="method-signature">
          <span class="method-name">exclude</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Performs the inverse of <a href="Dataset.html#M000580">Dataset#filter</a>.
</p>
<pre>
  dataset.exclude(:category =&gt; 'software').sql #=&gt;
    &quot;SELECT * FROM items WHERE (category != 'software')&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000578-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000578-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 114</span>
114:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exclude</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
115:       <span class="ruby-identifier">clause</span> = (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">:having</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:where</span>)
116:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
117:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">sql_or</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cond</span>) <span class="ruby-operator">||</span> ((<span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cond</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">cond</span>.<span class="ruby-identifier">all_two_pairs?</span>))
118:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
119:       <span class="ruby-identifier">cond</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">invert</span>(<span class="ruby-identifier">cond</span>)
120:       <span class="ruby-identifier">cond</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:AND</span>, <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>], <span class="ruby-identifier">cond</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>]
121:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">clause</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cond</span>)
122:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000579" class="method-detail">
        <a name="M000579"></a>

        <div class="method-heading">
          <a href="#M000579" class="method-signature">
          <span class="method-name">exists</span><span class="method-args">(opts = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an EXISTS clause for the dataset <a
href="Dataset.html#M000641">as</a> a <a
href="LiteralString.html">LiteralString</a>.
</p>
<pre>
  DB.select(1).where(DB[:items].exists).sql
  #=&gt; &quot;SELECT 1 WHERE EXISTS (SELECT * FROM items)&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000579-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000579-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 128</span>
128:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exists</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>)
129:       <span class="ruby-node">&quot;EXISTS (#{select_sql(opts)})&quot;</span>.<span class="ruby-identifier">lit</span>
130:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000649" class="method-detail">
        <a name="M000649"></a>

        <div class="method-heading">
          <a href="#M000649" class="method-signature">
          <span class="method-name">fetch_rows</span><span class="method-args">(sql, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Executes a <a href="Dataset.html#M000616">select</a> <a
href="Dataset.html#M000541">query</a> <a
href="Dataset.html#M000568">and</a> fetches records, passing <a
href="Dataset.html#M000648">each</a> record to the supplied block. The
yielded records are generally hashes with symbol keys, but that is adapter
dependent.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000649-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000649-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 217</span>
217:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
218:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-constant">NOTIMPL_MSG</span>
219:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000633" class="method-detail">
        <a name="M000633"></a>

        <div class="method-heading">
          <a href="#M000633" class="method-signature">
          <span class="method-name">fetch_rows</span><span class="method-args">(sql) {|row| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Correctly return rows <a href="Dataset.html#M000583">from</a> the database
<a href="Dataset.html#M000568">and</a> return them <a
href="Dataset.html#M000641">as</a> hashes.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000633-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000633-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/adapters/jdbc.rb, line 375</span>
375:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
376:         <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">sql</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">result</span><span class="ruby-operator">|</span>
377:           <span class="ruby-comment cmt"># get column names</span>
378:           <span class="ruby-identifier">meta</span> = <span class="ruby-identifier">result</span>.<span class="ruby-identifier">getMetaData</span>
379:           <span class="ruby-identifier">column_count</span> = <span class="ruby-identifier">meta</span>.<span class="ruby-identifier">getColumnCount</span>
380:           <span class="ruby-ivar">@columns</span> = []
381:           <span class="ruby-identifier">column_count</span>.<span class="ruby-identifier">times</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@columns</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">meta</span>.<span class="ruby-identifier">getColumnName</span>(<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>).<span class="ruby-identifier">to_sym</span>}
382: 
383:           <span class="ruby-comment cmt"># get rows</span>
384:           <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">next</span>
385:             <span class="ruby-identifier">row</span> = {}
386:             <span class="ruby-ivar">@columns</span>.<span class="ruby-identifier">each_with_index</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>[<span class="ruby-identifier">v</span>] = <span class="ruby-identifier">result</span>.<span class="ruby-identifier">getObject</span>(<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>)}
387:             <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">row</span>
388:           <span class="ruby-keyword kw">end</span>
389:         <span class="ruby-keyword kw">end</span>
390:         <span class="ruby-keyword kw">self</span>
391:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000580" class="method-detail">
        <a name="M000580"></a>

        <div class="method-heading">
          <a href="#M000580" class="method-signature">
          <span class="method-name">filter</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the given conditions imposed upon it. If
the <a href="Dataset.html#M000541">query</a> has been grouped, then the
conditions are imposed in the HAVING clause. If not, then they are imposed
in the WHERE clause. Filter
</p>
<p>
<a href="Dataset.html#M000580">filter</a> accepts the following argument
types:
</p>
<ul>
<li><a href="../Hash.html">Hash</a> - list of equality expressions

</li>
<li><a href="../Array.html">Array</a> - depends:

<ul>
<li>If <a href="Dataset.html#M000546">first</a> member is a string, assumes the
rest of the arguments are parameters <a href="Dataset.html#M000568">and</a>
interpolates them into the string.

</li>
<li>If <a href="Dataset.html#M000642">all</a> members are arrays of length two,
treats the same way <a href="Dataset.html#M000641">as</a> a hash, <a
href="Dataset.html#M000577">except</a> it allows for duplicate keys to be
specified.

</li>
</ul>
</li>
<li><a href="../String.html">String</a> - taken literally

</li>
<li><a href="../Symbol.html">Symbol</a> - taken <a
href="Dataset.html#M000641">as</a> a boolean column argument (e.g. WHERE
active)

</li>
<li><a href="SQL/BooleanExpression.html">Sequel::SQL::BooleanExpression</a> -
an existing condition expression, probably created using the <a
href="../Sequel.html">Sequel</a> blockless <a
href="Dataset.html#M000580">filter</a> DSL.

</li>
</ul>
<p>
<a href="Dataset.html#M000580">filter</a> also takes a block, which should
return one of the above argument types, <a
href="Dataset.html#M000568">and</a> is treated the same way. If both a
block <a href="Dataset.html#M000568">and</a> regular argument are provided,
they <a href="Dataset.html#M000547">get</a> ANDed together.
</p>
<p>
Examples:
</p>
<pre>
  dataset.filter(:id =&gt; 3).sql #=&gt;
    &quot;SELECT * FROM items WHERE (id = 3)&quot;
  dataset.filter('price &lt; ?', 100).sql #=&gt;
    &quot;SELECT * FROM items WHERE price &lt; 100&quot;
  dataset.filter([[:id, (1,2,3)], [:id, 0..10]]).sql #=&gt;
    &quot;SELECT * FROM items WHERE ((id IN (1, 2, 3)) AND ((id &gt;= 0) AND (id &lt;= 10)))&quot;
  dataset.filter('price &lt; 100').sql #=&gt;
    &quot;SELECT * FROM items WHERE price &lt; 100&quot;
  dataset.filter(:active).sql #=&gt;
    &quot;SELECT * FROM items WHERE :active
  dataset.filter(:price &lt; 100).sql #=&gt;
    &quot;SELECT * FROM items WHERE (price &lt; 100)&quot;
</pre>
<p>
Multiple <a href="Dataset.html#M000580">filter</a> calls can be chained for
scoping:
</p>
<pre>
  software = dataset.filter(:category =&gt; 'software')
  software.filter(price &lt; 100).sql #=&gt;
    &quot;SELECT * FROM items WHERE ((category = 'software') AND (price &lt; 100))&quot;
</pre>
<p>
See doc/dataset_filters.rdoc for more examples <a
href="Dataset.html#M000568">and</a> details.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000580-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000580-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 176</span>
176:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
177:       <span class="ruby-identifier">clause</span> = (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">:having</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:where</span>)
178:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
179:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">transform_save</span>(<span class="ruby-identifier">cond</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@transform</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
180:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
181:       <span class="ruby-identifier">cond</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:AND</span>, <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>], <span class="ruby-identifier">cond</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>].<span class="ruby-identifier">blank?</span>
182:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">clause</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cond</span>)
183:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000546" class="method-detail">
        <a name="M000546"></a>

        <div class="method-heading">
          <a href="#M000546" class="method-signature">
          <span class="method-name">first</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000546">first</a> record in the dataset.
If a numeric argument is given, it is interpreted <a
href="Dataset.html#M000641">as</a> a <a
href="Dataset.html#M000599">limit</a>, <a
href="Dataset.html#M000568">and</a> then returns <a
href="Dataset.html#M000642">all</a> matching records up to that <a
href="Dataset.html#M000599">limit</a>. If no argument is passed, it returns
the <a href="Dataset.html#M000546">first</a> matching record. If any other
type of argument(s) is passed, it is given to <a
href="Dataset.html#M000580">filter</a> <a
href="Dataset.html#M000568">and</a> the <a
href="Dataset.html#M000546">first</a> matching record is returned. If a
block is given, it is used to <a href="Dataset.html#M000580">filter</a> the
dataset before returning anything.
</p>
<p>
Examples:
</p>
<pre>
  ds.first =&gt; {:id=&gt;7}
  ds.first(2) =&gt; [{:id=&gt;6}, {:id=&gt;4}]
  ds.order(:id).first(2) =&gt; [{:id=&gt;1}, {:id=&gt;2}]
  ds.first(:id=&gt;2) =&gt; {:id=&gt;2}
  ds.first(&quot;id = 3&quot;) =&gt; {:id=&gt;3}
  ds.first(&quot;id = ?&quot;, 4) =&gt; {:id=&gt;4}
  ds.first{:id &gt; 2} =&gt; {:id=&gt;5}
  ds.order(:id).first{:id &gt; 2} =&gt; {:id=&gt;3}
  ds.first{:id &gt; 2} =&gt; {:id=&gt;5}
  ds.first(&quot;id &gt; ?&quot;, 4){:id &lt; 6) =&gt; {:id=&gt;5}
  ds.order(:id).first(2){:id &lt; 2} =&gt; [{:id=&gt;1}]
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000546-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000546-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 48</span>
48:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
49:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">block</span> <span class="ruby-value">? </span><span class="ruby-identifier">filter</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>
50: 
51:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
52:         <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">single_record</span>
53:       <span class="ruby-keyword kw">else</span>
54:         <span class="ruby-identifier">args</span> = (<span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">args</span>
55:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Integer</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">args</span>
56:           <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">args</span>).<span class="ruby-identifier">all</span>
57:         <span class="ruby-keyword kw">else</span>
58:           <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">args</span>).<span class="ruby-identifier">single_record</span>
59:         <span class="ruby-keyword kw">end</span>
60:       <span class="ruby-keyword kw">end</span>
61:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000582" class="method-detail">
        <a name="M000582"></a>

        <div class="method-heading">
          <a href="#M000582" class="method-signature">
          <span class="method-name">first_source</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The <a href="Dataset.html#M000546">first</a> source (primary table) for
this dataset. If the dataset doesn&#8216;t have a table, raises an error.
If the table is aliased, returns the actual table name, not the alias.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000582-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000582-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 189</span>
189:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first_source</span>
190:       <span class="ruby-identifier">source</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>]
191:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">empty?</span>
192:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-value str">'No source specified for query'</span>
193:       <span class="ruby-keyword kw">end</span>
194:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">s</span> = <span class="ruby-identifier">source</span>.<span class="ruby-identifier">first</span>
195:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
196:         <span class="ruby-identifier">s</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">first</span>
197:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
198:         <span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">aliaz</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">s</span>)
199:         <span class="ruby-identifier">aliaz</span> <span class="ruby-value">? </span><span class="ruby-identifier">aliaz</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>
200:       <span class="ruby-keyword kw">else</span>
201:         <span class="ruby-identifier">s</span>
202:       <span class="ruby-keyword kw">end</span>
203:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000583" class="method-detail">
        <a name="M000583"></a>

        <div class="method-heading">
          <a href="#M000583" class="method-signature">
          <span class="method-name">from</span><span class="method-args">(*source)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the source changed.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000583-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000583-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 206</span>
206:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">source</span>)
207:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:from</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">source</span>)
208:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000584" class="method-detail">
        <a name="M000584"></a>

        <div class="method-heading">
          <a href="#M000584" class="method-signature">
          <span class="method-name">from_self</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a dataset selecting <a href="Dataset.html#M000583">from</a> the
current dataset.
</p>
<pre>
  ds = DB[:items].order(:name)
  ds.sql #=&gt; &quot;SELECT * FROM items ORDER BY name&quot;
  ds.from_self.sql #=&gt; &quot;SELECT * FROM (SELECT * FROM items ORDER BY name)&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000584-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000584-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 215</span>
215:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_self</span>
216:       <span class="ruby-identifier">fs</span> = {}
217:       <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">fs</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-keyword kw">nil</span>} 
218:       <span class="ruby-identifier">fs</span>[<span class="ruby-identifier">:from</span>] = [<span class="ruby-keyword kw">self</span>]
219:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">fs</span>)
220:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000585" class="method-detail">
        <a name="M000585"></a>

        <div class="method-heading">
          <a href="#M000585" class="method-signature">
          <span class="method-name">function_sql</span><span class="method-args">(f)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying an <a
href="SQL.html">SQL</a> function <a href="Dataset.html#M000630">call</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000585-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000585-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 223</span>
223:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">function_sql</span>(<span class="ruby-identifier">f</span>)
224:       <span class="ruby-identifier">args</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">args</span>
225:       <span class="ruby-node">&quot;#{f.f}#{args.empty? ? '()' : literal(args)}&quot;</span>
226:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000547" class="method-detail">
        <a name="M000547"></a>

        <div class="method-heading">
          <a href="#M000547" class="method-signature">
          <span class="method-name">get</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return the column value for the <a href="Dataset.html#M000546">first</a>
matching record in the dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000547-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000547-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 64</span>
64:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)
65:       <span class="ruby-identifier">select</span>(<span class="ruby-identifier">column</span>).<span class="ruby-identifier">single_value</span>
66:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000538" class="method-detail">
        <a name="M000538"></a>

        <div class="method-heading">
          <a href="#M000538" class="method-signature">
          <span class="method-name">graph</span><span class="method-args">(dataset, join_conditions = nil, options = {}, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Allows you to join multiple datasets/tables <a
href="Dataset.html#M000568">and</a> have the result <a
href="Dataset.html#M000657">set</a> split into component tables.
</p>
<p>
This differs <a href="Dataset.html#M000583">from</a> the usual usage of
join, which returns the result <a href="Dataset.html#M000657">set</a> <a
href="Dataset.html#M000641">as</a> a single hash. For example:
</p>
<pre>
  # CREATE TABLE artists (id INTEGER, name TEXT);
  # CREATE TABLE albums (id INTEGER, name TEXT, artist_id INTEGER);
  DB[:artists].left_outer_join(:albums, :artist_id=&gt;:id).first
  =&gt; {:id=&gt;(albums.id||artists.id), :name=&gt;(albums.name||artist.names), :artist_id=&gt;albums.artist_id}
  DB[:artists].graph(:albums, :artist_id=&gt;:id).first
  =&gt; {:artists=&gt;{:id=&gt;artists.id, :name=&gt;artists.name}, :albums=&gt;{:id=&gt;albums.id, :name=&gt;albums.name, :artist_id=&gt;albums.artist_id}}
</pre>
<p>
Using a join such <a href="Dataset.html#M000641">as</a> left_outer_join,
the attribute names that are shared between the tables are combined in the
single return hash. You can <a href="Dataset.html#M000547">get</a> around
that by using .<a href="Dataset.html#M000616">select</a> with correct
aliases for <a href="Dataset.html#M000642">all</a> of the <a
href="Dataset.html#M000644">columns</a>, but it is simpler to use <a
href="Dataset.html#M000538">graph</a> <a
href="Dataset.html#M000568">and</a> have the result <a
href="Dataset.html#M000657">set</a> split for you. In addition, <a
href="Dataset.html#M000538">graph</a> respects any row_proc <a
href="Dataset.html#M000602">or</a> <a
href="Dataset.html#M000661">transform</a> attributes of the current dataset
<a href="Dataset.html#M000568">and</a> the datasets you use with <a
href="Dataset.html#M000538">graph</a>.
</p>
<p>
If you are graphing a table <a href="Dataset.html#M000568">and</a> <a
href="Dataset.html#M000642">all</a> <a
href="Dataset.html#M000644">columns</a> for that table are nil, this
indicates that no matching rows existed in the table, so <a
href="Dataset.html#M000538">graph</a> will return nil instead of a hash
with <a href="Dataset.html#M000642">all</a> nil values:
</p>
<pre>
  # If the artist doesn't have any albums
  DB[:artists].graph(:albums, :artist_id=&gt;:id).first
  =&gt; {:artists=&gt;{:id=&gt;artists.id, :name=&gt;artists.name}, :albums=&gt;nil}
</pre>
<p>
Arguments:
</p>
<ul>
<li>dataset - Can be a symbol (specifying a table), another dataset, <a
href="Dataset.html#M000602">or</a> an object that responds to .dataset <a
href="Dataset.html#M000568">and</a> yields a symbol <a
href="Dataset.html#M000602">or</a> a dataset

</li>
<li>join_conditions - Any condition(s) allowed by <a
href="Dataset.html#M000598">join_table</a>.

</li>
<li>options - A hash of <a href="Dataset.html#M000538">graph</a> options. The
following options are currently used:

<ul>
<li>:implicit_qualifier - The qualifier of implicit conditions, see <a
href="Dataset.html#M000598">join_table</a>.

</li>
<li>:join_type - The type of join to use (passed to <a
href="Dataset.html#M000598">join_table</a>). Defaults to :left_outer.

</li>
<li>:<a href="Dataset.html#M000616">select</a> - An array of <a
href="Dataset.html#M000644">columns</a> to <a
href="Dataset.html#M000616">select</a>. When not used, selects <a
href="Dataset.html#M000642">all</a> <a
href="Dataset.html#M000644">columns</a> in the given dataset. When <a
href="Dataset.html#M000657">set</a> to false, selects no <a
href="Dataset.html#M000644">columns</a> <a
href="Dataset.html#M000568">and</a> is like simply joining the tables,
though <a href="Dataset.html#M000538">graph</a> keeps some metadata about
join that makes it important to use <a
href="Dataset.html#M000538">graph</a> instead of join.

</li>
<li>:table_alias - The alias to use for the table. If not specified,
doesn&#8216;t alias the table. You will <a
href="Dataset.html#M000547">get</a> an error if the the alias (<a
href="Dataset.html#M000602">or</a> table) name is used more than once.

</li>
</ul>
</li>
<li>block - A block that is passed to <a
href="Dataset.html#M000598">join_table</a>.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000538-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000538-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/object_graph.rb, line 48</span>
 48:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">graph</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">join_conditions</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
 49:       <span class="ruby-comment cmt"># Allow the use of a model, dataset, or symbol as the first argument</span>
 50:       <span class="ruby-comment cmt"># Find the table name/dataset based on the argument</span>
 51:       <span class="ruby-identifier">dataset</span> = <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">dataset</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:dataset</span>)
 52:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">dataset</span>
 53:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
 54:         <span class="ruby-identifier">table</span> = <span class="ruby-identifier">dataset</span>
 55:         <span class="ruby-identifier">dataset</span> = <span class="ruby-ivar">@db</span>[<span class="ruby-identifier">dataset</span>]
 56:       <span class="ruby-keyword kw">when</span> <span class="ruby-operator">::</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Dataset</span>
 57:         <span class="ruby-identifier">table</span> = <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">first_source</span>
 58:       <span class="ruby-keyword kw">else</span>
 59:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;The dataset argument should be a symbol, dataset, or model&quot;</span>
 60:       <span class="ruby-keyword kw">end</span>
 61: 
 62:       <span class="ruby-comment cmt"># Raise Sequel::Error with explanation that the table alias has been used</span>
 63:       <span class="ruby-identifier">raise_alias_error</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span>
 64:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;this #{options[:table_alias] ? 'alias' : 'table'} has already been been used, please specify &quot;</span> \
 65:           <span class="ruby-node">&quot;#{options[:table_alias] ? 'a different alias' : 'an alias via the :table_alias option'}&quot;</span>) 
 66:       <span class="ruby-keyword kw">end</span>
 67: 
 68:       <span class="ruby-comment cmt"># Only allow table aliases that haven't been used</span>
 69:       <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:table_alias</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">table</span>
 70:       <span class="ruby-identifier">raise_alias_error</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:graph</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:graph</span>][<span class="ruby-identifier">:table_aliases</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:graph</span>][<span class="ruby-identifier">:table_aliases</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">table_alias</span>)
 71: 
 72:       <span class="ruby-comment cmt"># Join the table early in order to avoid cloning the dataset twice</span>
 73:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">join_table</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:join_type</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">:left_outer</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">join_conditions</span>, <span class="ruby-identifier">:table_alias=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">:implicit_qualifier=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:implicit_qualifier</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
 74:       <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>
 75: 
 76:       <span class="ruby-comment cmt"># Whether to include the table in the result set</span>
 77:       <span class="ruby-identifier">add_table</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:select</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">true</span>
 78:       <span class="ruby-comment cmt"># Whether to add the columns to the list of column aliases</span>
 79:       <span class="ruby-identifier">add_columns</span> = <span class="ruby-operator">!</span><span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:graph_aliases</span>)
 80: 
 81:       <span class="ruby-comment cmt"># Setup the initial graph data structure if it doesn't exist</span>
 82:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">graph</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph</span>]
 83:         <span class="ruby-identifier">master</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first_source</span>
 84:         <span class="ruby-identifier">raise_alias_error</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">master</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">table_alias</span>
 85:         <span class="ruby-comment cmt"># Master hash storing all .graph related information</span>
 86:         <span class="ruby-identifier">graph</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph</span>] = {}
 87:         <span class="ruby-comment cmt"># Associates column aliases back to tables and columns</span>
 88:         <span class="ruby-identifier">column_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:column_aliases</span>] = {}
 89:         <span class="ruby-comment cmt"># Associates table alias (the master is never aliased)</span>
 90:         <span class="ruby-identifier">table_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:table_aliases</span>] = {<span class="ruby-identifier">master</span>=<span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">self</span>}
 91:         <span class="ruby-comment cmt"># Keep track of the alias numbers used</span>
 92:         <span class="ruby-identifier">ca_num</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:column_alias_num</span>] = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>)
 93:         <span class="ruby-comment cmt"># All columns in the master table are never</span>
 94:         <span class="ruby-comment cmt"># aliased, but are not included if set_graph_aliases</span>
 95:         <span class="ruby-comment cmt"># has been used.</span>
 96:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">add_columns</span>
 97:           <span class="ruby-identifier">select</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:select</span>] = []
 98:           <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
 99:             <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column</span>] = [<span class="ruby-identifier">master</span>, <span class="ruby-identifier">column</span>]
100:             <span class="ruby-identifier">select</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">column</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">master</span>))
101:           <span class="ruby-keyword kw">end</span>
102:         <span class="ruby-keyword kw">end</span>
103:       <span class="ruby-keyword kw">end</span>
104: 
105:       <span class="ruby-comment cmt"># Add the table alias to the list of aliases</span>
106:       <span class="ruby-comment cmt"># Even if it isn't been used in the result set,</span>
107:       <span class="ruby-comment cmt"># we add a key for it with a nil value so we can check if it</span>
108:       <span class="ruby-comment cmt"># is used more than once</span>
109:       <span class="ruby-identifier">table_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:table_aliases</span>]
110:       <span class="ruby-identifier">table_aliases</span>[<span class="ruby-identifier">table_alias</span>] = <span class="ruby-identifier">add_table</span> <span class="ruby-value">? </span><span class="ruby-identifier">dataset</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
111: 
112:       <span class="ruby-comment cmt"># Add the columns to the selection unless we are ignoring them</span>
113:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">add_table</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">add_columns</span>
114:         <span class="ruby-identifier">select</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:select</span>]
115:         <span class="ruby-identifier">column_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:column_aliases</span>]
116:         <span class="ruby-identifier">ca_num</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:column_alias_num</span>]
117:         <span class="ruby-comment cmt"># Which columns to add to the result set</span>
118:         <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:select</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">columns</span>
119:         <span class="ruby-comment cmt"># If the column hasn't been used yet, don't alias it.</span>
120:         <span class="ruby-comment cmt"># If it has been used, try table_column.</span>
121:         <span class="ruby-comment cmt"># If that has been used, try table_column_N </span>
122:         <span class="ruby-comment cmt"># using the next value of N that we know hasn't been</span>
123:         <span class="ruby-comment cmt"># used</span>
124:         <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
125:           <span class="ruby-identifier">col_alias</span>, <span class="ruby-identifier">identifier</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column</span>]
126:             <span class="ruby-identifier">column_alias</span> = <span class="ruby-node">&quot;#{table_alias}_#{column}&quot;</span><span class="ruby-node">&quot;#{table_alias}_#{column}&quot;</span>
127:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column_alias</span>]
128:               <span class="ruby-identifier">column_alias_num</span> = <span class="ruby-identifier">ca_num</span>[<span class="ruby-identifier">column_alias</span>]
129:               <span class="ruby-identifier">column_alias</span> = <span class="ruby-node">&quot;#{column_alias}_#{column_alias_num}&quot;</span><span class="ruby-node">&quot;#{column_alias}_#{column_alias_num}&quot;</span> 
130:               <span class="ruby-identifier">ca_num</span>[<span class="ruby-identifier">column_alias</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
131:             <span class="ruby-keyword kw">end</span>
132:             [<span class="ruby-identifier">column_alias</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">table_alias</span>).<span class="ruby-identifier">as</span>(<span class="ruby-identifier">column_alias</span>)]
133:           <span class="ruby-keyword kw">else</span>
134:             [<span class="ruby-identifier">column</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">table_alias</span>)]
135:           <span class="ruby-keyword kw">end</span>
136:           <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">col_alias</span>] = [<span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">column</span>]
137:           <span class="ruby-identifier">select</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">identifier</span>)
138:         <span class="ruby-keyword kw">end</span>
139:       <span class="ruby-keyword kw">end</span>
140:       <span class="ruby-identifier">ds</span>
141:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000586" class="method-detail">
        <a name="M000586"></a>

        <div class="method-heading">
          <a href="#M000586" class="method-signature">
          <span class="method-name">grep</span><span class="method-args">(cols, terms)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Pattern match any of the <a href="Dataset.html#M000644">columns</a> to any
of the terms. The terms can be strings (which use LIKE) <a
href="Dataset.html#M000602">or</a> regular expressions (which are only
supported in some databases). See Sequel::SQL::StringExpression.like. Note
that the total number of pattern matches will be cols.length *
terms.length, which could cause performance issues.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000586-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000586-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 233</span>
233:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">grep</span>(<span class="ruby-identifier">cols</span>, <span class="ruby-identifier">terms</span>)
234:       <span class="ruby-identifier">filter</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:OR</span>, <span class="ruby-operator">*</span><span class="ruby-constant">Array</span>(<span class="ruby-identifier">cols</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">StringExpression</span>.<span class="ruby-identifier">like</span>(<span class="ruby-identifier">c</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">terms</span>)}))
235:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000587" class="method-detail">
        <a name="M000587"></a>

        <div class="method-heading">
          <a href="#M000587" class="method-signature">
          <span class="method-name">group</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the results grouped by the value of the
given <a href="Dataset.html#M000644">columns</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000587-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000587-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 239</span>
239:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
240:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:group</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">columns</span>)
241:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000548" class="method-detail">
        <a name="M000548"></a>

        <div class="method-heading">
          <a href="#M000548" class="method-signature">
          <span class="method-name">group_and_count</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a dataset grouped by the given column with <a
href="Dataset.html#M000574">count</a> by <a
href="Dataset.html#M000587">group</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000548-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000548-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 69</span>
69:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group_and_count</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
70:       <span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>).<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span>(<span class="ruby-identifier">columns</span> <span class="ruby-operator">+</span> [<span class="ruby-constant">COUNT_OF_ALL_AS_COUNT</span>])).<span class="ruby-identifier">order</span>(<span class="ruby-identifier">:count</span>)
71:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000588" class="method-detail">
        <a name="M000588"></a>

        <div class="method-heading">
          <span class="method-name">group_by</span><span class="method-args">(*columns)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000587">group</a>
</p>
        </div>
      </div>

      <div id="method-M000589" class="method-detail">
        <a name="M000589"></a>

        <div class="method-heading">
          <a href="#M000589" class="method-signature">
          <span class="method-name">having</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000589">having</a> conditions changed. Raises an error
if the dataset has not been grouped. See also <a
href="Dataset.html#M000580">filter</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000589-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000589-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 246</span>
246:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">having</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
247:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;Can only specify a HAVING clause on a grouped dataset&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:group</span>]
248:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:having=</span><span class="ruby-operator">&gt;</span>{}).<span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
249:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000555" class="method-detail">
        <a name="M000555"></a>

        <div class="method-heading">
          <span class="method-name">import</span><span class="method-args">(*args)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000554">multi_insert</a>
</p>
        </div>
      </div>

      <div id="method-M000650" class="method-detail">
        <a name="M000650"></a>

        <div class="method-heading">
          <a href="#M000650" class="method-signature">
          <span class="method-name">insert</span><span class="method-args">(*values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inserts values into the associated table. The returned value is generally
the value of the primary key for the inserted row, but that is adapter
dependent.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000650-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000650-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 223</span>
223:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)
224:       <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">insert_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>))
225:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000590" class="method-detail">
        <a name="M000590"></a>

        <div class="method-heading">
          <a href="#M000590" class="method-signature">
          <span class="method-name">insert_multiple</span><span class="method-args">(array, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inserts multiple values. If a block is given it is invoked for <a
href="Dataset.html#M000648">each</a> item in the given array before
inserting it. See <a href="Dataset.html#M000554">multi_insert</a> <a
href="Dataset.html#M000641">as</a> a possible faster version that inserts
multiple records in one <a href="SQL.html">SQL</a> statement.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000590-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000590-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 255</span>
255:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert_multiple</span>(<span class="ruby-identifier">array</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
256:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
257:         <span class="ruby-identifier">array</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">insert</span>(<span class="ruby-identifier">block</span>[<span class="ruby-identifier">i</span>])}
258:       <span class="ruby-keyword kw">else</span>
259:         <span class="ruby-identifier">array</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">insert</span>(<span class="ruby-identifier">i</span>)}
260:       <span class="ruby-keyword kw">end</span>
261:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000591" class="method-detail">
        <a name="M000591"></a>

        <div class="method-heading">
          <a href="#M000591" class="method-signature">
          <span class="method-name">insert_sql</span><span class="method-args">(*values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Formats an INSERT statement using the given values. If a hash is given, the
resulting statement includes column names. If no values are given, the
resulting statement includes a DEFAULT VALUES clause.
</p>
<pre>
  dataset.insert_sql() #=&gt; 'INSERT INTO items DEFAULT VALUES'
  dataset.insert_sql(1,2,3) #=&gt; 'INSERT INTO items VALUES (1, 2, 3)'
  dataset.insert_sql(:a =&gt; 1, :b =&gt; 2) #=&gt;
    'INSERT INTO items (a, b) VALUES (1, 2)'
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000591-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000591-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 271</span>
271:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)
272:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]
273: 
274:       <span class="ruby-identifier">from</span> = <span class="ruby-identifier">source_list</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>])
275:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">size</span>
276:       <span class="ruby-keyword kw">when</span> <span class="ruby-value">0</span>
277:         <span class="ruby-identifier">values</span> = {}
278:       <span class="ruby-keyword kw">when</span> <span class="ruby-value">1</span>
279:         <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">0</span>)
280:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">is_one_of?</span>(<span class="ruby-constant">Hash</span>, <span class="ruby-constant">Dataset</span>, <span class="ruby-constant">Array</span>)
281:           <span class="ruby-identifier">values</span> = <span class="ruby-identifier">vals</span>
282:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:values</span>)
283:           <span class="ruby-identifier">values</span> = <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">values</span>
284:         <span class="ruby-keyword kw">end</span>
285:       <span class="ruby-keyword kw">end</span>
286: 
287:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">values</span>
288:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
289:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span>
290:           <span class="ruby-identifier">insert_default_values_sql</span>
291:         <span class="ruby-keyword kw">else</span>
292:           <span class="ruby-node">&quot;INSERT INTO #{from} VALUES #{literal(values)}&quot;</span>
293:         <span class="ruby-keyword kw">end</span>
294:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
295:         <span class="ruby-identifier">values</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:defaults</span>].<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">values</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:defaults</span>]
296:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:overrides</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:overrides</span>]
297:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">transform_save</span>(<span class="ruby-identifier">values</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@transform</span>
298:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span>
299:           <span class="ruby-identifier">insert_default_values_sql</span>
300:         <span class="ruby-keyword kw">else</span>
301:           <span class="ruby-identifier">fl</span>, <span class="ruby-identifier">vl</span> = [], []
302:           <span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
303:             <span class="ruby-identifier">fl</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal</span>(<span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">k</span> <span class="ruby-value">? </span><span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">k</span>)
304:             <span class="ruby-identifier">vl</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>)
305:           <span class="ruby-keyword kw">end</span>
306:           <span class="ruby-node">&quot;INSERT INTO #{from} (#{fl.join(COMMA_SEPARATOR)}) VALUES (#{vl.join(COMMA_SEPARATOR)})&quot;</span>
307:         <span class="ruby-keyword kw">end</span>
308:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Dataset</span>
309:         <span class="ruby-node">&quot;INSERT INTO #{from} #{literal(values)}&quot;</span>
310:       <span class="ruby-keyword kw">end</span>
311:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000651" class="method-detail">
        <a name="M000651"></a>

        <div class="method-heading">
          <a href="#M000651" class="method-signature">
          <span class="method-name">inspect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a string representation of the dataset including the class name <a
href="Dataset.html#M000568">and</a> the corresponding <a
href="SQL.html">SQL</a> <a href="Dataset.html#M000616">select</a>
statement.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000651-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000651-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 229</span>
229:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
230:       <span class="ruby-node">&quot;#&lt;#{self.class}: #{sql.inspect}&gt;&quot;</span>
231:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000592" class="method-detail">
        <a name="M000592"></a>

        <div class="method-heading">
          <a href="#M000592" class="method-signature">
          <span class="method-name">intersect</span><span class="method-args">(dataset, all = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an INTERSECT clause using a second dataset object. If <a
href="Dataset.html#M000642">all</a> is true the clause used is INTERSECT
ALL, which may return duplicate rows.
</p>
<pre>
  DB[:items].intersect(DB[:other_items]).sql
  #=&gt; &quot;SELECT * FROM items INTERSECT SELECT * FROM other_items&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000592-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000592-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 318</span>
318:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">intersect</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span> = <span class="ruby-keyword kw">false</span>)
319:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:intersect</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">:intersect_all</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">all</span>)
320:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000549" class="method-detail">
        <a name="M000549"></a>

        <div class="method-heading">
          <a href="#M000549" class="method-signature">
          <span class="method-name">interval</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000549">interval</a> between minimum <a
href="Dataset.html#M000568">and</a> maximum values for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000549-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000549-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 75</span>
75:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">interval</span>(<span class="ruby-identifier">column</span>)
76:       <span class="ruby-identifier">get</span>(<span class="ruby-node">&quot;(max(#{literal(column)}) - min(#{literal(column)}))&quot;</span>.<span class="ruby-identifier">lit</span>)
77:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000593" class="method-detail">
        <a name="M000593"></a>

        <div class="method-heading">
          <a href="#M000593" class="method-signature">
          <span class="method-name">invert</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inverts the current <a href="Dataset.html#M000580">filter</a>
</p>
<pre>
  dataset.filter(:category =&gt; 'software').invert.sql #=&gt;
    &quot;SELECT * FROM items WHERE (category != 'software')&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000593-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000593-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 326</span>
326:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">invert</span>
327:       <span class="ruby-identifier">having</span>, <span class="ruby-identifier">where</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>], <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:where</span>]
328:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;No current filter&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">having</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">where</span>
329:       <span class="ruby-identifier">o</span> = {}
330:       <span class="ruby-identifier">o</span>[<span class="ruby-identifier">:having</span>] = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">invert</span>(<span class="ruby-identifier">having</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">having</span>
331:       <span class="ruby-identifier">o</span>[<span class="ruby-identifier">:where</span>] = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">invert</span>(<span class="ruby-identifier">where</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">where</span>
332:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">o</span>)
333:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000594" class="method-detail">
        <a name="M000594"></a>

        <div class="method-heading">
          <a href="#M000594" class="method-signature">
          <span class="method-name">irregular_function_sql</span><span class="method-args">(f)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying an Irregular (cast/extract)
<a href="SQL.html">SQL</a> function <a href="Dataset.html#M000630">call</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000594-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000594-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 336</span>
336:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">irregular_function_sql</span>(<span class="ruby-identifier">f</span>)
337:       <span class="ruby-node">&quot;#{f.f}(#{literal(f.arg1)} #{f.joiner} #{literal(f.arg2)})&quot;</span>
338:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000595" class="method-detail">
        <a name="M000595"></a>

        <div class="method-heading">
          <a href="#M000595" class="method-signature">
          <span class="method-name">join_clause_sql</span><span class="method-args">(jc)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying a JOIN clause without ON <a
href="Dataset.html#M000602">or</a> USING.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000595-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000595-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 341</span>
341:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join_clause_sql</span>(<span class="ruby-identifier">jc</span>)
342:       <span class="ruby-identifier">table</span> = <span class="ruby-identifier">jc</span>.<span class="ruby-identifier">table</span>
343:       <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">jc</span>.<span class="ruby-identifier">table_alias</span>
344:       <span class="ruby-identifier">table_alias</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">table</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">table_alias</span>
345:       <span class="ruby-identifier">tref</span> = <span class="ruby-identifier">table_ref</span>(<span class="ruby-identifier">table</span>)
346:       <span class="ruby-node">&quot; #{join_type_sql(jc.join_type)} #{table_alias ? as_sql(tref, table_alias) : tref}&quot;</span>
347:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000596" class="method-detail">
        <a name="M000596"></a>

        <div class="method-heading">
          <a href="#M000596" class="method-signature">
          <span class="method-name">join_on_clause_sql</span><span class="method-args">(jc)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying a JOIN clause with ON.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000596-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000596-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 350</span>
350:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join_on_clause_sql</span>(<span class="ruby-identifier">jc</span>)
351:       <span class="ruby-node">&quot;#{join_clause_sql(jc)} ON #{literal(filter_expr(jc.on))}&quot;</span>
352:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000598" class="method-detail">
        <a name="M000598"></a>

        <div class="method-heading">
          <a href="#M000598" class="method-signature">
          <span class="method-name">join_table</span><span class="method-args">(type, table, expr=nil, options={}) {|table_name, last_alias, @opts[:join] || []| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a joined dataset. Uses the following arguments:
</p>
<ul>
<li>type - The type of join to do (:inner, :left_outer, :right_outer, :full)

</li>
<li>table - Depends on type:

<ul>
<li><a href="Dataset.html">Dataset</a> - a subselect is performed with an alias
of tN for some value of N

</li>
<li><a href="Model.html">Model</a> (<a href="Dataset.html#M000602">or</a>
anything responding to :table_name) - table.table_name

</li>
<li><a href="../String.html">String</a>, <a href="../Symbol.html">Symbol</a>:
table

</li>
</ul>
</li>
<li>expr - specifies conditions, depends on type:

<ul>
<li><a href="../Hash.html">Hash</a>, <a href="../Array.html">Array</a> with <a
href="Dataset.html#M000642">all</a> two pairs - Assumes key (1st arg) is
column of joined table (unless already qualified), <a
href="Dataset.html#M000568">and</a> value (2nd arg) is column of the <a
href="Dataset.html#M000550">last</a> joined <a
href="Dataset.html#M000602">or</a> primary table (<a
href="Dataset.html#M000602">or</a> the :implicit_qualifier option). To
specify multiple conditions on a single joined table column, you must use
an array. Uses a JOIN with an ON clause.

</li>
<li><a href="../Array.html">Array</a> - If <a
href="Dataset.html#M000642">all</a> members of the array are symbols,
considers them <a href="Dataset.html#M000641">as</a> <a
href="Dataset.html#M000644">columns</a> <a
href="Dataset.html#M000568">and</a> uses a JOIN with a USING clause. Most
databases will remove duplicate <a href="Dataset.html#M000644">columns</a>
<a href="Dataset.html#M000583">from</a> the result <a
href="Dataset.html#M000657">set</a> if this is used.

</li>
<li>nil - If a block is not given, doesn&#8216;t use ON <a
href="Dataset.html#M000602">or</a> USING, so the JOIN should be a NATURAL
<a href="Dataset.html#M000602">or</a> CROSS join. If a block is given, uses
a ON clause based on the block, see below.

</li>
<li>Everything else - pretty much the same <a
href="Dataset.html#M000641">as</a> a using the argument in a <a
href="Dataset.html#M000630">call</a> to <a
href="Dataset.html#M000580">filter</a>, so strings are considered <a
href="Dataset.html#M000600">literal</a>, symbols specify boolean <a
href="Dataset.html#M000644">columns</a>, <a
href="Dataset.html#M000568">and</a> blockless <a
href="Dataset.html#M000580">filter</a> expressions can be used. Uses a JOIN
with an ON clause.

</li>
</ul>
</li>
<li>options - a hash of options, with any of the following keys:

<ul>
<li>:table_alias - the name of the table&#8216;s alias when joining, necessary
for joining to the same table more than once. No alias is used by default.

</li>
<li>:implicit_qualifer - The name to use for qualifying implicit conditions. By
default, the <a href="Dataset.html#M000550">last</a> joined <a
href="Dataset.html#M000602">or</a> primary table is used.

</li>
</ul>
</li>
<li>block - The block argument should only be given if a JOIN with an ON clause
is used, in which case it yields the table alias/name for the table
currently being joined, the table alias/name for the <a
href="Dataset.html#M000550">last</a> joined (<a
href="Dataset.html#M000602">or</a> <a href="Dataset.html#M000546">first</a>
table), <a href="Dataset.html#M000568">and</a> an array of previous <a
href="SQL/JoinClause.html">SQL::JoinClause</a>.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000598-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000598-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 389</span>
389:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join_table</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">expr</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
390:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">is_one_of?</span>(<span class="ruby-constant">Symbol</span>, <span class="ruby-constant">String</span>)
391:         <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">options</span>
392:         <span class="ruby-identifier">last_alias</span> = <span class="ruby-keyword kw">nil</span> 
393:       <span class="ruby-keyword kw">else</span>
394:         <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:table_alias</span>]
395:         <span class="ruby-identifier">last_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:implicit_qualifier</span>]
396:       <span class="ruby-keyword kw">end</span>
397:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Dataset</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">table</span>
398:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">table_alias</span>.<span class="ruby-identifier">nil?</span>
399:           <span class="ruby-identifier">table_alias_num</span> = (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:num_dataset_sources</span>] <span class="ruby-operator">||</span> <span class="ruby-value">0</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
400:           <span class="ruby-identifier">table_alias</span> = <span class="ruby-node">&quot;t#{table_alias_num}&quot;</span>
401:         <span class="ruby-keyword kw">end</span>
402:         <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">table_alias</span>
403:       <span class="ruby-keyword kw">else</span>
404:         <span class="ruby-identifier">table</span> = <span class="ruby-identifier">table</span>.<span class="ruby-identifier">table_name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">table</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:table_name</span>)
405:         <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">table</span>
406:       <span class="ruby-keyword kw">end</span>
407: 
408:       <span class="ruby-identifier">join</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block_given?</span>
409:         <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_alias</span>)
410:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">expr</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">expr</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-constant">Symbol</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">x</span>}
411:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;can't use a block if providing an array of symbols as expr&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
412:         <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinUsingClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_alias</span>)
413:       <span class="ruby-keyword kw">else</span>
414:         <span class="ruby-identifier">last_alias</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:last_joined_table</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">first_source</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>) <span class="ruby-operator">?</span> <span class="ruby-value str">'t1'</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">first_source</span>)
415:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">expr</span> <span class="ruby-keyword kw">or</span> (<span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">expr</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">all_two_pairs?</span>)
416:           <span class="ruby-identifier">expr</span> = <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
417:             <span class="ruby-identifier">k</span> = <span class="ruby-identifier">qualified_column_name</span>(<span class="ruby-identifier">k</span>, <span class="ruby-identifier">table_name</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
418:             <span class="ruby-identifier">v</span> = <span class="ruby-identifier">qualified_column_name</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">last_alias</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
419:             [<span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span>]
420:           <span class="ruby-keyword kw">end</span>
421:         <span class="ruby-keyword kw">end</span>
422:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
423:           <span class="ruby-identifier">expr2</span> = <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">last_alias</span>, <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:join</span>] <span class="ruby-operator">||</span> [])
424:           <span class="ruby-identifier">expr</span> = <span class="ruby-identifier">expr</span> <span class="ruby-value">? </span><span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:AND</span>, <span class="ruby-identifier">expr</span>, <span class="ruby-identifier">expr2</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">expr2</span>
425:         <span class="ruby-keyword kw">end</span>
426:         <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinOnClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_alias</span>)
427:       <span class="ruby-keyword kw">end</span>
428: 
429:       <span class="ruby-identifier">opts</span> = {<span class="ruby-identifier">:join</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:join</span>] <span class="ruby-operator">||</span> []) <span class="ruby-operator">+</span> [<span class="ruby-identifier">join</span>], <span class="ruby-identifier">:last_joined_table</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">table_name</span>}
430:       <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:num_dataset_sources</span>] = <span class="ruby-identifier">table_alias_num</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">table_alias_num</span>
431:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">opts</span>)
432:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000597" class="method-detail">
        <a name="M000597"></a>

        <div class="method-heading">
          <a href="#M000597" class="method-signature">
          <span class="method-name">join_using_clause_sql</span><span class="method-args">(jc)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying a JOIN clause with USING.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000597-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000597-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 355</span>
355:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join_using_clause_sql</span>(<span class="ruby-identifier">jc</span>)
356:       <span class="ruby-node">&quot;#{join_clause_sql(jc)} USING (#{column_list(jc.using)})&quot;</span>
357:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000550" class="method-detail">
        <a name="M000550"></a>

        <div class="method-heading">
          <a href="#M000550" class="method-signature">
          <span class="method-name">last</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reverses the <a href="Dataset.html#M000603">order</a> <a
href="Dataset.html#M000568">and</a> then runs <a
href="Dataset.html#M000546">first</a>. Note that this will not necessarily
give you the <a href="Dataset.html#M000550">last</a> record in the dataset,
unless you have an unambiguous <a href="Dataset.html#M000603">order</a>. If
there is not currently an <a href="Dataset.html#M000603">order</a> for this
dataset, raises an <a href="Error.html">Error</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000550-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000550-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 83</span>
83:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">last</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
84:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">'No order specified'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:order</span>]
85:       <span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
86:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000599" class="method-detail">
        <a name="M000599"></a>

        <div class="method-heading">
          <a href="#M000599" class="method-signature">
          <span class="method-name">limit</span><span class="method-args">(l, o = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
If given an integer, the dataset will contain only the <a
href="Dataset.html#M000546">first</a> l results. If given a <a
href="Dataset.html#M000557">range</a>, it will contain only those at
offsets within that <a href="Dataset.html#M000557">range</a>. If a second
argument is given, it is used <a href="Dataset.html#M000641">as</a> an
offset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000599-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000599-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 437</span>
437:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">l</span>, <span class="ruby-identifier">o</span> = <span class="ruby-keyword kw">nil</span>)
438:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">from_self</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">l</span>, <span class="ruby-identifier">o</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]
439: 
440:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Range</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">l</span>
441:         <span class="ruby-identifier">o</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">first</span>
442:         <span class="ruby-identifier">l</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">interval</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
443:       <span class="ruby-keyword kw">end</span>
444:       <span class="ruby-identifier">l</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">to_i</span>
445:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">'Limits must be greater than or equal to 1'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">l</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">1</span>
446:       <span class="ruby-identifier">opts</span> = {<span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">l</span>}
447:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">o</span>
448:         <span class="ruby-identifier">o</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">to_i</span>
449:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">'Offsets must be greater than or equal to 0'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">o</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>
450:         <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:offset</span>] = <span class="ruby-identifier">o</span>
451:       <span class="ruby-keyword kw">end</span>
452:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">opts</span>)
453:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000634" class="method-detail">
        <a name="M000634"></a>

        <div class="method-heading">
          <a href="#M000634" class="method-signature">
          <span class="method-name">literal</span><span class="method-args">(v)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Use the ISO values for dates <a href="Dataset.html#M000568">and</a> times.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000634-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000634-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/adapters/jdbc.rb, line 394</span>
394:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>)
395:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">v</span>
396:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Time</span>
397:           <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">iso8601</span>)
398:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Date</span>, <span class="ruby-constant">DateTime</span>, <span class="ruby-constant">Java</span><span class="ruby-operator">::</span><span class="ruby-constant">JavaSql</span><span class="ruby-operator">::</span><span class="ruby-constant">Timestamp</span>, <span class="ruby-constant">Java</span><span class="ruby-operator">::</span><span class="ruby-constant">JavaSql</span><span class="ruby-operator">::</span><span class="ruby-constant">Date</span>
399:           <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)
400:         <span class="ruby-keyword kw">else</span>
401:           <span class="ruby-keyword kw">super</span>
402:         <span class="ruby-keyword kw">end</span>
403:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000600" class="method-detail">
        <a name="M000600"></a>

        <div class="method-heading">
          <a href="#M000600" class="method-signature">
          <span class="method-name">literal</span><span class="method-args">(v)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Dataset.html#M000600">literal</a> representation of a
value to be used <a href="Dataset.html#M000641">as</a> part of an <a
href="SQL.html">SQL</a> expression.
</p>
<pre>
  dataset.literal(&quot;abc'def\\&quot;) #=&gt; &quot;'abc''def\\\\'&quot;
  dataset.literal(:items__id) #=&gt; &quot;items.id&quot;
  dataset.literal([1, 2, 3]) =&gt; &quot;(1, 2, 3)&quot;
  dataset.literal(DB[:items]) =&gt; &quot;(SELECT * FROM items)&quot;
  dataset.literal(:x + 1 &gt; :y) =&gt; &quot;((x + 1) &gt; y)&quot;
</pre>
<p>
If an unsupported object is given, an exception is raised.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000600-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000600-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 465</span>
465:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>)
466:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">v</span>
467:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">LiteralString</span>
468:         <span class="ruby-identifier">v</span>
469:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
470:         <span class="ruby-node">&quot;'#{v.gsub(/\\/, &quot;\\\\\\\\&quot;).gsub(/'/, &quot;''&quot;)}'&quot;</span>
471:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Integer</span>, <span class="ruby-constant">Float</span>
472:         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>
473:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">BigDecimal</span>
474:         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-value str">&quot;F&quot;</span>)
475:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">NilClass</span>
476:         <span class="ruby-constant">NULL</span>
477:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">TrueClass</span>
478:         <span class="ruby-constant">BOOL_TRUE</span>
479:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">FalseClass</span>
480:         <span class="ruby-constant">BOOL_FALSE</span>
481:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
482:         <span class="ruby-identifier">symbol_to_column_ref</span>(<span class="ruby-identifier">v</span>)
483:       <span class="ruby-keyword kw">when</span> <span class="ruby-operator">::</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Expression</span>
484:         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-keyword kw">self</span>)
485:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
486:         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">all_two_pairs?</span> <span class="ruby-value">? </span><span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">sql_expr</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">array_sql</span>(<span class="ruby-identifier">v</span>)
487:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
488:         <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">sql_expr</span>)
489:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Time</span>, <span class="ruby-constant">DateTime</span>
490:         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-constant">TIMESTAMP_FORMAT</span>)
491:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Date</span>
492:         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-constant">DATE_FORMAT</span>)
493:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Dataset</span>
494:         <span class="ruby-node">&quot;(#{subselect_sql(v)})&quot;</span>
495:       <span class="ruby-keyword kw">else</span>
496:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;can't express #{v.inspect} as a SQL literal&quot;</span>
497:       <span class="ruby-keyword kw">end</span>
498:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000551" class="method-detail">
        <a name="M000551"></a>

        <div class="method-heading">
          <a href="#M000551" class="method-signature">
          <span class="method-name">map</span><span class="method-args">(column_name = nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Maps column values for <a href="Dataset.html#M000648">each</a> record in
the dataset (if a column name is given), <a
href="Dataset.html#M000602">or</a> performs the stock mapping functionality
of <a href="../Enumerable.html">Enumerable</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000551-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000551-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 90</span>
90:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">map</span>(<span class="ruby-identifier">column_name</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
91:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column_name</span>
92:         <span class="ruby-keyword kw">super</span>() {<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>[<span class="ruby-identifier">column_name</span>]}
93:       <span class="ruby-keyword kw">else</span>
94:         <span class="ruby-keyword kw">super</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
95:       <span class="ruby-keyword kw">end</span>
96:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000552" class="method-detail">
        <a name="M000552"></a>

        <div class="method-heading">
          <a href="#M000552" class="method-signature">
          <span class="method-name">max</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the maximum value for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000552-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000552-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 99</span>
 99:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">max</span>(<span class="ruby-identifier">column</span>)
100:       <span class="ruby-identifier">get</span>(<span class="ruby-identifier">:max</span>[<span class="ruby-identifier">column</span>])
101:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000553" class="method-detail">
        <a name="M000553"></a>

        <div class="method-heading">
          <a href="#M000553" class="method-signature">
          <span class="method-name">min</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the minimum value for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000553-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000553-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 104</span>
104:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">min</span>(<span class="ruby-identifier">column</span>)
105:       <span class="ruby-identifier">get</span>(<span class="ruby-identifier">:min</span>[<span class="ruby-identifier">column</span>])
106:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000652" class="method-detail">
        <a name="M000652"></a>

        <div class="method-heading">
          <a href="#M000652" class="method-signature">
          <span class="method-name">model_classes</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the the model classes associated with the dataset <a
href="Dataset.html#M000641">as</a> a hash. If the dataset is associated
with a single model class, a key of nil is used. For datasets with
polymorphic models, the keys are values of the polymorphic column <a
href="Dataset.html#M000568">and</a> the values are the corresponding model
classes to which they <a href="Dataset.html#M000551">map</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000652-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000652-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 238</span>
238:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">model_classes</span>
239:       <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:models</span>]
240:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000554" class="method-detail">
        <a name="M000554"></a>

        <div class="method-heading">
          <a href="#M000554" class="method-signature">
          <span class="method-name">multi_insert</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inserts multiple records into the associated table. This method can be to
efficiently <a href="Dataset.html#M000650">insert</a> a large amounts of
records into a table. Inserts are automatically wrapped in a transaction.
</p>
<p>
This method should be called with a <a
href="Dataset.html#M000644">columns</a> array <a
href="Dataset.html#M000568">and</a> an array of value arrays:
</p>
<pre>
  dataset.multi_insert([:x, :y], [[1, 2], [3, 4]])
</pre>
<p>
This method can also be called with an array of hashes:
</p>
<pre>
  dataset.multi_insert({:x =&gt; 1}, {:x =&gt; 2})
</pre>
<p>
Be aware that <a href="Dataset.html#M000642">all</a> hashes should have the
same keys if you use this calling method, otherwise some <a
href="Dataset.html#M000644">columns</a> could be missed <a
href="Dataset.html#M000602">or</a> <a href="Dataset.html#M000657">set</a>
to null instead of to default values.
</p>
<p>
The method also accepts a :slice <a href="Dataset.html#M000602">or</a>
:commit_every option that specifies the number of records to <a
href="Dataset.html#M000650">insert</a> per transaction. This is useful
especially when inserting a large number of records, e.g.:
</p>
<pre>
  # this will commit every 50 records
  dataset.multi_insert(lots_of_records, :slice =&gt; 50)
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000554-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000554-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 130</span>
130:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">multi_insert</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
131:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
132:         <span class="ruby-keyword kw">return</span>
133:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
134:         <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
135:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>)
136:         <span class="ruby-identifier">table</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">first</span>
137:         <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">dataset</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
138:         <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;INSERT INTO #{quote_identifier(table)} (#{identifier_list(columns)}) VALUES #{literal(dataset)}&quot;</span>
139:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>{<span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">sql</span>)}
140:       <span class="ruby-keyword kw">else</span>
141:         <span class="ruby-comment cmt"># we assume that an array of hashes is given</span>
142:         <span class="ruby-identifier">hashes</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
143:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">empty?</span>
144:         <span class="ruby-identifier">columns</span> = <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">keys</span>
145:         <span class="ruby-comment cmt"># convert the hashes into arrays</span>
146:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">c</span>]}}
147:       <span class="ruby-keyword kw">end</span>
148:       <span class="ruby-comment cmt"># make sure there's work to do</span>
149:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span>
150:       
151:       <span class="ruby-identifier">slice_size</span> = <span class="ruby-identifier">opts</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:commit_every</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:slice</span>])
152:       
153:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">slice_size</span>
154:         <span class="ruby-identifier">values</span>.<span class="ruby-identifier">each_slice</span>(<span class="ruby-identifier">slice_size</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">slice</span><span class="ruby-operator">|</span>
155:           <span class="ruby-identifier">statements</span> = <span class="ruby-identifier">multi_insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">slice</span>)
156:           <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>{<span class="ruby-identifier">statements</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">st</span><span class="ruby-operator">|</span> <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">st</span>)}}
157:         <span class="ruby-keyword kw">end</span>
158:       <span class="ruby-keyword kw">else</span>
159:         <span class="ruby-identifier">statements</span> = <span class="ruby-identifier">multi_insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>)
160:         <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>{<span class="ruby-identifier">statements</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">st</span><span class="ruby-operator">|</span> <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">st</span>)}}
161:       <span class="ruby-keyword kw">end</span>
162:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000601" class="method-detail">
        <a name="M000601"></a>

        <div class="method-heading">
          <a href="#M000601" class="method-signature">
          <span class="method-name">multi_insert_sql</span><span class="method-args">(columns, values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of <a href="Dataset.html#M000650">insert</a> statements
for inserting multiple records. This method is used by <a
href="Dataset.html#M000554">multi_insert</a> to format <a
href="Dataset.html#M000650">insert</a> statements <a
href="Dataset.html#M000568">and</a> expects a keys array <a
href="Dataset.html#M000568">and</a> <a href="Dataset.html#M000568">and</a>
an array of value arrays.
</p>
<p>
This method should be overridden by descendants if the support inserting
multiple records in a single <a href="SQL.html">SQL</a> statement.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000601-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000601-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 506</span>
506:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">multi_insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>)
507:       <span class="ruby-identifier">table</span> = <span class="ruby-identifier">quote_identifier</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">first</span>)
508:       <span class="ruby-identifier">columns</span> = <span class="ruby-identifier">identifier_list</span>(<span class="ruby-identifier">columns</span>)
509:       <span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
510:         <span class="ruby-node">&quot;INSERT INTO #{table} (#{columns}) VALUES #{literal(r)}&quot;</span>
511:       <span class="ruby-keyword kw">end</span>
512:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000653" class="method-detail">
        <a name="M000653"></a>

        <div class="method-heading">
          <a href="#M000653" class="method-signature">
          <span class="method-name">naked</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Dataset.html#M000653">naked</a> dataset <a
href="Dataset.html#M000643">clone</a> - i.e. a dataset that returns records
<a href="Dataset.html#M000641">as</a> hashes rather than model objects.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000653-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000653-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 244</span>
244:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">naked</span>
245:       <span class="ruby-identifier">clone</span>.<span class="ruby-identifier">set_model</span>(<span class="ruby-keyword kw">nil</span>)
246:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000602" class="method-detail">
        <a name="M000602"></a>

        <div class="method-heading">
          <a href="#M000602" class="method-signature">
          <span class="method-name">or</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an alternate <a href="Dataset.html#M000580">filter</a> to an existing
<a href="Dataset.html#M000580">filter</a> using OR. If no <a
href="Dataset.html#M000580">filter</a> <a
href="Dataset.html#M000579">exists</a> an error is raised.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000602-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000602-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 516</span>
516:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">or</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
517:       <span class="ruby-identifier">clause</span> = (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">:having</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:where</span>)
518:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
519:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>]
520:         <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">clause</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:OR</span>, <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>], <span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)))
521:       <span class="ruby-keyword kw">else</span>
522:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">NoExistingFilter</span>, <span class="ruby-value str">&quot;No existing filter found.&quot;</span>
523:       <span class="ruby-keyword kw">end</span>
524:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000603" class="method-detail">
        <a name="M000603"></a>

        <div class="method-heading">
          <a href="#M000603" class="method-signature">
          <span class="method-name">order</span><span class="method-args">(*order)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000603">order</a> changed. If a nil is given the
returned dataset has no <a href="Dataset.html#M000603">order</a>. This can
accept multiple arguments of varying kinds, <a
href="Dataset.html#M000568">and</a> even <a href="SQL.html">SQL</a>
functions.
</p>
<pre>
  ds.order(:name).sql #=&gt; 'SELECT * FROM items ORDER BY name'
  ds.order(:a, :b).sql #=&gt; 'SELECT * FROM items ORDER BY a, b'
  ds.order('a + b'.lit).sql #=&gt; 'SELECT * FROM items ORDER BY a + b'
  ds.order(:a + :b).sql #=&gt; 'SELECT * FROM items ORDER BY (a + b)'
  ds.order(:name.desc).sql #=&gt; 'SELECT * FROM items ORDER BY name DESC'
  ds.order(:name.asc).sql #=&gt; 'SELECT * FROM items ORDER BY name ASC'
  ds.order(:arr|1).sql #=&gt; 'SELECT * FROM items ORDER BY arr[1]'
  ds.order(nil).sql #=&gt; 'SELECT * FROM items'
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000603-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000603-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 538</span>
538:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">order</span>)
539:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">order</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">empty?</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">order</span>)
540:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000604" class="method-detail">
        <a name="M000604"></a>

        <div class="method-heading">
          <span class="method-name">order_by</span><span class="method-args">(*order)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000603">order</a>
</p>
        </div>
      </div>

      <div id="method-M000605" class="method-detail">
        <a name="M000605"></a>

        <div class="method-heading">
          <a href="#M000605" class="method-signature">
          <span class="method-name">order_more</span><span class="method-args">(*order)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000603">order</a> <a
href="Dataset.html#M000644">columns</a> added to the existing <a
href="Dataset.html#M000603">order</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000605-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000605-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 545</span>
545:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">order_more</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">order</span>)
546:       <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span>((<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:order</span>] <span class="ruby-operator">||</span> []) <span class="ruby-operator">+</span> <span class="ruby-identifier">order</span>))
547:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000606" class="method-detail">
        <a name="M000606"></a>

        <div class="method-heading">
          <a href="#M000606" class="method-signature">
          <span class="method-name">ordered_expression_sql</span><span class="method-args">(oe)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the ordered expression, used in the
ORDER BY clause.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000606-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000606-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 551</span>
551:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ordered_expression_sql</span>(<span class="ruby-identifier">oe</span>)
552:       <span class="ruby-node">&quot;#{literal(oe.expression)} #{oe.descending ? 'DESC' : 'ASC'}&quot;</span>
553:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000564" class="method-detail">
        <a name="M000564"></a>

        <div class="method-heading">
          <a href="#M000564" class="method-signature">
          <span class="method-name">paginate</span><span class="method-args">(page_no, page_size, record_count=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a paginated dataset. The returned dataset is limited to the page <a
href="Dataset.html#M000575">size</a> at the correct offset, <a
href="Dataset.html#M000568">and</a> extended with the <a
href="Dataset/Pagination.html">Pagination</a> module. If a record <a
href="Dataset.html#M000574">count</a> is not provided, does a <a
href="Dataset.html#M000574">count</a> of total number of records for this
dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000564-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000564-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/pagination.rb, line 7</span>
 7:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">page_no</span>, <span class="ruby-identifier">page_size</span>, <span class="ruby-identifier">record_count</span>=<span class="ruby-keyword kw">nil</span>)
 8:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;You cannot paginate a dataset that already has a limit&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:limit</span>]
 9:       <span class="ruby-identifier">paginated</span> = <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">page_size</span>, (<span class="ruby-identifier">page_no</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">page_size</span>)
10:       <span class="ruby-identifier">paginated</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">Pagination</span>)
11:       <span class="ruby-identifier">paginated</span>.<span class="ruby-identifier">set_pagination_info</span>(<span class="ruby-identifier">page_no</span>, <span class="ruby-identifier">page_size</span>, <span class="ruby-identifier">record_count</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">count</span>)
12:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000607" class="method-detail">
        <a name="M000607"></a>

        <div class="method-heading">
          <a href="#M000607" class="method-signature">
          <span class="method-name">placeholder_literal_string_sql</span><span class="method-args">(pls)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for a <a
href="Dataset.html#M000600">literal</a> string with placeholders
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000607-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000607-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 556</span>
556:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">placeholder_literal_string_sql</span>(<span class="ruby-identifier">pls</span>)
557:       <span class="ruby-identifier">args</span> = <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">args</span>.<span class="ruby-identifier">dup</span>
558:       <span class="ruby-identifier">s</span> = <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">str</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-constant">QUESTION_MARK</span>){<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>)}
559:       <span class="ruby-identifier">s</span> = <span class="ruby-node">&quot;(#{s})&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">parens</span>
560:       <span class="ruby-identifier">s</span>
561:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000654" class="method-detail">
        <a name="M000654"></a>

        <div class="method-heading">
          <a href="#M000654" class="method-signature">
          <span class="method-name">polymorphic_key</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the column name for the polymorphic key.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000654-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000654-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 249</span>
249:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">polymorphic_key</span>
250:       <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:polymorphic_key</span>]
251:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000631" class="method-detail">
        <a name="M000631"></a>

        <div class="method-heading">
          <a href="#M000631" class="method-signature">
          <span class="method-name">prepare</span><span class="method-args">(type, name=nil, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Prepare an <a href="SQL.html">SQL</a> statement for later execution. This
returns a <a href="Dataset.html#M000643">clone</a> of the dataset extended
with <a
href="Dataset/PreparedStatementMethods.html">PreparedStatementMethods</a>,
on which you can <a href="Dataset.html#M000630">call</a> <a
href="Dataset.html#M000630">call</a> with the hash of bind variables to do
substitution. The prepared statement is also stored in the associated
database. The following usage is identical:
</p>
<pre>
  ps = prepare(:select, :select_by_name)
  ps.call(:name=&gt;'Blah')
  db.call(:select_by_name, :name=&gt;'Blah')
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000631-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000631-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/prepared_statements.rb, line 194</span>
194:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">name</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
195:       <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>)
196:       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">prepared_statements</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">ps</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>
197:       <span class="ruby-identifier">ps</span>
198:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000635" class="method-detail">
        <a name="M000635"></a>

        <div class="method-heading">
          <a href="#M000635" class="method-signature">
          <span class="method-name">prepare</span><span class="method-args">(type, name=nil, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a named prepared statement that is stored in the database (<a
href="Dataset.html#M000568">and</a> connection) for reuse.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000635-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000635-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/adapters/jdbc.rb, line 407</span>
407:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">name</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
408:         <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>)
409:         <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">PreparedStatementMethods</span>)
410:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>
411:           <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">prepared_statement_name</span> = <span class="ruby-identifier">name</span>
412:           <span class="ruby-identifier">db</span>.<span class="ruby-identifier">prepared_statements</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">ps</span>
413:         <span class="ruby-keyword kw">end</span>
414:         <span class="ruby-identifier">ps</span>
415:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000556" class="method-detail">
        <a name="M000556"></a>

        <div class="method-heading">
          <a href="#M000556" class="method-signature">
          <span class="method-name">print</span><span class="method-args">(*cols)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Pretty prints the records in the dataset <a
href="Dataset.html#M000641">as</a> plain-text table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000556-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000556-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 166</span>
166:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">print</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cols</span>)
167:       <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">PrettyTable</span>.<span class="ruby-identifier">print</span>(<span class="ruby-identifier">naked</span>.<span class="ruby-identifier">all</span>, <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-identifier">columns</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">cols</span>)
168:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000608" class="method-detail">
        <a name="M000608"></a>

        <div class="method-heading">
          <a href="#M000608" class="method-signature">
          <span class="method-name">qualified_identifier_sql</span><span class="method-args">(qcr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the qualifed identifier, specifying
a table <a href="Dataset.html#M000568">and</a> a column (<a
href="Dataset.html#M000602">or</a> schema <a
href="Dataset.html#M000568">and</a> table).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000608-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000608-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 565</span>
565:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">qualified_identifier_sql</span>(<span class="ruby-identifier">qcr</span>)
566:       [<span class="ruby-identifier">qcr</span>.<span class="ruby-identifier">table</span>, <span class="ruby-identifier">qcr</span>.<span class="ruby-identifier">column</span>].<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">is_one_of?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>, <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>, <span class="ruby-constant">Symbol</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">x</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">quote_identifier</span>(<span class="ruby-identifier">x</span>)}.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'.'</span>)
567:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000541" class="method-detail">
        <a name="M000541"></a>

        <div class="method-heading">
          <a href="#M000541" class="method-signature">
          <span class="method-name">query</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Translates a <a href="Dataset.html#M000541">query</a> block into a dataset.
Query blocks can be useful when expressing complex SELECT statements, e.g.:
</p>
<pre>
  dataset = DB[:items].query do
    select :x, :y, :z
    filter((:x &gt; 1) &amp; (:y &gt; 2))
    order :z.desc
  end
</pre>
<p>
Which is the same <a href="Dataset.html#M000641">as</a>:
</p>
<pre>
 dataset = DB[:items].select(:x, :y, :z).filter((:x &gt; 1) &amp; (:y &gt; 2)).order(:z.desc)
</pre>
<p>
Note that inside a <a href="Dataset.html#M000630">call</a> to <a
href="Dataset.html#M000541">query</a>, you cannot <a
href="Dataset.html#M000630">call</a> <a
href="Dataset.html#M000648">each</a>, <a
href="Dataset.html#M000650">insert</a>, <a
href="Dataset.html#M000665">update</a>, <a
href="Dataset.html#M000602">or</a> <a
href="Dataset.html#M000647">delete</a> (<a
href="Dataset.html#M000602">or</a> any method that calls those), <a
href="Dataset.html#M000602">or</a> <a href="../Sequel.html">Sequel</a> will
raise an error.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000541-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000541-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel_core/dataset/query.rb, line 19</span>
19:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
20:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">clone</span>({})
21:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">QueryBlockCopy</span>)
22:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
23:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">copy</span>.<span class="ruby-identifier">opts</span>)
24:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000610" class="method-detail">
        <a name="M000610"></a>

        <div class="method-heading">
          <span class="method-name">quote_column_ref</span><span class="method-args">(name)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000609">quote_identifier</a>
</p>
        </div>
      </div>

      <div id="method-M000609" class="method-detail">
        <a name="M000609"></a>

        <div class="method-heading">
          <a href="#M000609" class="method-signature">
          <span class="method-name">quote_identifier</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds quoting to identifiers (<a href="Dataset.html#M000644">columns</a> <a
href="Dataset.html#M000568">and</a> tables). If identifiers are not being
quoted, returns name <a href="Dataset.html#M000641">as</a> a string. If
identifiers are being quoted quote the name with <a
href="Dataset.html#M000612">quoted_identifier</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000609-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000609-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 572</span>
572:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quote_identifier</span>(<span class="ruby-identifier">name</span>)
573:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>
574:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">upcase_identifiers?</span>
575:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">quoted_identifier</span>(<span class="ruby-identifier">name</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">quote_identifiers?</span>
576:       <span class="ruby-identifier">name</span>
577:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000655" class="method-detail">
        <a name="M000655"></a>

        <div class="method-heading">
          <a href="#M000655" class="method-signature">
          <span class="method-name">quote_identifiers?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Whether this dataset quotes identifiers.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000655-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000655-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 254</span>
254:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quote_identifiers?</span>
255:       <span class="ruby-ivar">@quote_identifiers</span>
256:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000611" class="method-detail">
        <a name="M000611"></a>

        <div class="method-heading">
          <a href="#M000611" class="method-signature">
          <span class="method-name">quote_schema_table</span><span class="method-args">(table)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Separates the schema <a href="Dataset.html#M000583">from</a> the table <a
href="Dataset.html#M000568">and</a> returns a string with them quoted (if
quoting identifiers)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000611-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000611-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 582</span>
582:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quote_schema_table</span>(<span class="ruby-identifier">table</span>)
583:       <span class="ruby-identifier">schema</span>, <span class="ruby-identifier">table</span> = <span class="ruby-identifier">schema_and_table</span>(<span class="ruby-identifier">table</span>)
584:       <span class="ruby-node">&quot;#{&quot;#{quote_identifier(schema)}.&quot; if schema}#{quote_identifier(table)}&quot;</span>
585:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000612" class="method-detail">
        <a name="M000612"></a>

        <div class="method-heading">
          <a href="#M000612" class="method-signature">
          <span class="method-name">quoted_identifier</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method quotes the given name with the <a href="SQL.html">SQL</a>
standard double quote. should be overridden by subclasses to provide
quoting not matching the <a href="SQL.html">SQL</a> standard, such <a
href="Dataset.html#M000641">as</a> backtick (used by <a
href="MySQL.html">MySQL</a> <a href="Dataset.html#M000568">and</a> <a
href="SQLite.html">SQLite</a>).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000612-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000612-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 590</span>
590:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quoted_identifier</span>(<span class="ruby-identifier">name</span>)
591:       <span class="ruby-node">&quot;\&quot;#{name}\&quot;&quot;</span>
592:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000557" class="method-detail">
        <a name="M000557"></a>

        <div class="method-heading">
          <a href="#M000557" class="method-signature">
          <span class="method-name">range</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="../Range.html">Range</a> object made <a
href="Dataset.html#M000583">from</a> the minimum <a
href="Dataset.html#M000568">and</a> maximum values for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000557-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000557-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 172</span>
172:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">range</span>(<span class="ruby-identifier">column</span>)
173:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">r</span> = <span class="ruby-identifier">select</span>(<span class="ruby-identifier">:min</span>[<span class="ruby-identifier">column</span>].<span class="ruby-identifier">as</span>(<span class="ruby-identifier">:v1</span>), <span class="ruby-identifier">:max</span>[<span class="ruby-identifier">column</span>].<span class="ruby-identifier">as</span>(<span class="ruby-identifier">:v2</span>)).<span class="ruby-identifier">first</span>
174:         (<span class="ruby-identifier">r</span>[<span class="ruby-identifier">:v1</span>]<span class="ruby-operator">..</span><span class="ruby-identifier">r</span>[<span class="ruby-identifier">:v2</span>])
175:       <span class="ruby-keyword kw">end</span>
176:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000614" class="method-detail">
        <a name="M000614"></a>

        <div class="method-heading">
          <span class="method-name">reverse</span><span class="method-args">(*order)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000613">reverse_order</a>
</p>
        </div>
      </div>

      <div id="method-M000613" class="method-detail">
        <a name="M000613"></a>

        <div class="method-heading">
          <a href="#M000613" class="method-signature">
          <span class="method-name">reverse_order</span><span class="method-args">(*order)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000603">order</a> reversed. If no <a
href="Dataset.html#M000603">order</a> is given, the existing <a
href="Dataset.html#M000603">order</a> is inverted.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000613-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000613-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 596</span>
596:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reverse_order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">order</span>)
597:       <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">invert_order</span>(<span class="ruby-identifier">order</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:order</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">order</span>))
598:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000615" class="method-detail">
        <a name="M000615"></a>

        <div class="method-heading">
          <a href="#M000615" class="method-signature">
          <span class="method-name">schema_and_table</span><span class="method-args">(table_name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Split the schema information <a href="Dataset.html#M000583">from</a> the
table
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000615-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000615-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 602</span>
602:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">schema_and_table</span>(<span class="ruby-identifier">table_name</span>)
603:       <span class="ruby-identifier">sch</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">default_schema</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">db</span>
604:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">table_name</span>
605:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
606:         <span class="ruby-identifier">s</span>, <span class="ruby-identifier">t</span>, <span class="ruby-identifier">a</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">table_name</span>)
607:         [<span class="ruby-identifier">s</span><span class="ruby-operator">||</span><span class="ruby-identifier">sch</span>, <span class="ruby-identifier">t</span>]
608:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>
609:         [<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">column</span>]
610:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>
611:         [<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">value</span>]
612:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
613:         [<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table_name</span>]
614:       <span class="ruby-keyword kw">else</span>
615:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-value str">'table_name should be a Symbol, SQL::QualifiedIdentifier, SQL::Identifier, or String'</span>
616:       <span class="ruby-keyword kw">end</span>
617:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000616" class="method-detail">
        <a name="M000616"></a>

        <div class="method-heading">
          <a href="#M000616" class="method-signature">
          <span class="method-name">select</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000644">columns</a> selected changed to the given <a
href="Dataset.html#M000644">columns</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000616-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000616-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 621</span>
621:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
622:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">columns</span>)
623:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000617" class="method-detail">
        <a name="M000617"></a>

        <div class="method-heading">
          <a href="#M000617" class="method-signature">
          <span class="method-name">select_all</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset selecting the wildcard.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000617-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000617-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 626</span>
626:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_all</span>
627:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
628:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000618" class="method-detail">
        <a name="M000618"></a>

        <div class="method-heading">
          <a href="#M000618" class="method-signature">
          <span class="method-name">select_more</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the given <a
href="Dataset.html#M000644">columns</a> added to the existing selected <a
href="Dataset.html#M000644">columns</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000618-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000618-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 632</span>
632:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_more</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
633:       <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span>((<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:select</span>] <span class="ruby-operator">||</span> []) <span class="ruby-operator">+</span> <span class="ruby-identifier">columns</span>))
634:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000619" class="method-detail">
        <a name="M000619"></a>

        <div class="method-heading">
          <a href="#M000619" class="method-signature">
          <span class="method-name">select_sql</span><span class="method-args">(opts = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Formats a SELECT statement using the given options <a
href="Dataset.html#M000568">and</a> the dataset options.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000619-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000619-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 638</span>
638:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_sql</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>)
639:       <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span> <span class="ruby-value">? </span><span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>) <span class="ruby-operator">:</span> <span class="ruby-ivar">@opts</span>
640:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]
641:       <span class="ruby-identifier">sql</span> = <span class="ruby-value str">'SELECT'</span>
642:       <span class="ruby-identifier">select_clause_order</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;select_#{x}_sql&quot;</span>, <span class="ruby-identifier">sql</span>, <span class="ruby-identifier">opts</span>)}
643:       <span class="ruby-identifier">sql</span>
644:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000656" class="method-detail">
        <a name="M000656"></a>

        <div class="method-heading">
          <a href="#M000656" class="method-signature">
          <span class="method-name">server</span><span class="method-args">(servr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the <a href="Dataset.html#M000656">server</a> for this dataset to use.
Used to pick a specific database shard to run a <a
href="Dataset.html#M000541">query</a> against, <a
href="Dataset.html#M000602">or</a> to override the default SELECT uses
:read_only database <a href="Dataset.html#M000568">and</a> <a
href="Dataset.html#M000642">all</a> other queries use the :default
database.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000656-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000656-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 261</span>
261:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">server</span>(<span class="ruby-identifier">servr</span>)
262:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:server=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">servr</span>)
263:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000657" class="method-detail">
        <a name="M000657"></a>

        <div class="method-heading">
          <a href="#M000657" class="method-signature">
          <span class="method-name">set</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000657">set</a>, but not aliased directly
so subclasses don&#8216;t have to override both methods.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000657-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000657-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 267</span>
267:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
268:       <span class="ruby-identifier">update</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
269:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000658" class="method-detail">
        <a name="M000658"></a>

        <div class="method-heading">
          <a href="#M000658" class="method-signature">
          <span class="method-name">set_defaults</span><span class="method-args">(hash)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the default values for <a href="Dataset.html#M000650">insert</a> <a
href="Dataset.html#M000568">and</a> <a
href="Dataset.html#M000665">update</a> statements. The values passed to <a
href="Dataset.html#M000650">insert</a> <a
href="Dataset.html#M000602">or</a> <a
href="Dataset.html#M000665">update</a> are merged into this hash.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000658-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000658-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 273</span>
273:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_defaults</span>(<span class="ruby-identifier">hash</span>)
274:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:defaults=</span><span class="ruby-operator">&gt;</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:defaults</span>]<span class="ruby-operator">||</span>{}).<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">hash</span>))
275:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000539" class="method-detail">
        <a name="M000539"></a>

        <div class="method-heading">
          <a href="#M000539" class="method-signature">
          <span class="method-name">set_graph_aliases</span><span class="method-args">(graph_aliases)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This allows you to manually specify the <a
href="Dataset.html#M000538">graph</a> aliases to use when using <a
href="Dataset.html#M000538">graph</a>. You can use it to only <a
href="Dataset.html#M000616">select</a> certain <a
href="Dataset.html#M000644">columns</a>, <a
href="Dataset.html#M000568">and</a> have those <a
href="Dataset.html#M000644">columns</a> mapped to specific aliases in the
result <a href="Dataset.html#M000657">set</a>. This is the equivalent of
.<a href="Dataset.html#M000616">select</a> for a graphed dataset, <a
href="Dataset.html#M000568">and</a> must be used instead of .<a
href="Dataset.html#M000616">select</a> whenever graphing is used. Example:
</p>
<pre>
  DB[:artists].graph(:albums, :artist_id=&gt;:id).set_graph_aliases(:artist_name=&gt;[:artists, :name], :album_name=&gt;[:albums, :name]).first
  =&gt; {:artists=&gt;{:name=&gt;artists.name}, :albums=&gt;{:name=&gt;albums.name}}
</pre>
<p>
Arguments:
</p>
<ul>
<li>graph_aliases - Should be a hash with keys being symbols of column aliases,
<a href="Dataset.html#M000568">and</a> values being arrays with two symbol
elements. The <a href="Dataset.html#M000546">first</a> element of the array
should be the table alias, <a href="Dataset.html#M000568">and</a> the
second should be the actual column name.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000539-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000539-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/object_graph.rb, line 158</span>
158:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_graph_aliases</span>(<span class="ruby-identifier">graph_aliases</span>)
159:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">graph_alias_columns</span>(<span class="ruby-identifier">graph_aliases</span>))
160:       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph_aliases</span>] = <span class="ruby-identifier">graph_aliases</span>
161:       <span class="ruby-identifier">ds</span>
162:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000659" class="method-detail">
        <a name="M000659"></a>

        <div class="method-heading">
          <a href="#M000659" class="method-signature">
          <span class="method-name">set_model</span><span class="method-args">(key, *args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Associates <a href="Dataset.html#M000602">or</a> disassociates the dataset
with a model(s). If nil is specified, the dataset is turned into a <a
href="Dataset.html#M000653">naked</a> dataset <a
href="Dataset.html#M000568">and</a> returns records <a
href="Dataset.html#M000641">as</a> hashes. If a model class specified, the
dataset is modified to return records <a href="Dataset.html#M000641">as</a>
instances of the model class, e.g:
</p>
<pre>
  class MyModel
    def initialize(values)
      @values = values
      ...
    end
  end

  dataset.set_model(MyModel)
</pre>
<p>
You can also provide additional arguments to be passed to the model&#8216;s
initialize method:
</p>
<pre>
  class MyModel
    def initialize(values, options)
      @values = values
      ...
    end
  end

  dataset.set_model(MyModel, :allow_delete =&gt; false)
</pre>
<p>
The dataset can be made polymorphic by specifying a column name <a
href="Dataset.html#M000641">as</a> the polymorphic key <a
href="Dataset.html#M000568">and</a> a hash mapping column values to model
classes.
</p>
<pre>
  dataset.set_model(:kind, {1 =&gt; Person, 2 =&gt; Business})
</pre>
<p>
You can also <a href="Dataset.html#M000657">set</a> a default model class
to fall back on by specifying a class corresponding to nil:
</p>
<pre>
  dataset.set_model(:kind, {nil =&gt; DefaultClass, 1 =&gt; Person, 2 =&gt; Business})
</pre>
<p>
To make sure that there is always a default model class, the hash provided
should have a default value. To make the dataset <a
href="Dataset.html#M000551">map</a> string values to model classes, <a
href="Dataset.html#M000568">and</a> keep a good default, try:
</p>
<pre>
  dataset.set_model(:kind, Hash.new{|h,k| h[k] = (k.constantize rescue DefaultClass)})
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000659-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000659-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 318</span>
318:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_model</span>(<span class="ruby-identifier">key</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
319:       <span class="ruby-comment cmt"># This code is more verbose then necessary for performance reasons</span>
320:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">key</span>
321:       <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-comment cmt"># set_model(nil) =&gt; no argument provided, so the dataset is denuded</span>
322:         <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:naked</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:models</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:polymorphic_key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
323:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">row_proc</span> = <span class="ruby-keyword kw">nil</span>
324:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Class</span>
325:         <span class="ruby-comment cmt"># isomorphic model</span>
326:         <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:naked</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:models</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-keyword kw">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">key</span>}, <span class="ruby-identifier">:polymorphic_key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
327:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:load</span>)
328:           <span class="ruby-comment cmt"># the class has a values setter method, so we use it</span>
329:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">row_proc</span> = <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">h</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)}
330:         <span class="ruby-keyword kw">else</span>
331:           <span class="ruby-comment cmt"># otherwise we just pass the hash to the constructor</span>
332:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">row_proc</span> = <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">h</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)}
333:         <span class="ruby-keyword kw">end</span>
334:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
335:         <span class="ruby-comment cmt"># polymorphic model</span>
336:         <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;No class hash supplied for polymorphic model&quot;</span>)
337:         <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">:naked</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:models</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">hash</span>, <span class="ruby-identifier">:polymorphic_key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">key</span>)
338:         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">hash</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span>(<span class="ruby-identifier">hash</span>[<span class="ruby-keyword kw">nil</span>] <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">first</span>).<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:load</span>)
339:           <span class="ruby-comment cmt"># the class has a values setter method, so we use it</span>
340:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">row_proc</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span>
341:             <span class="ruby-identifier">c</span> = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">h</span>[<span class="ruby-identifier">key</span>]] <span class="ruby-operator">||</span> <span class="ruby-identifier">hash</span>[<span class="ruby-keyword kw">nil</span>] <span class="ruby-operator">||</span> \
342:               <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;No matching model class for record (#{polymorphic_key} =&gt; #{h[polymorphic_key].inspect})&quot;</span>)
343:             <span class="ruby-identifier">c</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">h</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
344:           <span class="ruby-keyword kw">end</span>
345:         <span class="ruby-keyword kw">else</span>
346:           <span class="ruby-comment cmt"># otherwise we just pass the hash to the constructor</span>
347:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">row_proc</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span>
348:             <span class="ruby-identifier">c</span> = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">h</span>[<span class="ruby-identifier">key</span>]] <span class="ruby-operator">||</span> <span class="ruby-identifier">hash</span>[<span class="ruby-keyword kw">nil</span>] <span class="ruby-operator">||</span> \
349:               <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;No matching model class for record (#{polymorphic_key} =&gt; #{h[polymorphic_key].inspect})&quot;</span>)
350:             <span class="ruby-identifier">c</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">h</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
351:           <span class="ruby-keyword kw">end</span>
352:         <span class="ruby-keyword kw">end</span>
353:       <span class="ruby-keyword kw">else</span>
354:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;Invalid model specified&quot;</span>
355:       <span class="ruby-keyword kw">end</span>
356:       <span class="ruby-keyword kw">self</span>
357:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000660" class="method-detail">
        <a name="M000660"></a>

        <div class="method-heading">
          <a href="#M000660" class="method-signature">
          <span class="method-name">set_overrides</span><span class="method-args">(hash)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set values that override hash arguments given to <a
href="Dataset.html#M000650">insert</a> <a
href="Dataset.html#M000568">and</a> <a
href="Dataset.html#M000665">update</a> statements. This hash is merged into
the hash provided to <a href="Dataset.html#M000650">insert</a> <a
href="Dataset.html#M000602">or</a> <a
href="Dataset.html#M000665">update</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000660-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000660-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 361</span>
361:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_overrides</span>(<span class="ruby-identifier">hash</span>)
362:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:overrides=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:overrides</span>]<span class="ruby-operator">||</span>{}))
363:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000558" class="method-detail">
        <a name="M000558"></a>

        <div class="method-heading">
          <a href="#M000558" class="method-signature">
          <span class="method-name">single_record</span><span class="method-args">(opts = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000546">first</a> record in the dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000558-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000558-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 179</span>
179:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">single_record</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>)
180:       <span class="ruby-identifier">each</span>((<span class="ruby-identifier">opts</span><span class="ruby-operator">||</span>{}).<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">:limit=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>)){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">r</span>}
181:       <span class="ruby-keyword kw">nil</span>
182:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000559" class="method-detail">
        <a name="M000559"></a>

        <div class="method-heading">
          <a href="#M000559" class="method-signature">
          <span class="method-name">single_value</span><span class="method-args">(opts = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000546">first</a> value of the <a
href="Dataset.html#M000546">first</a> record in the dataset. Returns nil if
dataset is empty.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000559-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000559-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 186</span>
186:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">single_value</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>)
187:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">r</span> = <span class="ruby-identifier">single_record</span>((<span class="ruby-identifier">opts</span><span class="ruby-operator">||</span>{}).<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">:graph=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:naked=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">true</span>))
188:         <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">first</span>
189:       <span class="ruby-keyword kw">end</span>
190:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000575" class="method-detail">
        <a name="M000575"></a>

        <div class="method-heading">
          <span class="method-name">size</span><span class="method-args">()</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000574">count</a>
</p>
        </div>
      </div>

      <div id="method-M000620" class="method-detail">
        <a name="M000620"></a>

        <div class="method-heading">
          <a href="#M000620" class="method-signature">
          <span class="method-name">sql</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same <a href="Dataset.html#M000641">as</a> <a
href="Dataset.html#M000619">select_sql</a>, not aliased directly to make
subclassing simpler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000620-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000620-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 647</span>
647:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
648:       <span class="ruby-identifier">select_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
649:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000621" class="method-detail">
        <a name="M000621"></a>

        <div class="method-heading">
          <a href="#M000621" class="method-signature">
          <span class="method-name">subscript_sql</span><span class="method-args">(s)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for specifying subscripts (<a
href="SQL.html">SQL</a> arrays)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000621-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000621-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 652</span>
652:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">subscript_sql</span>(<span class="ruby-identifier">s</span>)
653:       <span class="ruby-node">&quot;#{s.f}[#{s.sub.join(COMMA_SEPARATOR)}]&quot;</span>
654:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000560" class="method-detail">
        <a name="M000560"></a>

        <div class="method-heading">
          <a href="#M000560" class="method-signature">
          <span class="method-name">sum</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000560">sum</a> for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000560-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000560-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 193</span>
193:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sum</span>(<span class="ruby-identifier">column</span>)
194:       <span class="ruby-identifier">get</span>(<span class="ruby-identifier">:sum</span>[<span class="ruby-identifier">column</span>])
195:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000622" class="method-detail">
        <a name="M000622"></a>

        <div class="method-heading">
          <a href="#M000622" class="method-signature">
          <span class="method-name">symbol_to_column_ref</span><span class="method-args">(sym)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Converts a symbol into a column name. This method supports underscore
notation in <a href="Dataset.html#M000603">order</a> to express qualified
(two underscores) <a href="Dataset.html#M000568">and</a> aliased (three
underscores) <a href="Dataset.html#M000644">columns</a>:
</p>
<pre>
  ds = DB[:items]
  :abc.to_column_ref(ds) #=&gt; &quot;abc&quot;
  :abc___a.to_column_ref(ds) #=&gt; &quot;abc AS a&quot;
  :items__abc.to_column_ref(ds) #=&gt; &quot;items.abc&quot;
  :items__abc___a.to_column_ref(ds) #=&gt; &quot;items.abc AS a&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000622-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000622-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 666</span>
666:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">symbol_to_column_ref</span>(<span class="ruby-identifier">sym</span>)
667:       <span class="ruby-identifier">c_table</span>, <span class="ruby-identifier">column</span>, <span class="ruby-identifier">c_alias</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">sym</span>)
668:       <span class="ruby-identifier">qc</span> = <span class="ruby-node">&quot;#{&quot;#{quote_identifier(c_table)}.&quot; if c_table}#{quote_identifier(column)}&quot;</span>
669:       <span class="ruby-identifier">c_alias</span> <span class="ruby-value">? </span><span class="ruby-identifier">as_sql</span>(<span class="ruby-identifier">qc</span>, <span class="ruby-identifier">c_alias</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">qc</span>
670:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000561" class="method-detail">
        <a name="M000561"></a>

        <div class="method-heading">
          <a href="#M000561" class="method-signature">
          <span class="method-name">table_exists?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the table <a href="Dataset.html#M000579">exists</a>. Will
raise an error if the dataset has fixed <a href="SQL.html">SQL</a> <a
href="Dataset.html#M000602">or</a> selects <a
href="Dataset.html#M000583">from</a> another dataset <a
href="Dataset.html#M000602">or</a> more than one table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000561-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000561-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 200</span>
200:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">table_exists?</span>
201:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;this dataset has fixed SQL&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]
202:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;this dataset selects from multiple sources&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span>
203:       <span class="ruby-identifier">t</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">first</span>
204:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;this dataset selects from a sub query&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>)
205:       <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">t</span>)
206:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000562" class="method-detail">
        <a name="M000562"></a>

        <div class="method-heading">
          <a href="#M000562" class="method-signature">
          <span class="method-name">to_csv</span><span class="method-args">(include_column_titles = true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a string in CSV format containing the dataset records. By default
the CSV representation includes the column titles in the <a
href="Dataset.html#M000546">first</a> line. You can turn that off by
passing false <a href="Dataset.html#M000641">as</a> the
include_column_titles argument.
</p>
<p>
This does not use a CSV library <a href="Dataset.html#M000602">or</a>
handle quoting of values in any way. If any values in any of the rows could
include commas <a href="Dataset.html#M000602">or</a> line endings, you
probably shouldn&#8216;t use this.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000562-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000562-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 216</span>
216:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_csv</span>(<span class="ruby-identifier">include_column_titles</span> = <span class="ruby-keyword kw">true</span>)
217:       <span class="ruby-identifier">n</span> = <span class="ruby-identifier">naked</span>
218:       <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">n</span>.<span class="ruby-identifier">columns</span>
219:       <span class="ruby-identifier">csv</span> = <span class="ruby-value str">''</span>
220:       <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{cols.join(COMMA_SEPARATOR)}\r\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">include_column_titles</span>
221:       <span class="ruby-identifier">n</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{cols.collect{|c| r[c]}.join(COMMA_SEPARATOR)}\r\n&quot;</span>}
222:       <span class="ruby-identifier">csv</span>
223:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000563" class="method-detail">
        <a name="M000563"></a>

        <div class="method-heading">
          <a href="#M000563" class="method-signature">
          <span class="method-name">to_hash</span><span class="method-args">(key_column, value_column = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a hash with one column used <a href="Dataset.html#M000641">as</a>
key <a href="Dataset.html#M000568">and</a> another used <a
href="Dataset.html#M000641">as</a> value. If rows have duplicate values for
the key column, the latter row(s) will overwrite the value of the previous
row(s). If the value_column is not given <a
href="Dataset.html#M000602">or</a> nil, uses the entire hash <a
href="Dataset.html#M000641">as</a> the value.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000563-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000563-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/convenience.rb, line 229</span>
229:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_hash</span>(<span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span> = <span class="ruby-keyword kw">nil</span>)
230:       <span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
231:         <span class="ruby-identifier">m</span>[<span class="ruby-identifier">r</span>[<span class="ruby-identifier">key_column</span>]] = <span class="ruby-identifier">value_column</span> <span class="ruby-value">? </span><span class="ruby-identifier">r</span>[<span class="ruby-identifier">value_column</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">r</span>
232:         <span class="ruby-identifier">m</span>
233:       <span class="ruby-keyword kw">end</span>
234:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000661" class="method-detail">
        <a name="M000661"></a>

        <div class="method-heading">
          <a href="#M000661" class="method-signature">
          <span class="method-name">transform</span><span class="method-args">(t)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets a value <a href="Dataset.html#M000661">transform</a> which is used to
convert values loaded <a href="Dataset.html#M000568">and</a> saved to/from
the database. The <a href="Dataset.html#M000661">transform</a> should be
supplied <a href="Dataset.html#M000641">as</a> a hash. Each value in the
hash should be an array containing two proc objects - one for transforming
loaded values, <a href="Dataset.html#M000568">and</a> one for transforming
saved values. The following example demonstrates how to store Ruby objects
in a dataset using Marshal serialization:
</p>
<pre>
  dataset.transform(:obj =&gt; [
    proc {|v| Marshal.load(v)},
    proc {|v| Marshal.dump(v)}
  ])

  dataset.insert_sql(:obj =&gt; 1234) #=&gt;
  &quot;INSERT INTO items (obj) VALUES ('\004\bi\002\322\004')&quot;
</pre>
<p>
Another form of using <a href="Dataset.html#M000661">transform</a> is by
specifying stock transforms:
</p>
<pre>
  dataset.transform(:obj =&gt; :marshal)
</pre>
<p>
The currently supported stock transforms are :marshal <a
href="Dataset.html#M000568">and</a> :yaml.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000661-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000661-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 385</span>
385:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">transform</span>(<span class="ruby-identifier">t</span>)
386:       <span class="ruby-ivar">@transform</span> = <span class="ruby-identifier">t</span>
387:       <span class="ruby-identifier">t</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
388:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">v</span>
389:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
390:           <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">!=</span> <span class="ruby-value">2</span>) <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Proc</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Proc</span>)
391:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidTransform</span>, <span class="ruby-value str">&quot;Invalid transform specified&quot;</span>
392:           <span class="ruby-keyword kw">end</span>
393:         <span class="ruby-keyword kw">else</span>
394:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> = <span class="ruby-constant">STOCK_TRANSFORMS</span>[<span class="ruby-identifier">v</span>]
395:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidTransform</span>, <span class="ruby-value str">&quot;Invalid transform specified&quot;</span>
396:           <span class="ruby-keyword kw">else</span>
397:             <span class="ruby-identifier">t</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>
398:           <span class="ruby-keyword kw">end</span>
399:         <span class="ruby-keyword kw">end</span>
400:       <span class="ruby-keyword kw">end</span>
401:       <span class="ruby-keyword kw">self</span>
402:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000662" class="method-detail">
        <a name="M000662"></a>

        <div class="method-heading">
          <a href="#M000662" class="method-signature">
          <span class="method-name">transform_load</span><span class="method-args">(r)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Applies the value <a href="Dataset.html#M000661">transform</a> for data
loaded <a href="Dataset.html#M000583">from</a> the database.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000662-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000662-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 405</span>
405:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">transform_load</span>(<span class="ruby-identifier">r</span>)
406:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">kv</span><span class="ruby-operator">|</span>
407:         <span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">kv</span>
408:         <span class="ruby-identifier">m</span>[<span class="ruby-identifier">k</span>] = (<span class="ruby-identifier">tt</span> = <span class="ruby-ivar">@transform</span>[<span class="ruby-identifier">k</span>]) <span class="ruby-operator">?</span> <span class="ruby-identifier">tt</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">v</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">v</span>
409:         <span class="ruby-identifier">m</span>
410:       <span class="ruby-keyword kw">end</span>
411:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000663" class="method-detail">
        <a name="M000663"></a>

        <div class="method-heading">
          <a href="#M000663" class="method-signature">
          <span class="method-name">transform_save</span><span class="method-args">(r)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Applies the value <a href="Dataset.html#M000661">transform</a> for data
saved to the database.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000663-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000663-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 414</span>
414:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">transform_save</span>(<span class="ruby-identifier">r</span>)
415:       <span class="ruby-identifier">r</span>.<span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">kv</span><span class="ruby-operator">|</span>
416:         <span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">kv</span>
417:         <span class="ruby-identifier">m</span>[<span class="ruby-identifier">k</span>] = (<span class="ruby-identifier">tt</span> = <span class="ruby-ivar">@transform</span>[<span class="ruby-identifier">k</span>]) <span class="ruby-operator">?</span> <span class="ruby-identifier">tt</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">v</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">v</span>
418:         <span class="ruby-identifier">m</span>
419:       <span class="ruby-keyword kw">end</span>
420:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000623" class="method-detail">
        <a name="M000623"></a>

        <div class="method-heading">
          <a href="#M000623" class="method-signature">
          <span class="method-name">unfiltered</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with no filters (HAVING <a
href="Dataset.html#M000602">or</a> WHERE clause) applied.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000623-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000623-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 673</span>
673:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unfiltered</span>
674:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:where</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:having</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
675:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000624" class="method-detail">
        <a name="M000624"></a>

        <div class="method-heading">
          <a href="#M000624" class="method-signature">
          <span class="method-name">union</span><span class="method-args">(dataset, all = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds a UNION clause using a second dataset object. If <a
href="Dataset.html#M000642">all</a> is true the clause used is UNION ALL,
which may return duplicate rows.
</p>
<pre>
  DB[:items].union(DB[:other_items]).sql
  #=&gt; &quot;SELECT * FROM items UNION SELECT * FROM other_items&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000624-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000624-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 682</span>
682:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">union</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span> = <span class="ruby-keyword kw">false</span>)
683:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:union</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">:union_all</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">all</span>)
684:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000625" class="method-detail">
        <a name="M000625"></a>

        <div class="method-heading">
          <a href="#M000625" class="method-signature">
          <span class="method-name">uniq</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000626">distinct</a> option.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000625-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000625-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 687</span>
687:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">uniq</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
688:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:distinct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">args</span>)
689:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000627" class="method-detail">
        <a name="M000627"></a>

        <div class="method-heading">
          <a href="#M000627" class="method-signature">
          <span class="method-name">unordered</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with no <a
href="Dataset.html#M000603">order</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000627-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000627-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 693</span>
693:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unordered</span>
694:       <span class="ruby-identifier">order</span>(<span class="ruby-keyword kw">nil</span>)
695:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000664" class="method-detail">
        <a name="M000664"></a>

        <div class="method-heading">
          <a href="#M000664" class="method-signature">
          <span class="method-name">upcase_identifiers?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Whether this dataset upcases identifiers.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000664-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000664-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 423</span>
423:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">upcase_identifiers?</span>
424:       <span class="ruby-ivar">@upcase_identifiers</span>
425:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000665" class="method-detail">
        <a name="M000665"></a>

        <div class="method-heading">
          <a href="#M000665" class="method-signature">
          <span class="method-name">update</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Updates values for the dataset. The returned value is generally the number
of rows updated, but that is adapter dependent.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000665-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000665-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 429</span>
429:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
430:       <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">update_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>))
431:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000628" class="method-detail">
        <a name="M000628"></a>

        <div class="method-heading">
          <a href="#M000628" class="method-signature">
          <span class="method-name">update_sql</span><span class="method-args">(values = {}, opts = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Formats an UPDATE statement using the given values.
</p>
<pre>
  dataset.update_sql(:price =&gt; 100, :category =&gt; 'software') #=&gt;
    &quot;UPDATE items SET price = 100, category = 'software'&quot;
</pre>
<p>
Accepts a block, but such usage is discouraged.
</p>
<p>
Raises an error if the dataset is grouped <a
href="Dataset.html#M000602">or</a> includes more than one table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000628-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000628-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 706</span>
706:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_sql</span>(<span class="ruby-identifier">values</span> = {}, <span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>)
707:       <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span> <span class="ruby-value">? </span><span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>) <span class="ruby-operator">:</span> <span class="ruby-ivar">@opts</span>
708: 
709:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]
710: 
711:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group</span>]
712:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;A grouped dataset cannot be updated&quot;</span>
713:       <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:join</span>]
714:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;A joined dataset cannot be updated&quot;</span>
715:       <span class="ruby-keyword kw">end</span>
716:       
717:       <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;UPDATE #{source_list(@opts[:from])} SET &quot;</span>
718:       <span class="ruby-identifier">set</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
719:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:defaults</span>].<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">values</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:defaults</span>]
720:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:overrides</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:overrides</span>]
721:         <span class="ruby-comment cmt"># get values from hash</span>
722:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">transform_save</span>(<span class="ruby-identifier">values</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@transform</span>
723:         <span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
724:           <span class="ruby-node">&quot;#{k.is_one_of?(String, Symbol) ? quote_identifier(k) : literal(k)} = #{literal(v)}&quot;</span>
725:         <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">COMMA_SEPARATOR</span>)
726:       <span class="ruby-keyword kw">else</span>
727:         <span class="ruby-comment cmt"># copy values verbatim</span>
728:         <span class="ruby-identifier">values</span>
729:       <span class="ruby-keyword kw">end</span>
730:       <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">set</span>
731:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">where</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:where</span>]
732:         <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; WHERE #{literal(where)}&quot;</span>
733:       <span class="ruby-keyword kw">end</span>
734: 
735:       <span class="ruby-identifier">sql</span>
736:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000581" class="method-detail">
        <a name="M000581"></a>

        <div class="method-heading">
          <span class="method-name">where</span><span class="method-args">(*cond, &amp;block)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000580">filter</a>
</p>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000666" class="method-detail">
        <a name="M000666"></a>

        <div class="method-heading">
          <a href="#M000666" class="method-signature">
          <span class="method-name">options_overlap</span><span class="method-args">(opts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return true if the dataset has a non-nil value for any key in opts.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000666-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000666-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset.rb, line 439</span>
439:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">options_overlap</span>(<span class="ruby-identifier">opts</span>)
440:       <span class="ruby-operator">!</span>(<span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span>}.<span class="ruby-identifier">compact</span> <span class="ruby-operator">&amp;</span> <span class="ruby-identifier">opts</span>).<span class="ruby-identifier">empty?</span>
441:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000632" class="method-detail">
        <a name="M000632"></a>

        <div class="method-heading">
          <a href="#M000632" class="method-signature">
          <span class="method-name">to_prepared_statement</span><span class="method-args">(type, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return a cloned copy of the current dataset extended with <a
href="Dataset/PreparedStatementMethods.html">PreparedStatementMethods</a>,
setting the type <a href="Dataset.html#M000568">and</a> modify values.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000632-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000632-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/prepared_statements.rb, line 204</span>
204:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
205:       <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">clone</span>
206:       <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">PreparedStatementMethods</span>)
207:       <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">prepared_type</span> = <span class="ruby-identifier">type</span>
208:       <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">prepared_modify_values</span> = <span class="ruby-identifier">values</span>
209:       <span class="ruby-identifier">ps</span>
210:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000629" class="method-detail">
        <a name="M000629"></a>

        <div class="method-heading">
          <a href="#M000629" class="method-signature">
          <span class="method-name">to_table_reference</span><span class="method-args">(table_alias=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a table reference for use in the FROM clause. Returns an <a
href="SQL.html">SQL</a> subquery frgament with an optional table alias.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000629-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000629-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel_core/dataset/sql.rb, line 747</span>
747:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_table_reference</span>(<span class="ruby-identifier">table_alias</span>=<span class="ruby-keyword kw">nil</span>)
748:       <span class="ruby-identifier">s</span> = <span class="ruby-node">&quot;(#{sql})&quot;</span>
749:       <span class="ruby-identifier">table_alias</span> <span class="ruby-value">? </span><span class="ruby-identifier">as_sql</span>(<span class="ruby-identifier">s</span>, <span class="ruby-identifier">table_alias</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>
750:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>